(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Ph={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},a1=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],a=r[t++],o=r[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=r[t++],a=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},L0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],a=i+1<r.length,o=a?r[i+1]:0,l=i+2<r.length,u=l?r[i+2]:0,h=s>>2,d=(s&3)<<4|o>>4;let p=(o&15)<<2|u>>6,g=u&63;l||(g=64,a||(p=64)),n.push(t[h],t[d],t[p],t[g])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(b0(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):a1(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],o=i<r.length?t[r.charAt(i)]:0;++i;const u=i<r.length?t[r.charAt(i)]:64;++i;const d=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||o==null||u==null||d==null)throw new o1;const p=s<<2|o>>4;if(n.push(p),u!==64){const g=o<<4&240|u>>2;if(n.push(g),d!==64){const T=u<<6&192|d;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class o1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c1=function(r){const e=b0(r);return L0.encodeByteArray(e,!0)},wo=function(r){return c1(r).replace(/\./g,"")},M0=function(r){try{return L0.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1=()=>l1().__FIREBASE_DEFAULTS__,h1=()=>{if(typeof process>"u"||typeof Ph>"u")return;const r=Ph.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},f1=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&M0(r[1]);return e&&JSON.parse(e)},rc=()=>{try{return u1()||h1()||f1()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},V0=r=>{var e,t;return(t=(e=rc())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},d1=r=>{const e=V0(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},B0=()=>{var r;return(r=rc())===null||r===void 0?void 0:r.config},U0=r=>{var e;return(e=rc())===null||e===void 0?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[wo(JSON.stringify(t)),wo(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function g1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wt())}function _1(){var r;const e=(r=rc())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function v1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function E1(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function x1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function T1(){const r=Wt();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function y1(){return!_1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function w1(){try{return typeof indexedDB=="object"}catch{return!1}}function A1(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1="FirebaseError";class nn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=I1,Object.setPrototypeOf(this,nn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ca.prototype.create)}}class ca{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?S1(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new nn(i,o,n)}}function S1(r,e){return r.replace(R1,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const R1=/\{\$([^}]+)}/g;function C1(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Ao(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],a=e[i];if(kh(s)&&kh(a)){if(!Ao(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function kh(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function la(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ys(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ws(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function P1(r,e){const t=new k1(r,e);return t.subscribe.bind(t)}class k1{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");O1(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=Vc),i.error===void 0&&(i.error=Vc),i.complete===void 0&&(i.complete=Vc);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function O1(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Vc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(r){return r&&r._delegate?r._delegate:r}class Yn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new p1;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(N1(e))try{this.getOrInitializeService({instanceIdentifier:Gn})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Gn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gn){return this.instances.has(e)}getOptions(e=Gn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:D1(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Gn){return this.component?this.component.multipleInstances?e:Gn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function D1(r){return r===Gn?void 0:r}function N1(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new F1(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pe;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Pe||(Pe={}));const L1={debug:Pe.DEBUG,verbose:Pe.VERBOSE,info:Pe.INFO,warn:Pe.WARN,error:Pe.ERROR,silent:Pe.SILENT},M1=Pe.INFO,V1={[Pe.DEBUG]:"log",[Pe.VERBOSE]:"log",[Pe.INFO]:"info",[Pe.WARN]:"warn",[Pe.ERROR]:"error"},B1=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=V1[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class bl{constructor(e){this.name=e,this._logLevel=M1,this._logHandler=B1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?L1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pe.DEBUG,...e),this._logHandler(this,Pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pe.VERBOSE,...e),this._logHandler(this,Pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pe.INFO,...e),this._logHandler(this,Pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pe.WARN,...e),this._logHandler(this,Pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pe.ERROR,...e),this._logHandler(this,Pe.ERROR,...e)}}const U1=(r,e)=>e.some(t=>r instanceof t);let Oh,Fh;function W1(){return Oh||(Oh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function H1(){return Fh||(Fh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const W0=new WeakMap,al=new WeakMap,H0=new WeakMap,Bc=new WeakMap,Ll=new WeakMap;function j1(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",a)},s=()=>{t(xn(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&W0.set(t,r)}).catch(()=>{}),Ll.set(e,r),e}function $1(r){if(al.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",a),r.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",a),r.addEventListener("abort",a)});al.set(r,e)}let ol={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return al.get(r);if(e==="objectStoreNames")return r.objectStoreNames||H0.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return xn(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function G1(r){ol=r(ol)}function z1(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Uc(this),e,...t);return H0.set(n,e.sort?e.sort():[e]),xn(n)}:H1().includes(r)?function(...e){return r.apply(Uc(this),e),xn(W0.get(this))}:function(...e){return xn(r.apply(Uc(this),e))}}function q1(r){return typeof r=="function"?z1(r):(r instanceof IDBTransaction&&$1(r),U1(r,W1())?new Proxy(r,ol):r)}function xn(r){if(r instanceof IDBRequest)return j1(r);if(Bc.has(r))return Bc.get(r);const e=q1(r);return e!==r&&(Bc.set(r,e),Ll.set(e,r)),e}const Uc=r=>Ll.get(r);function K1(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(r,e),o=xn(a);return n&&a.addEventListener("upgradeneeded",l=>{n(xn(a.result),l.oldVersion,l.newVersion,xn(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const X1=["get","getKey","getAll","getAllKeys","count"],Y1=["put","add","delete","clear"],Wc=new Map;function Dh(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Wc.get(e))return Wc.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Y1.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||X1.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&l.done]))[0]};return Wc.set(e,s),s}G1(r=>({...r,get:(e,t,n)=>Dh(e,t)||r.get(e,t,n),has:(e,t)=>!!Dh(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(J1(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function J1(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cl="@firebase/app",Nh="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr=new bl("@firebase/app"),Z1="@firebase/app-compat",e_="@firebase/analytics-compat",t_="@firebase/analytics",r_="@firebase/app-check-compat",n_="@firebase/app-check",i_="@firebase/auth",s_="@firebase/auth-compat",a_="@firebase/database",o_="@firebase/data-connect",c_="@firebase/database-compat",l_="@firebase/functions",u_="@firebase/functions-compat",h_="@firebase/installations",f_="@firebase/installations-compat",d_="@firebase/messaging",p_="@firebase/messaging-compat",m_="@firebase/performance",g_="@firebase/performance-compat",__="@firebase/remote-config",v_="@firebase/remote-config-compat",E_="@firebase/storage",x_="@firebase/storage-compat",T_="@firebase/firestore",y_="@firebase/vertexai-preview",w_="@firebase/firestore-compat",A_="firebase",I_="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll="[DEFAULT]",S_={[cl]:"fire-core",[Z1]:"fire-core-compat",[t_]:"fire-analytics",[e_]:"fire-analytics-compat",[n_]:"fire-app-check",[r_]:"fire-app-check-compat",[i_]:"fire-auth",[s_]:"fire-auth-compat",[a_]:"fire-rtdb",[o_]:"fire-data-connect",[c_]:"fire-rtdb-compat",[l_]:"fire-fn",[u_]:"fire-fn-compat",[h_]:"fire-iid",[f_]:"fire-iid-compat",[d_]:"fire-fcm",[p_]:"fire-fcm-compat",[m_]:"fire-perf",[g_]:"fire-perf-compat",[__]:"fire-rc",[v_]:"fire-rc-compat",[E_]:"fire-gcs",[x_]:"fire-gcs-compat",[T_]:"fire-fst",[w_]:"fire-fst-compat",[y_]:"fire-vertex","fire-js":"fire-js",[A_]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io=new Map,R_=new Map,ul=new Map;function bh(r,e){try{r.container.addComponent(e)}catch(t){Yr.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Ui(r){const e=r.name;if(ul.has(e))return Yr.debug(`There were multiple attempts to register component ${e}.`),!1;ul.set(e,r);for(const t of Io.values())bh(t,r);for(const t of R_.values())bh(t,r);return!0}function Ml(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Cr(r){return r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tn=new ca("app","Firebase",C_);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Yn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=I_;function j0(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ll,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Tn.create("bad-app-name",{appName:String(i)});if(t||(t=B0()),!t)throw Tn.create("no-options");const s=Io.get(i);if(s){if(Ao(t,s.options)&&Ao(n,s.config))return s;throw Tn.create("duplicate-app",{appName:i})}const a=new b1(i);for(const l of ul.values())a.addComponent(l);const o=new P_(t,n,a);return Io.set(i,o),o}function $0(r=ll){const e=Io.get(r);if(!e&&r===ll&&B0())return j0();if(!e)throw Tn.create("no-app",{appName:r});return e}function yn(r,e,t){var n;let i=(n=S_[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yr.warn(o.join(" "));return}Ui(new Yn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_="firebase-heartbeat-database",O_=1,Us="firebase-heartbeat-store";let Hc=null;function G0(){return Hc||(Hc=K1(k_,O_,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Us)}catch(t){console.warn(t)}}}}).catch(r=>{throw Tn.create("idb-open",{originalErrorMessage:r.message})})),Hc}async function F_(r){try{const t=(await G0()).transaction(Us),n=await t.objectStore(Us).get(z0(r));return await t.done,n}catch(e){if(e instanceof nn)Yr.warn(e.message);else{const t=Tn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yr.warn(t.message)}}}async function Lh(r,e){try{const n=(await G0()).transaction(Us,"readwrite");await n.objectStore(Us).put(e,z0(r)),await n.done}catch(t){if(t instanceof nn)Yr.warn(t.message);else{const n=Tn.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Yr.warn(n.message)}}}function z0(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_=1024,N_=30*24*60*60*1e3;class b_{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new M_(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Mh();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=N_}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Yr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Mh(),{heartbeatsToSend:n,unsentEntries:i}=L_(this._heartbeatsCache.heartbeats),s=wo(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Yr.warn(t),""}}}function Mh(){return new Date().toISOString().substring(0,10)}function L_(r,e=D_){const t=[];let n=r.slice();for(const i of r){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Vh(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Vh(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class M_{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w1()?A1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await F_(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return Lh(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return Lh(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Vh(r){return wo(JSON.stringify({version:2,heartbeats:r})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(r){Ui(new Yn("platform-logger",e=>new Q1(e),"PRIVATE")),Ui(new Yn("heartbeat",e=>new b_(e),"PRIVATE")),yn(cl,Nh,r),yn(cl,Nh,"esm2017"),yn("fire-js","")}V_("");var B_="firebase",U_="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn(B_,U_,"app");function Vl(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function q0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const W_=q0,K0=new ca("auth","Firebase",q0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So=new bl("@firebase/auth");function H_(r,...e){So.logLevel<=Pe.WARN&&So.warn(`Auth (${Yi}): ${r}`,...e)}function fo(r,...e){So.logLevel<=Pe.ERROR&&So.error(`Auth (${Yi}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(r,...e){throw Bl(r,...e)}function Pr(r,...e){return Bl(r,...e)}function X0(r,e,t){const n=Object.assign(Object.assign({},W_()),{[e]:t});return new ca("auth","Firebase",n).create(e,{appName:r.name})}function Gr(r){return X0(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Bl(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return K0.create(r,...e)}function xe(r,e,...t){if(!r)throw Bl(e,...t)}function Hr(r){const e="INTERNAL ASSERTION FAILED: "+r;throw fo(e),new Error(e)}function Qr(r,e){r||Hr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.href)||""}function j_(){return Bh()==="http:"||Bh()==="https:"}function Bh(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(j_()||E1()||"connection"in navigator)?navigator.onLine:!0}function G_(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qr(t>e,"Short delay should be less than long delay!"),this.isMobile=g1()||x1()}get(){return $_()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(r,e){Qr(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=new ua(3e4,6e4);function Fn(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}async function Dn(r,e,t,n,i={}){return Q0(r,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=la(Object.assign({key:r.config.apiKey},a)).slice(1),l=await r._getAdditionalHeaders();l["Content-Type"]="application/json",r.languageCode&&(l["X-Firebase-Locale"]=r.languageCode);const u=Object.assign({method:e,headers:l},s);return v1()||(u.referrerPolicy="no-referrer"),Y0.fetch()(J0(r,r.config.apiHost,t,o),u)})}async function Q0(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},z_),e);try{const i=new X_(r),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Ja(r,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ja(r,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Ja(r,"email-already-in-use",a);if(l==="USER_DISABLED")throw Ja(r,"user-disabled",a);const h=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw X0(r,h,u);wr(r,h)}}catch(i){if(i instanceof nn)throw i;wr(r,"network-request-failed",{message:String(i)})}}async function ha(r,e,t,n,i={}){const s=await Dn(r,e,t,n,i);return"mfaPendingCredential"in s&&wr(r,"multi-factor-auth-required",{_serverResponse:s}),s}function J0(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?Ul(r.config,i):`${r.config.apiScheme}://${i}`}function K_(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class X_{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Pr(this.auth,"network-request-failed")),q_.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ja(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=Pr(r,e,n);return i.customData._tokenResponse=t,i}function Uh(r){return r!==void 0&&r.enterprise!==void 0}class Y_{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return K_(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Q_(r,e){return Dn(r,"GET","/v2/recaptchaConfig",Fn(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J_(r,e){return Dn(r,"POST","/v1/accounts:delete",e)}async function Z0(r,e){return Dn(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Z_(r,e=!1){const t=gt(r),n=await t.getIdToken(e),i=Wl(n);xe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Ps(jc(i.auth_time)),issuedAtTime:Ps(jc(i.iat)),expirationTime:Ps(jc(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function jc(r){return Number(r)*1e3}function Wl(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return fo("JWT malformed, contained fewer than 3 sections"),null;try{const i=M0(t);return i?JSON.parse(i):(fo("Failed to decode base64 JWT payload"),null)}catch(i){return fo("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Wh(r){const e=Wl(r);return xe(e,"internal-error"),xe(typeof e.exp<"u","internal-error"),xe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ws(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof nn&&ev(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function ev({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ps(this.lastLoginAt),this.creationTime=Ps(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(r){var e;const t=r.auth,n=await r.getIdToken(),i=await Ws(r,Z0(t,{idToken:n}));xe(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?ed(s.providerUserInfo):[],o=nv(r.providerData,a),l=r.isAnonymous,u=!(r.email&&s.passwordHash)&&!(o!=null&&o.length),h=l?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new fl(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(r,d)}async function rv(r){const e=gt(r);await Ro(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nv(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function ed(r){return r.map(e=>{var{providerId:t}=e,n=Vl(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iv(r,e){const t=await Q0(r,{},async()=>{const n=la({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,a=J0(r,i,"/v1/token",`key=${s}`),o=await r._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Y0.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function sv(r,e){return Dn(r,"POST","/v2/accounts:revokeToken",Fn(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xe(e.idToken,"internal-error"),xe(typeof e.idToken<"u","internal-error"),xe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){xe(e.length!==0,"internal-error");const t=Wh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(xe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await iv(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,a=new Oi;return n&&(xe(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(xe(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(xe(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Oi,this.toJSON())}_performRefresh(){return Hr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(r,e){xe(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class jr{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=Vl(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new fl(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ws(this,this.stsTokenManager.getToken(this.auth,e));return xe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Z_(this,e)}reload(){return rv(this)}_assign(e){this!==e&&(xe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new jr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){xe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ro(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Cr(this.auth.app))return Promise.reject(Gr(this.auth));const e=await this.getIdToken();return await Ws(this,J_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,a,o,l,u,h;const d=(n=t.displayName)!==null&&n!==void 0?n:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,g=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,T=(a=t.photoURL)!==null&&a!==void 0?a:void 0,_=(o=t.tenantId)!==null&&o!==void 0?o:void 0,y=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,L=(u=t.createdAt)!==null&&u!==void 0?u:void 0,M=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:N,emailVerified:G,isAnonymous:J,providerData:ne,stsTokenManager:w}=t;xe(N&&w,e,"internal-error");const x=Oi.fromJSON(this.name,w);xe(typeof N=="string",e,"internal-error"),hn(d,e.name),hn(p,e.name),xe(typeof G=="boolean",e,"internal-error"),xe(typeof J=="boolean",e,"internal-error"),hn(g,e.name),hn(T,e.name),hn(_,e.name),hn(y,e.name),hn(L,e.name),hn(M,e.name);const E=new jr({uid:N,auth:e,email:p,emailVerified:G,displayName:d,isAnonymous:J,photoURL:T,phoneNumber:g,tenantId:_,stsTokenManager:x,createdAt:L,lastLoginAt:M});return ne&&Array.isArray(ne)&&(E.providerData=ne.map(R=>Object.assign({},R))),y&&(E._redirectEventId=y),E}static async _fromIdTokenResponse(e,t,n=!1){const i=new Oi;i.updateFromServerResponse(t);const s=new jr({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ro(s),s}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];xe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?ed(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Oi;o.updateFromIdToken(n);const l=new jr({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new fl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh=new Map;function $r(r){Qr(r instanceof Function,"Expected a class definition");let e=Hh.get(r);return e?(Qr(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,Hh.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}td.type="NONE";const jh=td;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(r,e,t){return`firebase:${r}:${e}:${t}`}class Fi{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=po(this.userKey,i.apiKey,s),this.fullPersistenceKey=po("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?jr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Fi($r(jh),e,n);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||$r(jh);const a=po(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const h=await u._get(a);if(h){const d=jr._fromJSON(e,h);u!==s&&(o=d),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Fi(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new Fi(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(sd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rd(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(od(e))return"Blackberry";if(cd(e))return"Webos";if(nd(e))return"Safari";if((e.includes("chrome/")||id(e))&&!e.includes("edge/"))return"Chrome";if(ad(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function rd(r=Wt()){return/firefox\//i.test(r)}function nd(r=Wt()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function id(r=Wt()){return/crios\//i.test(r)}function sd(r=Wt()){return/iemobile/i.test(r)}function ad(r=Wt()){return/android/i.test(r)}function od(r=Wt()){return/blackberry/i.test(r)}function cd(r=Wt()){return/webos/i.test(r)}function Hl(r=Wt()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function av(r=Wt()){var e;return Hl(r)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ov(){return T1()&&document.documentMode===10}function ld(r=Wt()){return Hl(r)||ad(r)||cd(r)||od(r)||/windows phone/i.test(r)||sd(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(r,e=[]){let t;switch(r){case"Browser":t=$h(Wt());break;case"Worker":t=`${$h(Wt())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lv(r,e={}){return Dn(r,"GET","/v2/passwordPolicy",Fn(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv=6;class hv{constructor(e){var t,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:uv,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gh(this),this.idTokenSubscription=new Gh(this),this.beforeStateQueue=new cv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=K0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$r(t)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Fi.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Z0(this,{idToken:e}),n=await jr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Cr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return xe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ro(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=G_()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Cr(this.app))return Promise.reject(Gr(this));const t=e?gt(e):null;return t&&xe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&xe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Cr(this.app)?Promise.reject(Gr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Cr(this.app)?Promise.reject(Gr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lv(this),t=new hv(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ca("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await sv(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$r(e)||this._popupRedirectResolver;xe(t,this,"argument-error"),this.redirectPersistenceManager=await Fi.create(this,[$r(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(xe(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ud(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&H_(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function si(r){return gt(r)}class Gh{constructor(e){this.auth=e,this.observer=null,this.addObserver=P1(t=>this.observer=t)}get next(){return xe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dv(r){nc=r}function hd(r){return nc.loadJS(r)}function pv(){return nc.recaptchaEnterpriseScript}function mv(){return nc.gapiScript}function gv(r){return`__${r}${Math.floor(Math.random()*1e6)}`}const _v="recaptcha-enterprise",vv="NO_RECAPTCHA";class Ev{constructor(e){this.type=_v,this.auth=si(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{Q_(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new Y_(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;Uh(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{a(u)}).catch(()=>{a(vv)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!t&&Uh(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=pv();l.length!==0&&(l+=o),hd(l).then(()=>{i(o,s,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function zh(r,e,t,n=!1){const i=new Ev(r);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const a=Object.assign({},e);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function dl(r,e,t,n){var i;if(!((i=r._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await zh(r,e,t,t==="getOobCode");return n(r,s)}else return n(r,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await zh(r,e,t,t==="getOobCode");return n(r,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(r,e){const t=Ml(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Ao(s,e??{}))return i;wr(i,"already-initialized")}return t.initialize({options:e})}function Tv(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map($r);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function yv(r,e,t){const n=si(r);xe(n._canInitEmulator,n,"emulator-config-failed"),xe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=fd(e),{host:a,port:o}=wv(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),Av()}function fd(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function wv(r){const e=fd(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:qh(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:qh(a)}}}function qh(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function Av(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Hr("not implemented")}_getIdTokenResponse(e){return Hr("not implemented")}_linkToIdToken(e,t){return Hr("not implemented")}_getReauthenticationResolver(e){return Hr("not implemented")}}async function Iv(r,e){return Dn(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sv(r,e){return ha(r,"POST","/v1/accounts:signInWithPassword",Fn(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rv(r,e){return ha(r,"POST","/v1/accounts:signInWithEmailLink",Fn(r,e))}async function Cv(r,e){return ha(r,"POST","/v1/accounts:signInWithEmailLink",Fn(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends jl{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Hs(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Hs(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dl(e,t,"signInWithPassword",Sv);case"emailLink":return Rv(e,{email:this._email,oobCode:this._password});default:wr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dl(e,n,"signUpPassword",Iv);case"emailLink":return Cv(e,{idToken:t,email:this._email,oobCode:this._password});default:wr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Di(r,e){return ha(r,"POST","/v1/accounts:signInWithIdp",Fn(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv="http://localhost";class Qn extends jl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=Vl(t,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Qn(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Di(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Di(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Di(e,t)}buildRequest(){const e={requestUri:Pv,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=la(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Ov(r){const e=ys(ws(r)).link,t=e?ys(ws(e)).deep_link_id:null,n=ys(ws(r)).deep_link_id;return(n?ys(ws(n)).link:null)||n||t||e||r}class $l{constructor(e){var t,n,i,s,a,o;const l=ys(ws(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,h=(n=l.oobCode)!==null&&n!==void 0?n:null,d=kv((i=l.mode)!==null&&i!==void 0?i:null);xe(u&&h&&d,"argument-error"),this.apiKey=u,this.operation=d,this.code=h,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const t=Ov(e);try{return new $l(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(){this.providerId=Qi.PROVIDER_ID}static credential(e,t){return Hs._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=$l.parseLink(t);return xe(n,"argument-error"),Hs._fromEmailAndCode(e,n.code,n.tenantId)}}Qi.PROVIDER_ID="password";Qi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Qi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa extends dd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn extends fa{constructor(){super("facebook.com")}static credential(e){return Qn._fromParams({providerId:dn.PROVIDER_ID,signInMethod:dn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dn.credentialFromTaggedObject(e)}static credentialFromError(e){return dn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return dn.credential(e.oauthAccessToken)}catch{return null}}}dn.FACEBOOK_SIGN_IN_METHOD="facebook.com";dn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn extends fa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qn._fromParams({providerId:pn.PROVIDER_ID,signInMethod:pn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pn.credentialFromTaggedObject(e)}static credentialFromError(e){return pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return pn.credential(t,n)}catch{return null}}}pn.GOOGLE_SIGN_IN_METHOD="google.com";pn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn extends fa{constructor(){super("github.com")}static credential(e){return Qn._fromParams({providerId:mn.PROVIDER_ID,signInMethod:mn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mn.credentialFromTaggedObject(e)}static credentialFromError(e){return mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mn.credential(e.oauthAccessToken)}catch{return null}}}mn.GITHUB_SIGN_IN_METHOD="github.com";mn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn extends fa{constructor(){super("twitter.com")}static credential(e,t){return Qn._fromParams({providerId:gn.PROVIDER_ID,signInMethod:gn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gn.credentialFromTaggedObject(e)}static credentialFromError(e){return gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return gn.credential(t,n)}catch{return null}}}gn.TWITTER_SIGN_IN_METHOD="twitter.com";gn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fv(r,e){return ha(r,"POST","/v1/accounts:signUp",Fn(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await jr._fromIdTokenResponse(e,n,i),a=Kh(n);return new Jn({user:s,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Kh(n);return new Jn({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Kh(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co extends nn{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Co.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Co(e,t,n,i)}}function pd(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Co._fromErrorAndOperation(r,s,e,n):s})}async function Dv(r,e,t=!1){const n=await Ws(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Jn._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nv(r,e,t=!1){const{auth:n}=r;if(Cr(n.app))return Promise.reject(Gr(n));const i="reauthenticate";try{const s=await Ws(r,pd(n,i,e,r),t);xe(s.idToken,n,"internal-error");const a=Wl(s.idToken);xe(a,n,"internal-error");const{sub:o}=a;return xe(r.uid===o,n,"user-mismatch"),Jn._forOperation(r,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&wr(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function md(r,e,t=!1){if(Cr(r.app))return Promise.reject(Gr(r));const n="signIn",i=await pd(r,n,e),s=await Jn._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(s.user),s}async function bv(r,e){return md(si(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gd(r){const e=si(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Lv(r,e,t){if(Cr(r.app))return Promise.reject(Gr(r));const n=si(r),a=await dl(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Fv).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&gd(r),l}),o=await Jn._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function Mv(r,e,t){return Cr(r.app)?Promise.reject(Gr(r)):bv(gt(r),Qi.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&gd(r),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(r,e){return gt(r).setPersistence(e)}function Bv(r,e,t,n){return gt(r).onIdTokenChanged(e,t,n)}function Uv(r,e,t){return gt(r).beforeAuthStateChanged(e,t)}function Wv(r,e,t,n){return gt(r).onAuthStateChanged(e,t,n)}function Hv(r){return gt(r).signOut()}const Po="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Po,"1"),this.storage.removeItem(Po),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv=1e3,$v=10;class vd extends _d{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ld(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!t&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);ov()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$v):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},jv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}vd.type="LOCAL";const Ed=vd;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd extends _d{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xd.type="SESSION";const Gl=xd;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new ic(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(t.origin,s)),l=await Gv(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ic.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zl(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=zl("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(d){const p=d;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(p.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(){return window}function qv(r){kr().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(){return typeof kr().WorkerGlobalScope<"u"&&typeof kr().importScripts=="function"}async function Kv(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Xv(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)===null||r===void 0?void 0:r.controller)||null}function Yv(){return Td()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd="firebaseLocalStorageDb",Qv=1,ko="firebaseLocalStorage",wd="fbase_key";class da{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sc(r,e){return r.transaction([ko],e?"readwrite":"readonly").objectStore(ko)}function Jv(){const r=indexedDB.deleteDatabase(yd);return new da(r).toPromise()}function pl(){const r=indexedDB.open(yd,Qv);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(ko,{keyPath:wd})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(ko)?e(n):(n.close(),await Jv(),e(await pl()))})})}async function Xh(r,e,t){const n=sc(r,!0).put({[wd]:e,value:t});return new da(n).toPromise()}async function Zv(r,e){const t=sc(r,!1).get(e),n=await new da(t).toPromise();return n===void 0?null:n.value}function Yh(r,e){const t=sc(r,!0).delete(e);return new da(t).toPromise()}const eE=800,tE=3;class Ad{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pl(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>tE)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Td()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ic._getInstance(Yv()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Kv(),!this.activeServiceWorker)return;this.sender=new zv(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((t=n[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Xv()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pl();return await Xh(e,Po,"1"),await Yh(e,Po),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Xh(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>Zv(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Yh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=sc(i,!1).getAll();return new da(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ad.type="LOCAL";const rE=Ad;new ua(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(r,e){return e?$r(e):(xe(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql extends jl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Di(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Di(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Di(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function iE(r){return md(r.auth,new ql(r),r.bypassAuthState)}function sE(r){const{auth:e,user:t}=r;return xe(t,e,"internal-error"),Nv(t,new ql(r),r.bypassAuthState)}async function aE(r){const{auth:e,user:t}=r;return xe(t,e,"internal-error"),Dv(t,new ql(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iE;case"linkViaPopup":case"linkViaRedirect":return aE;case"reauthViaPopup":case"reauthViaRedirect":return sE;default:wr(this.auth,"internal-error")}}resolve(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=new ua(2e3,1e4);class Pi extends Id{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Pi.currentPopupAction&&Pi.currentPopupAction.cancel(),Pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xe(e,this.auth,"internal-error"),e}async onExecution(){Qr(this.filter.length===1,"Popup operations only handle one event");const e=zl();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Pr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Pr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if(!((n=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oE.get())};e()}}Pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE="pendingRedirect",mo=new Map;class lE extends Id{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=mo.get(this.auth._key());if(!e){try{const n=await uE(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}mo.set(this.auth._key(),e)}return this.bypassAuthState||mo.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uE(r,e){const t=dE(e),n=fE(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function hE(r,e){mo.set(r._key(),e)}function fE(r){return $r(r._redirectPersistence)}function dE(r){return po(cE,r.config.apiKey,r.name)}async function pE(r,e,t=!1){if(Cr(r.app))return Promise.reject(Gr(r));const n=si(r),i=nE(n,e),a=await new lE(n,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE=10*60*1e3;class gE{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_E(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Sd(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";t.onError(Pr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=mE&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qh(e))}saveEventToCache(e){this.cachedEventUids.add(Qh(e)),this.lastProcessedEventTime=Date.now()}}function Qh(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function Sd({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _E(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Sd(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vE(r,e={}){return Dn(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xE=/^https?/;async function TE(r){if(r.config.emulator)return;const{authorizedDomains:e}=await vE(r);for(const t of e)try{if(yE(t))return}catch{}wr(r,"unauthorized-domain")}function yE(r){const e=hl(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const a=new URL(r);return a.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===n}if(!xE.test(t))return!1;if(EE.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=new ua(3e4,6e4);function Jh(){const r=kr().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function AE(r){return new Promise((e,t)=>{var n,i,s;function a(){Jh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jh(),t(Pr(r,"network-request-failed"))},timeout:wE.get()})}if(!((i=(n=kr().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=kr().gapi)===null||s===void 0)&&s.load)a();else{const o=gv("iframefcb");return kr()[o]=()=>{gapi.load?a():t(Pr(r,"network-request-failed"))},hd(`${mv()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw go=null,e})}let go=null;function IE(r){return go=go||AE(r),go}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE=new ua(5e3,15e3),RE="__/auth/iframe",CE="emulator/auth/iframe",PE={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function OE(r){const e=r.config;xe(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?Ul(e,CE):`https://${r.config.authDomain}/${RE}`,n={apiKey:e.apiKey,appName:r.name,v:Yi},i=kE.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${la(n).slice(1)}`}async function FE(r){const e=await IE(r),t=kr().gapi;return xe(t,r,"internal-error"),e.open({where:document.body,url:OE(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PE,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Pr(r,"network-request-failed"),o=kr().setTimeout(()=>{s(a)},SE.get());function l(){kr().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},NE=500,bE=600,LE="_blank",ME="http://localhost";class Zh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VE(r,e,t,n=NE,i=bE){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},DE),{width:n.toString(),height:i.toString(),top:s,left:a}),u=Wt().toLowerCase();t&&(o=id(u)?LE:t),rd(u)&&(e=e||ME,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[g,T])=>`${p}${g}=${T},`,"");if(av(u)&&o!=="_self")return BE(e||"",o),new Zh(null);const d=window.open(e||"",o,h);xe(d,r,"popup-blocked");try{d.focus()}catch{}return new Zh(d)}function BE(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE="__/auth/handler",WE="emulator/auth/handler",HE=encodeURIComponent("fac");async function ef(r,e,t,n,i,s){xe(r.config.authDomain,r,"auth-domain-config-required"),xe(r.config.apiKey,r,"invalid-api-key");const a={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:Yi,eventId:i};if(e instanceof dd){e.setDefaultLanguage(r.languageCode),a.providerId=e.providerId||"",C1(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))a[h]=d}if(e instanceof fa){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(a.scopes=h.join(","))}r.tenantId&&(a.tid=r.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await r._getAppCheckToken(),u=l?`#${HE}=${encodeURIComponent(l)}`:"";return`${jE(r)}?${la(o).slice(1)}${u}`}function jE({config:r}){return r.emulator?Ul(r,WE):`https://${r.authDomain}/${UE}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c="webStorageSupport";class $E{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Gl,this._completeRedirectFn=pE,this._overrideRedirectResult=hE}async _openPopup(e,t,n,i){var s;Qr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await ef(e,t,n,hl(),i);return VE(e,a,zl())}async _openRedirect(e,t,n,i){await this._originValidation(e);const s=await ef(e,t,n,hl(),i);return qv(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Qr(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await FE(e),n=new gE(e);return t.register("authEvent",i=>(xe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($c,{type:$c},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[$c];a!==void 0&&t(!!a),wr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=TE(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ld()||nd()||Hl()}}const GE=$E;var tf="@firebase/auth",rf="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){xe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KE(r){Ui(new Yn("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;xe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ud(r)},u=new fv(n,i,s,l);return Tv(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Ui(new Yn("auth-internal",e=>{const t=si(e.getProvider("auth").getImmediate());return(n=>new zE(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),yn(tf,rf,qE(r)),yn(tf,rf,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=5*60,YE=U0("authIdTokenMaxAge")||XE;let nf=null;const QE=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>YE)return;const i=t==null?void 0:t.token;nf!==i&&(nf=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function JE(r=$0()){const e=Ml(r,"auth");if(e.isInitialized())return e.getImmediate();const t=xv(r,{popupRedirectResolver:GE,persistence:[rE,Ed,Gl]}),n=U0("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=QE(s.toString());Uv(t,a,()=>a(t.currentUser)),Bv(t,o=>a(o))}}const i=V0("auth");return i&&yv(t,`http://${i}`),t}function ZE(){var r,e;return(e=(r=document.getElementsByTagName("head"))===null||r===void 0?void 0:r[0])!==null&&e!==void 0?e:document}dv({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=Pr("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",ZE().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KE("Browser");var sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Kn,Rd;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,x){function E(){}E.prototype=x.prototype,w.D=x.prototype,w.prototype=new E,w.prototype.constructor=w,w.C=function(R,P,D){for(var C=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)C[Se-2]=arguments[Se];return x.prototype[P].apply(R,C)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,x,E){E||(E=0);var R=Array(16);if(typeof x=="string")for(var P=0;16>P;++P)R[P]=x.charCodeAt(E++)|x.charCodeAt(E++)<<8|x.charCodeAt(E++)<<16|x.charCodeAt(E++)<<24;else for(P=0;16>P;++P)R[P]=x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24;x=w.g[0],E=w.g[1],P=w.g[2];var D=w.g[3],C=x+(D^E&(P^D))+R[0]+3614090360&4294967295;x=E+(C<<7&4294967295|C>>>25),C=D+(P^x&(E^P))+R[1]+3905402710&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(E^D&(x^E))+R[2]+606105819&4294967295,P=D+(C<<17&4294967295|C>>>15),C=E+(x^P&(D^x))+R[3]+3250441966&4294967295,E=P+(C<<22&4294967295|C>>>10),C=x+(D^E&(P^D))+R[4]+4118548399&4294967295,x=E+(C<<7&4294967295|C>>>25),C=D+(P^x&(E^P))+R[5]+1200080426&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(E^D&(x^E))+R[6]+2821735955&4294967295,P=D+(C<<17&4294967295|C>>>15),C=E+(x^P&(D^x))+R[7]+4249261313&4294967295,E=P+(C<<22&4294967295|C>>>10),C=x+(D^E&(P^D))+R[8]+1770035416&4294967295,x=E+(C<<7&4294967295|C>>>25),C=D+(P^x&(E^P))+R[9]+2336552879&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(E^D&(x^E))+R[10]+4294925233&4294967295,P=D+(C<<17&4294967295|C>>>15),C=E+(x^P&(D^x))+R[11]+2304563134&4294967295,E=P+(C<<22&4294967295|C>>>10),C=x+(D^E&(P^D))+R[12]+1804603682&4294967295,x=E+(C<<7&4294967295|C>>>25),C=D+(P^x&(E^P))+R[13]+4254626195&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(E^D&(x^E))+R[14]+2792965006&4294967295,P=D+(C<<17&4294967295|C>>>15),C=E+(x^P&(D^x))+R[15]+1236535329&4294967295,E=P+(C<<22&4294967295|C>>>10),C=x+(P^D&(E^P))+R[1]+4129170786&4294967295,x=E+(C<<5&4294967295|C>>>27),C=D+(E^P&(x^E))+R[6]+3225465664&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^E&(D^x))+R[11]+643717713&4294967295,P=D+(C<<14&4294967295|C>>>18),C=E+(D^x&(P^D))+R[0]+3921069994&4294967295,E=P+(C<<20&4294967295|C>>>12),C=x+(P^D&(E^P))+R[5]+3593408605&4294967295,x=E+(C<<5&4294967295|C>>>27),C=D+(E^P&(x^E))+R[10]+38016083&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^E&(D^x))+R[15]+3634488961&4294967295,P=D+(C<<14&4294967295|C>>>18),C=E+(D^x&(P^D))+R[4]+3889429448&4294967295,E=P+(C<<20&4294967295|C>>>12),C=x+(P^D&(E^P))+R[9]+568446438&4294967295,x=E+(C<<5&4294967295|C>>>27),C=D+(E^P&(x^E))+R[14]+3275163606&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^E&(D^x))+R[3]+4107603335&4294967295,P=D+(C<<14&4294967295|C>>>18),C=E+(D^x&(P^D))+R[8]+1163531501&4294967295,E=P+(C<<20&4294967295|C>>>12),C=x+(P^D&(E^P))+R[13]+2850285829&4294967295,x=E+(C<<5&4294967295|C>>>27),C=D+(E^P&(x^E))+R[2]+4243563512&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^E&(D^x))+R[7]+1735328473&4294967295,P=D+(C<<14&4294967295|C>>>18),C=E+(D^x&(P^D))+R[12]+2368359562&4294967295,E=P+(C<<20&4294967295|C>>>12),C=x+(E^P^D)+R[5]+4294588738&4294967295,x=E+(C<<4&4294967295|C>>>28),C=D+(x^E^P)+R[8]+2272392833&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^E)+R[11]+1839030562&4294967295,P=D+(C<<16&4294967295|C>>>16),C=E+(P^D^x)+R[14]+4259657740&4294967295,E=P+(C<<23&4294967295|C>>>9),C=x+(E^P^D)+R[1]+2763975236&4294967295,x=E+(C<<4&4294967295|C>>>28),C=D+(x^E^P)+R[4]+1272893353&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^E)+R[7]+4139469664&4294967295,P=D+(C<<16&4294967295|C>>>16),C=E+(P^D^x)+R[10]+3200236656&4294967295,E=P+(C<<23&4294967295|C>>>9),C=x+(E^P^D)+R[13]+681279174&4294967295,x=E+(C<<4&4294967295|C>>>28),C=D+(x^E^P)+R[0]+3936430074&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^E)+R[3]+3572445317&4294967295,P=D+(C<<16&4294967295|C>>>16),C=E+(P^D^x)+R[6]+76029189&4294967295,E=P+(C<<23&4294967295|C>>>9),C=x+(E^P^D)+R[9]+3654602809&4294967295,x=E+(C<<4&4294967295|C>>>28),C=D+(x^E^P)+R[12]+3873151461&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^E)+R[15]+530742520&4294967295,P=D+(C<<16&4294967295|C>>>16),C=E+(P^D^x)+R[2]+3299628645&4294967295,E=P+(C<<23&4294967295|C>>>9),C=x+(P^(E|~D))+R[0]+4096336452&4294967295,x=E+(C<<6&4294967295|C>>>26),C=D+(E^(x|~P))+R[7]+1126891415&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~E))+R[14]+2878612391&4294967295,P=D+(C<<15&4294967295|C>>>17),C=E+(D^(P|~x))+R[5]+4237533241&4294967295,E=P+(C<<21&4294967295|C>>>11),C=x+(P^(E|~D))+R[12]+1700485571&4294967295,x=E+(C<<6&4294967295|C>>>26),C=D+(E^(x|~P))+R[3]+2399980690&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~E))+R[10]+4293915773&4294967295,P=D+(C<<15&4294967295|C>>>17),C=E+(D^(P|~x))+R[1]+2240044497&4294967295,E=P+(C<<21&4294967295|C>>>11),C=x+(P^(E|~D))+R[8]+1873313359&4294967295,x=E+(C<<6&4294967295|C>>>26),C=D+(E^(x|~P))+R[15]+4264355552&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~E))+R[6]+2734768916&4294967295,P=D+(C<<15&4294967295|C>>>17),C=E+(D^(P|~x))+R[13]+1309151649&4294967295,E=P+(C<<21&4294967295|C>>>11),C=x+(P^(E|~D))+R[4]+4149444226&4294967295,x=E+(C<<6&4294967295|C>>>26),C=D+(E^(x|~P))+R[11]+3174756917&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~E))+R[2]+718787259&4294967295,P=D+(C<<15&4294967295|C>>>17),C=E+(D^(P|~x))+R[9]+3951481745&4294967295,w.g[0]=w.g[0]+x&4294967295,w.g[1]=w.g[1]+(P+(C<<21&4294967295|C>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+D&4294967295}n.prototype.u=function(w,x){x===void 0&&(x=w.length);for(var E=x-this.blockSize,R=this.B,P=this.h,D=0;D<x;){if(P==0)for(;D<=E;)i(this,w,D),D+=this.blockSize;if(typeof w=="string"){for(;D<x;)if(R[P++]=w.charCodeAt(D++),P==this.blockSize){i(this,R),P=0;break}}else for(;D<x;)if(R[P++]=w[D++],P==this.blockSize){i(this,R),P=0;break}}this.h=P,this.o+=x},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var x=1;x<w.length-8;++x)w[x]=0;var E=8*this.o;for(x=w.length-8;x<w.length;++x)w[x]=E&255,E/=256;for(this.u(w),w=Array(16),x=E=0;4>x;++x)for(var R=0;32>R;R+=8)w[E++]=this.g[x]>>>R&255;return w};function s(w,x){var E=o;return Object.prototype.hasOwnProperty.call(E,w)?E[w]:E[w]=x(w)}function a(w,x){this.h=x;for(var E=[],R=!0,P=w.length-1;0<=P;P--){var D=w[P]|0;R&&D==x||(E[P]=D,R=!1)}this.g=E}var o={};function l(w){return-128<=w&&128>w?s(w,function(x){return new a([x|0],0>x?-1:0)}):new a([w|0],0>w?-1:0)}function u(w){if(isNaN(w)||!isFinite(w))return d;if(0>w)return y(u(-w));for(var x=[],E=1,R=0;w>=E;R++)x[R]=w/E|0,E*=4294967296;return new a(x,0)}function h(w,x){if(w.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(w.charAt(0)=="-")return y(h(w.substring(1),x));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(x,8)),R=d,P=0;P<w.length;P+=8){var D=Math.min(8,w.length-P),C=parseInt(w.substring(P,P+D),x);8>D?(D=u(Math.pow(x,D)),R=R.j(D).add(u(C))):(R=R.j(E),R=R.add(u(C)))}return R}var d=l(0),p=l(1),g=l(16777216);r=a.prototype,r.m=function(){if(_(this))return-y(this).m();for(var w=0,x=1,E=0;E<this.g.length;E++){var R=this.i(E);w+=(0<=R?R:4294967296+R)*x,x*=4294967296}return w},r.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(T(this))return"0";if(_(this))return"-"+y(this).toString(w);for(var x=u(Math.pow(w,6)),E=this,R="";;){var P=G(E,x).g;E=L(E,P.j(x));var D=((0<E.g.length?E.g[0]:E.h)>>>0).toString(w);if(E=P,T(E))return D+R;for(;6>D.length;)D="0"+D;R=D+R}},r.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function T(w){if(w.h!=0)return!1;for(var x=0;x<w.g.length;x++)if(w.g[x]!=0)return!1;return!0}function _(w){return w.h==-1}r.l=function(w){return w=L(this,w),_(w)?-1:T(w)?0:1};function y(w){for(var x=w.g.length,E=[],R=0;R<x;R++)E[R]=~w.g[R];return new a(E,~w.h).add(p)}r.abs=function(){return _(this)?y(this):this},r.add=function(w){for(var x=Math.max(this.g.length,w.g.length),E=[],R=0,P=0;P<=x;P++){var D=R+(this.i(P)&65535)+(w.i(P)&65535),C=(D>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);R=C>>>16,D&=65535,C&=65535,E[P]=C<<16|D}return new a(E,E[E.length-1]&-2147483648?-1:0)};function L(w,x){return w.add(y(x))}r.j=function(w){if(T(this)||T(w))return d;if(_(this))return _(w)?y(this).j(y(w)):y(y(this).j(w));if(_(w))return y(this.j(y(w)));if(0>this.l(g)&&0>w.l(g))return u(this.m()*w.m());for(var x=this.g.length+w.g.length,E=[],R=0;R<2*x;R++)E[R]=0;for(R=0;R<this.g.length;R++)for(var P=0;P<w.g.length;P++){var D=this.i(R)>>>16,C=this.i(R)&65535,Se=w.i(P)>>>16,Ee=w.i(P)&65535;E[2*R+2*P]+=C*Ee,M(E,2*R+2*P),E[2*R+2*P+1]+=D*Ee,M(E,2*R+2*P+1),E[2*R+2*P+1]+=C*Se,M(E,2*R+2*P+1),E[2*R+2*P+2]+=D*Se,M(E,2*R+2*P+2)}for(R=0;R<x;R++)E[R]=E[2*R+1]<<16|E[2*R];for(R=x;R<2*x;R++)E[R]=0;return new a(E,0)};function M(w,x){for(;(w[x]&65535)!=w[x];)w[x+1]+=w[x]>>>16,w[x]&=65535,x++}function N(w,x){this.g=w,this.h=x}function G(w,x){if(T(x))throw Error("division by zero");if(T(w))return new N(d,d);if(_(w))return x=G(y(w),x),new N(y(x.g),y(x.h));if(_(x))return x=G(w,y(x)),new N(y(x.g),x.h);if(30<w.g.length){if(_(w)||_(x))throw Error("slowDivide_ only works with positive integers.");for(var E=p,R=x;0>=R.l(w);)E=J(E),R=J(R);var P=ne(E,1),D=ne(R,1);for(R=ne(R,2),E=ne(E,2);!T(R);){var C=D.add(R);0>=C.l(w)&&(P=P.add(E),D=C),R=ne(R,1),E=ne(E,1)}return x=L(w,P.j(x)),new N(P,x)}for(P=d;0<=w.l(x);){for(E=Math.max(1,Math.floor(w.m()/x.m())),R=Math.ceil(Math.log(E)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),D=u(E),C=D.j(x);_(C)||0<C.l(w);)E-=R,D=u(E),C=D.j(x);T(D)&&(D=p),P=P.add(D),w=L(w,C)}return new N(P,w)}r.A=function(w){return G(this,w).h},r.and=function(w){for(var x=Math.max(this.g.length,w.g.length),E=[],R=0;R<x;R++)E[R]=this.i(R)&w.i(R);return new a(E,this.h&w.h)},r.or=function(w){for(var x=Math.max(this.g.length,w.g.length),E=[],R=0;R<x;R++)E[R]=this.i(R)|w.i(R);return new a(E,this.h|w.h)},r.xor=function(w){for(var x=Math.max(this.g.length,w.g.length),E=[],R=0;R<x;R++)E[R]=this.i(R)^w.i(R);return new a(E,this.h^w.h)};function J(w){for(var x=w.g.length+1,E=[],R=0;R<x;R++)E[R]=w.i(R)<<1|w.i(R-1)>>>31;return new a(E,w.h)}function ne(w,x){var E=x>>5;x%=32;for(var R=w.g.length-E,P=[],D=0;D<R;D++)P[D]=0<x?w.i(D+E)>>>x|w.i(D+E+1)<<32-x:w.i(D+E);return new a(P,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Rd=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,Kn=a}).apply(typeof sf<"u"?sf:typeof self<"u"?self:typeof window<"u"?window:{});var Za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cd,As,Pd,_o,ml,kd,Od,Fd;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,m){return c==Array.prototype||c==Object.prototype||(c[f]=m.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Za=="object"&&Za];for(var f=0;f<c.length;++f){var m=c[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var n=t(this);function i(c,f){if(f)e:{var m=n;c=c.split(".");for(var A=0;A<c.length-1;A++){var U=c[A];if(!(U in m))break e;m=m[U]}c=c[c.length-1],A=m[c],f=f(A),f!=A&&f!=null&&e(m,c,{configurable:!0,writable:!0,value:f})}}function s(c,f){c instanceof String&&(c+="");var m=0,A=!1,U={next:function(){if(!A&&m<c.length){var K=m++;return{value:f(K,c[K]),done:!1}}return A=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}i("Array.prototype.values",function(c){return c||function(){return s(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function u(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function h(c,f,m){return c.call.apply(c.bind,arguments)}function d(c,f,m){if(!c)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,A),c.apply(f,U)}}return function(){return c.apply(f,arguments)}}function p(c,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function g(c,f){var m=Array.prototype.slice.call(arguments,1);return function(){var A=m.slice();return A.push.apply(A,arguments),c.apply(this,A)}}function T(c,f){function m(){}m.prototype=f.prototype,c.aa=f.prototype,c.prototype=new m,c.prototype.constructor=c,c.Qb=function(A,U,K){for(var ce=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)ce[qe-2]=arguments[qe];return f.prototype[U].apply(A,ce)}}function _(c){const f=c.length;if(0<f){const m=Array(f);for(let A=0;A<f;A++)m[A]=c[A];return m}return[]}function y(c,f){for(let m=1;m<arguments.length;m++){const A=arguments[m];if(l(A)){const U=c.length||0,K=A.length||0;c.length=U+K;for(let ce=0;ce<K;ce++)c[U+ce]=A[ce]}else c.push(A)}}class L{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function M(c){return/^[\s\xa0]*$/.test(c)}function N(){var c=o.navigator;return c&&(c=c.userAgent)?c:""}function G(c){return G[" "](c),c}G[" "]=function(){};var J=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function ne(c,f,m){for(const A in c)f.call(m,c[A],A,c)}function w(c,f){for(const m in c)f.call(void 0,c[m],m,c)}function x(c){const f={};for(const m in c)f[m]=c[m];return f}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(c,f){let m,A;for(let U=1;U<arguments.length;U++){A=arguments[U];for(m in A)c[m]=A[m];for(let K=0;K<E.length;K++)m=E[K],Object.prototype.hasOwnProperty.call(A,m)&&(c[m]=A[m])}}function P(c){var f=1;c=c.split(":");const m=[];for(;0<f&&c.length;)m.push(c.shift()),f--;return c.length&&m.push(c.join(":")),m}function D(c){o.setTimeout(()=>{throw c},0)}function C(){var c=et;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class Se{constructor(){this.h=this.g=null}add(f,m){const A=Ee.get();A.set(f,m),this.h?this.h.next=A:this.g=A,this.h=A}}var Ee=new L(()=>new ft,c=>c.reset());class ft{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Ge,Tt=!1,et=new Se,Ht=()=>{const c=o.Promise.resolve(void 0);Ge=()=>{c.then(jt)}};var jt=()=>{for(var c;c=C();){try{c.h.call(c.g)}catch(m){D(m)}var f=Ee;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}Tt=!1};function b(){this.s=this.s,this.C=this.C}b.prototype.s=!1,b.prototype.ma=function(){this.s||(this.s=!0,this.N())},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var B=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const m=()=>{};o.addEventListener("test",m,f),o.removeEventListener("test",m,f)}catch{}return c}();function V(c,f){if(W.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var m=this.type=c.type,A=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(J){e:{try{G(f.nodeName);var U=!0;break e}catch{}U=!1}U||(f=null)}}else m=="mouseover"?f=c.fromElement:m=="mouseout"&&(f=c.toElement);this.relatedTarget=f,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:ee[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&V.aa.h.call(this)}}T(V,W);var ee={2:"touch",3:"pen",4:"mouse"};V.prototype.h=function(){V.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var pe="closure_listenable_"+(1e6*Math.random()|0),_e=0;function me(c,f,m,A,U){this.listener=c,this.proxy=null,this.src=f,this.type=m,this.capture=!!A,this.ha=U,this.key=++_e,this.da=this.fa=!1}function le(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function De(c){this.src=c,this.g={},this.h=0}De.prototype.add=function(c,f,m,A,U){var K=c.toString();c=this.g[K],c||(c=this.g[K]=[],this.h++);var ce=dt(c,f,A,U);return-1<ce?(f=c[ce],m||(f.fa=!1)):(f=new me(f,this.src,K,!!A,U),f.fa=m,c.push(f)),f};function Re(c,f){var m=f.type;if(m in c.g){var A=c.g[m],U=Array.prototype.indexOf.call(A,f,void 0),K;(K=0<=U)&&Array.prototype.splice.call(A,U,1),K&&(le(f),c.g[m].length==0&&(delete c.g[m],c.h--))}}function dt(c,f,m,A){for(var U=0;U<c.length;++U){var K=c[U];if(!K.da&&K.listener==f&&K.capture==!!m&&K.ha==A)return U}return-1}var ke="closure_lm_"+(1e6*Math.random()|0),er={};function Ke(c,f,m,A,U){if(Array.isArray(f)){for(var K=0;K<f.length;K++)Ke(c,f[K],m,A,U);return null}return m=Vn(m),c&&c[pe]?c.K(f,m,u(A)?!!A.capture:!1,U):de(c,f,m,!1,A,U)}function de(c,f,m,A,U,K){if(!f)throw Error("Invalid event type");var ce=u(U)?!!U.capture:!!U,qe=Mn(c);if(qe||(c[ke]=qe=new De(c)),m=qe.add(f,m,A,ce,K),m.proxy)return m;if(A=qt(),m.proxy=A,A.src=c,A.listener=m,c.addEventListener)B||(U=ce),U===void 0&&(U=!1),c.addEventListener(f.toString(),A,U);else if(c.attachEvent)c.attachEvent(Lr(f.toString()),A);else if(c.addListener&&c.removeListener)c.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return m}function qt(){function c(m){return f.call(c.src,c.listener,m)}const f=Na;return c}function ur(c,f,m,A,U){if(Array.isArray(f))for(var K=0;K<f.length;K++)ur(c,f[K],m,A,U);else A=u(A)?!!A.capture:!!A,m=Vn(m),c&&c[pe]?(c=c.i,f=String(f).toString(),f in c.g&&(K=c.g[f],m=dt(K,m,A,U),-1<m&&(le(K[m]),Array.prototype.splice.call(K,m,1),K.length==0&&(delete c.g[f],c.h--)))):c&&(c=Mn(c))&&(f=c.g[f.toString()],c=-1,f&&(c=dt(f,m,A,U)),(m=-1<c?f[c]:null)&&gr(m))}function gr(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[pe])Re(f.i,c);else{var m=c.type,A=c.proxy;f.removeEventListener?f.removeEventListener(m,A,c.capture):f.detachEvent?f.detachEvent(Lr(m),A):f.addListener&&f.removeListener&&f.removeListener(A),(m=Mn(f))?(Re(m,c),m.h==0&&(m.src=null,f[ke]=null)):le(c)}}}function Lr(c){return c in er?er[c]:er[c]="on"+c}function Na(c,f){if(c.da)c=!0;else{f=new V(f,this);var m=c.listener,A=c.ha||c.src;c.fa&&gr(c),c=m.call(A,f)}return c}function Mn(c){return c=c[ke],c instanceof De?c:null}var Kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vn(c){return typeof c=="function"?c:(c[Kt]||(c[Kt]=function(f){return c.handleEvent(f)}),c[Kt])}function at(){b.call(this),this.i=new De(this),this.M=this,this.F=null}T(at,b),at.prototype[pe]=!0,at.prototype.removeEventListener=function(c,f,m,A){ur(this,c,f,m,A)};function pt(c,f){var m,A=c.F;if(A)for(m=[];A;A=A.F)m.push(A);if(c=c.M,A=f.type||f,typeof f=="string")f=new W(f,c);else if(f instanceof W)f.target=f.target||c;else{var U=f;f=new W(A,c),R(f,U)}if(U=!0,m)for(var K=m.length-1;0<=K;K--){var ce=f.g=m[K];U=hr(ce,A,!0,f)&&U}if(ce=f.g=c,U=hr(ce,A,!0,f)&&U,U=hr(ce,A,!1,f)&&U,m)for(K=0;K<m.length;K++)ce=f.g=m[K],U=hr(ce,A,!1,f)&&U}at.prototype.N=function(){if(at.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var m=c.g[f],A=0;A<m.length;A++)le(m[A]);delete c.g[f],c.h--}}this.F=null},at.prototype.K=function(c,f,m,A){return this.i.add(String(c),f,!1,m,A)},at.prototype.L=function(c,f,m,A){return this.i.add(String(c),f,!0,m,A)};function hr(c,f,m,A){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var U=!0,K=0;K<f.length;++K){var ce=f[K];if(ce&&!ce.da&&ce.capture==m){var qe=ce.listener,wt=ce.ha||ce.src;ce.fa&&Re(c.i,ce),U=qe.call(wt,A)!==!1&&U}}return U&&!A.defaultPrevented}function ba(c,f,m){if(typeof c=="function")m&&(c=p(c,m));else if(c&&typeof c.handleEvent=="function")c=p(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:o.setTimeout(c,f||0)}function os(c){c.g=ba(()=>{c.g=null,c.i&&(c.i=!1,os(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class La extends b{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:os(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function an(c){b.call(this),this.h=c,this.g={}}T(an,b);var cs=[];function ls(c){ne(c.g,function(f,m){this.g.hasOwnProperty(m)&&gr(f)},c),c.g={}}an.prototype.N=function(){an.aa.N.call(this),ls(this)},an.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mi=o.JSON.stringify,Cc=o.JSON.parse,Pc=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function gi(){}gi.prototype.h=null;function us(c){return c.h||(c.h=c.i())}function hs(){}var Bn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fs(){W.call(this,"d")}T(fs,W);function on(){W.call(this,"c")}T(on,W);var Mr={},Ma=null;function _i(){return Ma=Ma||new at}Mr.La="serverreachability";function Va(c){W.call(this,Mr.La,c)}T(Va,W);function Un(c){const f=_i();pt(f,new Va(f))}Mr.STAT_EVENT="statevent";function Ba(c,f){W.call(this,Mr.STAT_EVENT,c),this.stat=f}T(Ba,W);function yt(c){const f=_i();pt(f,new Ba(f,c))}Mr.Ma="timingevent";function Ua(c,f){W.call(this,Mr.Ma,c),this.size=f}T(Ua,W);function Vr(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},f)}function Wn(){this.g=!0}Wn.prototype.xa=function(){this.g=!1};function kc(c,f,m,A,U,K){c.info(function(){if(c.g)if(K)for(var ce="",qe=K.split("&"),wt=0;wt<qe.length;wt++){var Ne=qe[wt].split("=");if(1<Ne.length){var Nt=Ne[0];Ne=Ne[1];var bt=Nt.split("_");ce=2<=bt.length&&bt[1]=="type"?ce+(Nt+"="+Ne+"&"):ce+(Nt+"=redacted&")}}else ce=null;else ce=K;return"XMLHTTP REQ ("+A+") [attempt "+U+"]: "+f+`
`+m+`
`+ce})}function Oc(c,f,m,A,U,K,ce){c.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+U+"]: "+f+`
`+m+`
`+K+" "+ce})}function v(c,f,m,A){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+I(c,m)+(A?" "+A:"")})}function k(c,f){c.info(function(){return"TIMEOUT: "+f})}Wn.prototype.info=function(){};function I(c,f){if(!c.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(c=0;c<m.length;c++)if(Array.isArray(m[c])){var A=m[c];if(!(2>A.length)){var U=A[1];if(Array.isArray(U)&&!(1>U.length)){var K=U[0];if(K!="noop"&&K!="stop"&&K!="close")for(var ce=1;ce<U.length;ce++)U[ce]=""}}}}return mi(m)}catch{return f}}var S={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},O={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},F;function H(){}T(H,gi),H.prototype.g=function(){return new XMLHttpRequest},H.prototype.i=function(){return{}},F=new H;function X(c,f,m,A){this.j=c,this.i=f,this.l=m,this.R=A||1,this.U=new an(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new j}function j(){this.i=null,this.g="",this.h=!1}var z={},q={};function re(c,f,m){c.L=1,c.v=ja(Ur(f)),c.m=m,c.P=!0,oe(c,null)}function oe(c,f){c.F=Date.now(),ue(c),c.A=Ur(c.v);var m=c.A,A=c.R;Array.isArray(A)||(A=[String(A)]),oh(m.i,"t",A),c.C=0,m=c.j.J,c.h=new j,c.g=Ih(c.j,m?f:null,!c.m),0<c.O&&(c.M=new La(p(c.Y,c,c.g),c.O)),f=c.U,m=c.g,A=c.ca;var U="readystatechange";Array.isArray(U)||(U&&(cs[0]=U.toString()),U=cs);for(var K=0;K<U.length;K++){var ce=Ke(m,U[K],A||f.handleEvent,!1,f.h||f);if(!ce)break;f.g[ce.key]=ce}f=c.H?x(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),Un(),kc(c.i,c.u,c.A,c.l,c.R,c.m)}X.prototype.ca=function(c){c=c.target;const f=this.M;f&&Wr(c)==3?f.j():this.Y(c)},X.prototype.Y=function(c){try{if(c==this.g)e:{const bt=Wr(this.g);var f=this.g.Ba();const Ti=this.g.Z();if(!(3>bt)&&(bt!=3||this.g&&(this.h.h||this.g.oa()||ph(this.g)))){this.J||bt!=4||f==7||(f==8||0>=Ti?Un(3):Un(2)),ze(this);var m=this.g.Z();this.X=m;t:if(he(this)){var A=ph(this.g);c="";var U=A.length,K=Wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Je(this),Ve(this);var ce="";break t}this.h.i=new o.TextDecoder}for(f=0;f<U;f++)this.h.h=!0,c+=this.h.i.decode(A[f],{stream:!(K&&f==U-1)});A.length=0,this.h.g+=c,this.C=0,ce=this.h.g}else ce=this.g.oa();if(this.o=m==200,Oc(this.i,this.u,this.A,this.l,this.R,bt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,wt=this.g;if((qe=wt.g?wt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(qe)){var Ne=qe;break t}}Ne=null}if(m=Ne)v(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Br(this,m);else{this.o=!1,this.s=3,yt(12),Je(this),Ve(this);break e}}if(this.P){m=!0;let _r;for(;!this.J&&this.C<ce.length;)if(_r=ie(this,ce),_r==q){bt==4&&(this.s=4,yt(14),m=!1),v(this.i,this.l,null,"[Incomplete Response]");break}else if(_r==z){this.s=4,yt(15),v(this.i,this.l,ce,"[Invalid Chunk]"),m=!1;break}else v(this.i,this.l,_r,null),Br(this,_r);if(he(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bt!=4||ce.length!=0||this.h.h||(this.s=1,yt(16),m=!1),this.o=this.o&&m,!m)v(this.i,this.l,ce,"[Invalid Chunked Response]"),Je(this),Ve(this);else if(0<ce.length&&!this.W){this.W=!0;var Nt=this.j;Nt.g==this&&Nt.ba&&!Nt.M&&(Nt.j.info("Great, no buffering proxy detected. Bytes received: "+ce.length),Lc(Nt),Nt.M=!0,yt(11))}}else v(this.i,this.l,ce,null),Br(this,ce);bt==4&&Je(this),this.o&&!this.J&&(bt==4?Th(this.j,this):(this.o=!1,ue(this)))}else i1(this.g),m==400&&0<ce.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),Je(this),Ve(this)}}}catch{}finally{}};function he(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function ie(c,f){var m=c.C,A=f.indexOf(`
`,m);return A==-1?q:(m=Number(f.substring(m,A)),isNaN(m)?z:(A+=1,A+m>f.length?q:(f=f.slice(A,A+m),c.C=A+m,f)))}X.prototype.cancel=function(){this.J=!0,Je(this)};function ue(c){c.S=Date.now()+c.I,Te(c,c.I)}function Te(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Vr(p(c.ba,c),f)}function ze(c){c.B&&(o.clearTimeout(c.B),c.B=null)}X.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(k(this.i,this.A),this.L!=2&&(Un(),yt(17)),Je(this),this.s=2,Ve(this)):Te(this,this.S-c)};function Ve(c){c.j.G==0||c.J||Th(c.j,c)}function Je(c){ze(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,ls(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function Br(c,f){try{var m=c.j;if(m.G!=0&&(m.g==c||tr(m.h,c))){if(!c.K&&tr(m.h,c)&&m.G==3){try{var A=m.Da.g.parse(f)}catch{A=null}if(Array.isArray(A)&&A.length==3){var U=A;if(U[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<c.F)Xa(m),qa(m);else break e;bc(m),yt(18)}}else m.za=U[1],0<m.za-m.T&&37500>U[2]&&m.F&&m.v==0&&!m.C&&(m.C=Vr(p(m.Za,m),6e3));if(1>=vi(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else $n(m,11)}else if((c.K||m.g==c)&&Xa(m),!M(f))for(U=m.Da.g.parse(f),f=0;f<U.length;f++){let Ne=U[f];if(m.T=Ne[0],Ne=Ne[1],m.G==2)if(Ne[0]=="c"){m.K=Ne[1],m.ia=Ne[2];const Nt=Ne[3];Nt!=null&&(m.la=Nt,m.j.info("VER="+m.la));const bt=Ne[4];bt!=null&&(m.Aa=bt,m.j.info("SVER="+m.Aa));const Ti=Ne[5];Ti!=null&&typeof Ti=="number"&&0<Ti&&(A=1.5*Ti,m.L=A,m.j.info("backChannelRequestTimeoutMs_="+A)),A=m;const _r=c.g;if(_r){const Qa=_r.g?_r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qa){var K=A.h;K.g||Qa.indexOf("spdy")==-1&&Qa.indexOf("quic")==-1&&Qa.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(Fc(K,K.h),K.h=null))}if(A.D){const Mc=_r.g?_r.g.getResponseHeader("X-HTTP-Session-Id"):null;Mc&&(A.ya=Mc,Xe(A.I,A.D,Mc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-c.F,m.j.info("Handshake RTT: "+m.R+"ms")),A=m;var ce=c;if(A.qa=Ah(A,A.J?A.ia:null,A.W),ce.K){Zu(A.h,ce);var qe=ce,wt=A.L;wt&&(qe.I=wt),qe.B&&(ze(qe),ue(qe)),A.g=ce}else Eh(A);0<m.i.length&&Ka(m)}else Ne[0]!="stop"&&Ne[0]!="close"||$n(m,7);else m.G==3&&(Ne[0]=="stop"||Ne[0]=="close"?Ne[0]=="stop"?$n(m,7):Nc(m):Ne[0]!="noop"&&m.l&&m.l.ta(Ne),m.v=0)}}Un(4)}catch{}}var Hn=class{constructor(c,f){this.g=c,this.map=f}};function cn(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ir(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function vi(c){return c.h?1:c.g?c.g.size:0}function tr(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Fc(c,f){c.g?c.g.add(f):c.h=f}function Zu(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}cn.prototype.cancel=function(){if(this.i=eh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function eh(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const m of c.g.values())f=f.concat(m.D);return f}return _(c.i)}function jg(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var f=[],m=c.length,A=0;A<m;A++)f.push(c[A]);return f}f=[],m=0;for(A in c)f[m++]=c[A];return f}function $g(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var f=[];c=c.length;for(var m=0;m<c;m++)f.push(m);return f}f=[],m=0;for(const A in c)f[m++]=A;return f}}}function th(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var m=$g(c),A=jg(c),U=A.length,K=0;K<U;K++)f.call(void 0,A[K],m&&m[K],c)}var rh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gg(c,f){if(c){c=c.split("&");for(var m=0;m<c.length;m++){var A=c[m].indexOf("="),U=null;if(0<=A){var K=c[m].substring(0,A);U=c[m].substring(A+1)}else K=c[m];f(K,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function jn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof jn){this.h=c.h,Wa(this,c.j),this.o=c.o,this.g=c.g,Ha(this,c.s),this.l=c.l;var f=c.i,m=new ms;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),nh(this,m),this.m=c.m}else c&&(f=String(c).match(rh))?(this.h=!1,Wa(this,f[1]||"",!0),this.o=ds(f[2]||""),this.g=ds(f[3]||"",!0),Ha(this,f[4]),this.l=ds(f[5]||"",!0),nh(this,f[6]||"",!0),this.m=ds(f[7]||"")):(this.h=!1,this.i=new ms(null,this.h))}jn.prototype.toString=function(){var c=[],f=this.j;f&&c.push(ps(f,ih,!0),":");var m=this.g;return(m||f=="file")&&(c.push("//"),(f=this.o)&&c.push(ps(f,ih,!0),"@"),c.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&c.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&c.push("/"),c.push(ps(m,m.charAt(0)=="/"?Kg:qg,!0))),(m=this.i.toString())&&c.push("?",m),(m=this.m)&&c.push("#",ps(m,Yg)),c.join("")};function Ur(c){return new jn(c)}function Wa(c,f,m){c.j=m?ds(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function Ha(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function nh(c,f,m){f instanceof ms?(c.i=f,Qg(c.i,c.h)):(m||(f=ps(f,Xg)),c.i=new ms(f,c.h))}function Xe(c,f,m){c.i.set(f,m)}function ja(c){return Xe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function ds(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ps(c,f,m){return typeof c=="string"?(c=encodeURI(c).replace(f,zg),m&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function zg(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ih=/[#\/\?@]/g,qg=/[#\?:]/g,Kg=/[#\?]/g,Xg=/[#\?@]/g,Yg=/#/g;function ms(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function ln(c){c.g||(c.g=new Map,c.h=0,c.i&&Gg(c.i,function(f,m){c.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}r=ms.prototype,r.add=function(c,f){ln(this),this.i=null,c=Ei(this,c);var m=this.g.get(c);return m||this.g.set(c,m=[]),m.push(f),this.h+=1,this};function sh(c,f){ln(c),f=Ei(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function ah(c,f){return ln(c),f=Ei(c,f),c.g.has(f)}r.forEach=function(c,f){ln(this),this.g.forEach(function(m,A){m.forEach(function(U){c.call(f,U,A,this)},this)},this)},r.na=function(){ln(this);const c=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let A=0;A<f.length;A++){const U=c[A];for(let K=0;K<U.length;K++)m.push(f[A])}return m},r.V=function(c){ln(this);let f=[];if(typeof c=="string")ah(this,c)&&(f=f.concat(this.g.get(Ei(this,c))));else{c=Array.from(this.g.values());for(let m=0;m<c.length;m++)f=f.concat(c[m])}return f},r.set=function(c,f){return ln(this),this.i=null,c=Ei(this,c),ah(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},r.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function oh(c,f,m){sh(c,f),0<m.length&&(c.i=null,c.g.set(Ei(c,f),_(m)),c.h+=m.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var A=f[m];const K=encodeURIComponent(String(A)),ce=this.V(A);for(A=0;A<ce.length;A++){var U=K;ce[A]!==""&&(U+="="+encodeURIComponent(String(ce[A]))),c.push(U)}}return this.i=c.join("&")};function Ei(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function Qg(c,f){f&&!c.j&&(ln(c),c.i=null,c.g.forEach(function(m,A){var U=A.toLowerCase();A!=U&&(sh(this,A),oh(this,U,m))},c)),c.j=f}function Jg(c,f){const m=new Wn;if(o.Image){const A=new Image;A.onload=g(un,m,"TestLoadImage: loaded",!0,f,A),A.onerror=g(un,m,"TestLoadImage: error",!1,f,A),A.onabort=g(un,m,"TestLoadImage: abort",!1,f,A),A.ontimeout=g(un,m,"TestLoadImage: timeout",!1,f,A),o.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=c}else f(!1)}function Zg(c,f){const m=new Wn,A=new AbortController,U=setTimeout(()=>{A.abort(),un(m,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:A.signal}).then(K=>{clearTimeout(U),K.ok?un(m,"TestPingServer: ok",!0,f):un(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(U),un(m,"TestPingServer: error",!1,f)})}function un(c,f,m,A,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),A(m)}catch{}}function e1(){this.g=new Pc}function t1(c,f,m){const A=m||"";try{th(c,function(U,K){let ce=U;u(U)&&(ce=mi(U)),f.push(A+K+"="+encodeURIComponent(ce))})}catch(U){throw f.push(A+"type="+encodeURIComponent("_badmap")),U}}function $a(c){this.l=c.Ub||null,this.j=c.eb||!1}T($a,gi),$a.prototype.g=function(){return new Ga(this.l,this.j)},$a.prototype.i=function(c){return function(){return c}}({});function Ga(c,f){at.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Ga,at),r=Ga.prototype,r.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,_s(this)},r.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||o).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gs(this)),this.readyState=0},r.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,_s(this)),this.g&&(this.readyState=3,_s(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ch(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function ch(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}r.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?gs(this):_s(this),this.readyState==3&&ch(this)}},r.Ra=function(c){this.g&&(this.response=this.responseText=c,gs(this))},r.Qa=function(c){this.g&&(this.response=c,gs(this))},r.ga=function(){this.g&&gs(this)};function gs(c){c.readyState=4,c.l=null,c.j=null,c.v=null,_s(c)}r.setRequestHeader=function(c,f){this.u.append(c,f)},r.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,c.push(m[0]+": "+m[1]),m=f.next();return c.join(`\r
`)};function _s(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Ga.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function lh(c){let f="";return ne(c,function(m,A){f+=A,f+=":",f+=m,f+=`\r
`}),f}function Dc(c,f,m){e:{for(A in m){var A=!1;break e}A=!0}A||(m=lh(m),typeof c=="string"?m!=null&&encodeURIComponent(String(m)):Xe(c,f,m))}function tt(c){at.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(tt,at);var r1=/^https?$/i,n1=["POST","PUT"];r=tt.prototype,r.Ha=function(c){this.J=c},r.ea=function(c,f,m,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():F.g(),this.v=this.o?us(this.o):us(F),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(K){uh(this,K);return}if(c=m||"",m=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var U in A)m.set(U,A[U]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const K of A.keys())m.set(K,A.get(K));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(m.keys()).find(K=>K.toLowerCase()=="content-type"),U=o.FormData&&c instanceof o.FormData,!(0<=Array.prototype.indexOf.call(n1,f,void 0))||A||U||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,ce]of m)this.g.setRequestHeader(K,ce);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{dh(this),this.u=!0,this.g.send(c),this.u=!1}catch(K){uh(this,K)}};function uh(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,hh(c),za(c)}function hh(c){c.A||(c.A=!0,pt(c,"complete"),pt(c,"error"))}r.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,pt(this,"complete"),pt(this,"abort"),za(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),za(this,!0)),tt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?fh(this):this.bb())},r.bb=function(){fh(this)};function fh(c){if(c.h&&typeof a<"u"&&(!c.v[1]||Wr(c)!=4||c.Z()!=2)){if(c.u&&Wr(c)==4)ba(c.Ea,0,c);else if(pt(c,"readystatechange"),Wr(c)==4){c.h=!1;try{const ce=c.Z();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var A;if(A=ce===0){var U=String(c.D).match(rh)[1]||null;!U&&o.self&&o.self.location&&(U=o.self.location.protocol.slice(0,-1)),A=!r1.test(U?U.toLowerCase():"")}m=A}if(m)pt(c,"complete"),pt(c,"success");else{c.m=6;try{var K=2<Wr(c)?c.g.statusText:""}catch{K=""}c.l=K+" ["+c.Z()+"]",hh(c)}}finally{za(c)}}}}function za(c,f){if(c.g){dh(c);const m=c.g,A=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||pt(c,"ready");try{m.onreadystatechange=A}catch{}}}function dh(c){c.I&&(o.clearTimeout(c.I),c.I=null)}r.isActive=function(){return!!this.g};function Wr(c){return c.g?c.g.readyState:0}r.Z=function(){try{return 2<Wr(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),Cc(f)}};function ph(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function i1(c){const f={};c=(c.g&&2<=Wr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<c.length;A++){if(M(c[A]))continue;var m=P(c[A]);const U=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const K=f[U]||[];f[U]=K,K.push(m)}w(f,function(A){return A.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function vs(c,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[c]||f}function mh(c){this.Aa=0,this.i=[],this.j=new Wn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=vs("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=vs("baseRetryDelayMs",5e3,c),this.cb=vs("retryDelaySeedMs",1e4,c),this.Wa=vs("forwardChannelMaxRetries",2,c),this.wa=vs("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new cn(c&&c.concurrentRequestLimit),this.Da=new e1,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=mh.prototype,r.la=8,r.G=1,r.connect=function(c,f,m,A){yt(0),this.W=c,this.H=f||{},m&&A!==void 0&&(this.H.OSID=m,this.H.OAID=A),this.F=this.X,this.I=Ah(this,null,this.W),Ka(this)};function Nc(c){if(gh(c),c.G==3){var f=c.U++,m=Ur(c.I);if(Xe(m,"SID",c.K),Xe(m,"RID",f),Xe(m,"TYPE","terminate"),Es(c,m),f=new X(c,c.j,f),f.L=2,f.v=ja(Ur(m)),m=!1,o.navigator&&o.navigator.sendBeacon)try{m=o.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&o.Image&&(new Image().src=f.v,m=!0),m||(f.g=Ih(f.j,null),f.g.ea(f.v)),f.F=Date.now(),ue(f)}wh(c)}function qa(c){c.g&&(Lc(c),c.g.cancel(),c.g=null)}function gh(c){qa(c),c.u&&(o.clearTimeout(c.u),c.u=null),Xa(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&o.clearTimeout(c.s),c.s=null)}function Ka(c){if(!Ir(c.h)&&!c.s){c.s=!0;var f=c.Ga;Ge||Ht(),Tt||(Ge(),Tt=!0),et.add(f,c),c.B=0}}function s1(c,f){return vi(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Vr(p(c.Ga,c,f),yh(c,c.B)),c.B++,!0)}r.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const U=new X(this,this.j,c);let K=this.o;if(this.S&&(K?(K=x(K),R(K,this.S)):K=this.S),this.m!==null||this.O||(U.H=K,K=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var A=this.i[m];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(f+=A,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=vh(this,U,f),m=Ur(this.I),Xe(m,"RID",c),Xe(m,"CVER",22),this.D&&Xe(m,"X-HTTP-Session-Id",this.D),Es(this,m),K&&(this.O?f="headers="+encodeURIComponent(String(lh(K)))+"&"+f:this.m&&Dc(m,this.m,K)),Fc(this.h,U),this.Ua&&Xe(m,"TYPE","init"),this.P?(Xe(m,"$req",f),Xe(m,"SID","null"),U.T=!0,re(U,m,null)):re(U,m,f),this.G=2}}else this.G==3&&(c?_h(this,c):this.i.length==0||Ir(this.h)||_h(this))};function _h(c,f){var m;f?m=f.l:m=c.U++;const A=Ur(c.I);Xe(A,"SID",c.K),Xe(A,"RID",m),Xe(A,"AID",c.T),Es(c,A),c.m&&c.o&&Dc(A,c.m,c.o),m=new X(c,c.j,m,c.B+1),c.m===null&&(m.H=c.o),f&&(c.i=f.D.concat(c.i)),f=vh(c,m,1e3),m.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Fc(c.h,m),re(m,A,f)}function Es(c,f){c.H&&ne(c.H,function(m,A){Xe(f,A,m)}),c.l&&th({},function(m,A){Xe(f,A,m)})}function vh(c,f,m){m=Math.min(c.i.length,m);var A=c.l?p(c.l.Na,c.l,c):null;e:{var U=c.i;let K=-1;for(;;){const ce=["count="+m];K==-1?0<m?(K=U[0].g,ce.push("ofs="+K)):K=0:ce.push("ofs="+K);let qe=!0;for(let wt=0;wt<m;wt++){let Ne=U[wt].g;const Nt=U[wt].map;if(Ne-=K,0>Ne)K=Math.max(0,U[wt].g-100),qe=!1;else try{t1(Nt,ce,"req"+Ne+"_")}catch{A&&A(Nt)}}if(qe){A=ce.join("&");break e}}}return c=c.i.splice(0,m),f.D=c,A}function Eh(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;Ge||Ht(),Tt||(Ge(),Tt=!0),et.add(f,c),c.v=0}}function bc(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Vr(p(c.Fa,c),yh(c,c.v)),c.v++,!0)}r.Fa=function(){if(this.u=null,xh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Vr(p(this.ab,this),c)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),qa(this),xh(this))};function Lc(c){c.A!=null&&(o.clearTimeout(c.A),c.A=null)}function xh(c){c.g=new X(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=Ur(c.qa);Xe(f,"RID","rpc"),Xe(f,"SID",c.K),Xe(f,"AID",c.T),Xe(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&Xe(f,"TO",c.ja),Xe(f,"TYPE","xmlhttp"),Es(c,f),c.m&&c.o&&Dc(f,c.m,c.o),c.L&&(c.g.I=c.L);var m=c.g;c=c.ia,m.L=1,m.v=ja(Ur(f)),m.m=null,m.P=!0,oe(m,c)}r.Za=function(){this.C!=null&&(this.C=null,qa(this),bc(this),yt(19))};function Xa(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function Th(c,f){var m=null;if(c.g==f){Xa(c),Lc(c),c.g=null;var A=2}else if(tr(c.h,f))m=f.D,Zu(c.h,f),A=1;else return;if(c.G!=0){if(f.o)if(A==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var U=c.B;A=_i(),pt(A,new Ua(A,m)),Ka(c)}else Eh(c);else if(U=f.s,U==3||U==0&&0<f.X||!(A==1&&s1(c,f)||A==2&&bc(c)))switch(m&&0<m.length&&(f=c.h,f.i=f.i.concat(m)),U){case 1:$n(c,5);break;case 4:$n(c,10);break;case 3:$n(c,6);break;default:$n(c,2)}}}function yh(c,f){let m=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(m*=2),m*f}function $n(c,f){if(c.j.info("Error code "+f),f==2){var m=p(c.fb,c),A=c.Xa;const U=!A;A=new jn(A||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Wa(A,"https"),ja(A),U?Jg(A.toString(),m):Zg(A.toString(),m)}else yt(2);c.G=0,c.l&&c.l.sa(f),wh(c),gh(c)}r.fb=function(c){c?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function wh(c){if(c.G=0,c.ka=[],c.l){const f=eh(c.h);(f.length!=0||c.i.length!=0)&&(y(c.ka,f),y(c.ka,c.i),c.h.i.length=0,_(c.i),c.i.length=0),c.l.ra()}}function Ah(c,f,m){var A=m instanceof jn?Ur(m):new jn(m);if(A.g!="")f&&(A.g=f+"."+A.g),Ha(A,A.s);else{var U=o.location;A=U.protocol,f=f?f+"."+U.hostname:U.hostname,U=+U.port;var K=new jn(null);A&&Wa(K,A),f&&(K.g=f),U&&Ha(K,U),m&&(K.l=m),A=K}return m=c.D,f=c.ya,m&&f&&Xe(A,m,f),Xe(A,"VER",c.la),Es(c,A),A}function Ih(c,f,m){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new tt(new $a({eb:m})):new tt(c.pa),f.Ha(c.J),f}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sh(){}r=Sh.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Ya(){}Ya.prototype.g=function(c,f){return new rr(c,f)};function rr(c,f){at.call(this),this.g=new mh(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!M(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!M(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new xi(this)}T(rr,at),rr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){Nc(this.g)},rr.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var m={};m.__data__=c,c=m}else this.u&&(m={},m.__data__=mi(c),c=m);f.i.push(new Hn(f.Ya++,c)),f.G==3&&Ka(f)},rr.prototype.N=function(){this.g.l=null,delete this.j,Nc(this.g),delete this.g,rr.aa.N.call(this)};function Rh(c){fs.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const m in f){c=m;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}T(Rh,fs);function Ch(){on.call(this),this.status=1}T(Ch,on);function xi(c){this.g=c}T(xi,Sh),xi.prototype.ua=function(){pt(this.g,"a")},xi.prototype.ta=function(c){pt(this.g,new Rh(c))},xi.prototype.sa=function(c){pt(this.g,new Ch)},xi.prototype.ra=function(){pt(this.g,"b")},Ya.prototype.createWebChannel=Ya.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,Fd=function(){return new Ya},Od=function(){return _i()},kd=Mr,ml={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},S.NO_ERROR=0,S.TIMEOUT=8,S.HTTP_ERROR=6,_o=S,O.COMPLETE="complete",Pd=O,hs.EventType=Bn,Bn.OPEN="a",Bn.CLOSE="b",Bn.ERROR="c",Bn.MESSAGE="d",at.prototype.listen=at.prototype.K,As=hs,tt.prototype.listenOnce=tt.prototype.L,tt.prototype.getLastError=tt.prototype.Ka,tt.prototype.getLastErrorCode=tt.prototype.Ba,tt.prototype.getStatus=tt.prototype.Z,tt.prototype.getResponseJson=tt.prototype.Oa,tt.prototype.getResponseText=tt.prototype.oa,tt.prototype.send=tt.prototype.ea,tt.prototype.setWithCredentials=tt.prototype.Ha,Cd=tt}).apply(typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{});const af="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mt.UNAUTHENTICATED=new Mt(null),Mt.GOOGLE_CREDENTIALS=new Mt("google-credentials-uid"),Mt.FIRST_PARTY=new Mt("first-party-uid"),Mt.MOCK_USER=new Mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ji="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zn=new bl("@firebase/firestore");function xs(){return Zn.logLevel}function ge(r,...e){if(Zn.logLevel<=Pe.DEBUG){const t=e.map(Kl);Zn.debug(`Firestore (${Ji}): ${r}`,...t)}}function Jr(r,...e){if(Zn.logLevel<=Pe.ERROR){const t=e.map(Kl);Zn.error(`Firestore (${Ji}): ${r}`,...t)}}function Wi(r,...e){if(Zn.logLevel<=Pe.WARN){const t=e.map(Kl);Zn.warn(`Firestore (${Ji}): ${r}`,...t)}}function Kl(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(r="Unexpected state"){const e=`FIRESTORE (${Ji}) INTERNAL ASSERTION FAILED: `+r;throw Jr(e),new Error(e)}function He(r,e){r||ye()}function Ae(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends nn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ex{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Mt.UNAUTHENTICATED))}shutdown(){}}class tx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class rx{constructor(e){this.t=e,this.currentUser=Mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){He(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let s=new zr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new zr,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new zr)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(He(typeof n.accessToken=="string"),new Dd(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return He(e===null||typeof e=="string"),new Mt(e)}}class nx{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ix{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new nx(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ax{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){He(this.o===void 0);const n=s=>{s.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,ge("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(He(typeof t.token=="string"),this.R=t.token,new sx(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=ox(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}}function Le(r,e){return r<e?-1:r>e?1:0}function Hi(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new fe(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return st.fromMillis(Date.now())}static fromDate(e){return st.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new st(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.timestamp=e}static fromTimestamp(e){return new we(e)}static min(){return new we(new st(0,0))}static max(){return new we(new st(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,t,n){t===void 0?t=0:t>e.length&&ye(),n===void 0?n=e.length-t:n>e.length-t&&ye(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return js.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof js?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ye extends js{construct(e,t,n){return new Ye(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new fe(Q.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Ye(t)}static emptyPath(){return new Ye([])}}const cx=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rt extends js{construct(e,t,n){return new Rt(e,t,n)}static isValidIdentifier(e){return cx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Rt(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new fe(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new fe(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new fe(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new fe(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Rt(t)}static emptyPath(){return new Rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.path=e}static fromPath(e){return new ve(Ye.fromString(e))}static fromName(e){return new ve(Ye.fromString(e).popFirst(5))}static empty(){return new ve(Ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new Ye(e.slice()))}}function lx(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=we.fromTimestamp(n===1e9?new st(t+1,0):new st(t,n));return new In(i,ve.empty(),e)}function ux(r){return new In(r.readTime,r.key,-1)}class In{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new In(we.min(),ve.empty(),-1)}static max(){return new In(we.max(),ve.empty(),-1)}}function hx(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=ve.comparator(r.documentKey,e.documentKey),t!==0?t:Le(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pa(r){if(r.code!==Q.FAILED_PRECONDITION||r.message!==fx)throw r;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ye(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new te((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof te?t:te.resolve(t)}catch(t){return te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):te.reject(t)}static resolve(e){return new te((t,n)=>{t(e)})}static reject(e){return new te((t,n)=>{n(e)})}static waitFor(e){return new te((t,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&t()},l=>n(l))}),a=!0,s===i&&t()})}static or(e){let t=te.resolve(!1);for(const n of e)t=t.next(i=>i?te.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new te((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(h=>{a[u]=h,++o,o===s&&n(a)},h=>i(h))}})}static doWhile(e,t){return new te((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}function px(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ma(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ie(n),this.se=n=>t.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Xl.oe=-1;function ac(r){return r==null}function Oo(r){return r===0&&1/r==-1/0}function mx(r){return typeof r=="number"&&Number.isInteger(r)&&!Oo(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ai(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function bd(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,t){this.comparator=e,this.root=t||St.EMPTY}insert(e,t){return new Ze(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new Ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eo(this.root,e,this.comparator,!1)}getReverseIterator(){return new eo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eo(this.root,e,this.comparator,!0)}}class eo{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class St{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??St.RED,this.left=i??St.EMPTY,this.right=s??St.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new St(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return St.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return St.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,St.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,St.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ye();const e=this.left.check();if(e!==this.right.check())throw ye();return e+(this.isRed()?0:1)}}St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw ye()}get value(){throw ye()}get color(){throw ye()}get left(){throw ye()}get right(){throw ye()}copy(e,t,n,i,s){return this}insert(e,t,n){return new St(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.comparator=e,this.data=new Ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cf(this.data.getIterator())}getIteratorFrom(e){return new cf(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof kt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new kt(this.comparator);return t.data=e,t}}class cf{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this.fields=e,e.sort(Rt.comparator)}static empty(){return new or([])}unionWith(e){let t=new kt(Rt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new or(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Hi(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Ld("Invalid base64 string: "+s):s}}(e);return new Ft(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ft(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ft.EMPTY_BYTE_STRING=new Ft("");const gx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sn(r){if(He(!!r),typeof r=="string"){let e=0;const t=gx.exec(r);if(He(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:it(r.seconds),nanos:it(r.nanos)}}function it(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function ei(r){return typeof r=="string"?Ft.fromBase64String(r):Ft.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yl(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ql(r){const e=r.mapValue.fields.__previous_value__;return Yl(e)?Ql(e):e}function $s(r){const e=Sn(r.mapValue.fields.__local_write_time__.timestampValue);return new st(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,t,n,i,s,a,o,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Gs{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Gs("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Gs&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to={mapValue:{}};function ti(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Yl(r)?4:Ex(r)?9007199254740991:vx(r)?10:11:ye()}function Nr(r,e){if(r===e)return!0;const t=ti(r);if(t!==ti(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return $s(r).isEqual($s(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Sn(i.timestampValue),o=Sn(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return ei(i.bytesValue).isEqual(ei(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return it(i.geoPointValue.latitude)===it(s.geoPointValue.latitude)&&it(i.geoPointValue.longitude)===it(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return it(i.integerValue)===it(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=it(i.doubleValue),o=it(s.doubleValue);return a===o?Oo(a)===Oo(o):isNaN(a)&&isNaN(o)}return!1}(r,e);case 9:return Hi(r.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(of(a)!==of(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Nr(a[l],o[l])))return!1;return!0}(r,e);default:return ye()}}function zs(r,e){return(r.values||[]).find(t=>Nr(t,e))!==void 0}function ji(r,e){if(r===e)return 0;const t=ti(r),n=ti(e);if(t!==n)return Le(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Le(r.booleanValue,e.booleanValue);case 2:return function(s,a){const o=it(s.integerValue||s.doubleValue),l=it(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(r,e);case 3:return lf(r.timestampValue,e.timestampValue);case 4:return lf($s(r),$s(e));case 5:return Le(r.stringValue,e.stringValue);case 6:return function(s,a){const o=ei(s),l=ei(a);return o.compareTo(l)}(r.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const h=Le(o[u],l[u]);if(h!==0)return h}return Le(o.length,l.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Le(it(s.latitude),it(a.latitude));return o!==0?o:Le(it(s.longitude),it(a.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return uf(r.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,u,h;const d=s.fields||{},p=a.fields||{},g=(o=d.value)===null||o===void 0?void 0:o.arrayValue,T=(l=p.value)===null||l===void 0?void 0:l.arrayValue,_=Le(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((h=T==null?void 0:T.values)===null||h===void 0?void 0:h.length)||0);return _!==0?_:uf(g,T)}(r.mapValue,e.mapValue);case 11:return function(s,a){if(s===to.mapValue&&a===to.mapValue)return 0;if(s===to.mapValue)return 1;if(a===to.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const p=Le(l[d],h[d]);if(p!==0)return p;const g=ji(o[l[d]],u[h[d]]);if(g!==0)return g}return Le(l.length,h.length)}(r.mapValue,e.mapValue);default:throw ye()}}function lf(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Le(r,e);const t=Sn(r),n=Sn(e),i=Le(t.seconds,n.seconds);return i!==0?i:Le(t.nanos,n.nanos)}function uf(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=ji(t[i],n[i]);if(s)return s}return Le(t.length,n.length)}function $i(r){return gl(r)}function gl(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Sn(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return ei(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return ve.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=gl(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${gl(t.fields[a])}`;return i+"}"}(r.mapValue):ye()}function hf(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function _l(r){return!!r&&"integerValue"in r}function Jl(r){return!!r&&"arrayValue"in r}function ff(r){return!!r&&"nullValue"in r}function df(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function vo(r){return!!r&&"mapValue"in r}function vx(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ks(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return ai(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=ks(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ks(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Ex(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.value=e}static empty(){return new Xt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!vo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ks(t)}setAll(e){let t=Rt.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,n,i),n={},i=[],t=o.popLast()}a?n[o.lastSegment()]=ks(a):i.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());vo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];vo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ai(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Xt(ks(this.value))}}function Md(r){const e=[];return ai(r.fields,(t,n)=>{const i=new Rt([t]);if(vo(n)){const s=Md(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new or(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,t,n,i,s,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Vt(e,0,we.min(),we.min(),we.min(),Xt.empty(),0)}static newFoundDocument(e,t,n,i){return new Vt(e,1,t,we.min(),n,i,0)}static newNoDocument(e,t){return new Vt(e,2,t,we.min(),we.min(),Xt.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,we.min(),we.min(),Xt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,t){this.position=e,this.inclusive=t}}function pf(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],a=r.position[i];if(s.field.isKeyField()?n=ve.comparator(ve.fromName(a.referenceValue),t.key):n=ji(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function mf(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Nr(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,t="asc"){this.field=e,this.dir=t}}function xx(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{}class lt extends Vd{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new yx(e,t,n):t==="array-contains"?new Ix(e,n):t==="in"?new Sx(e,n):t==="not-in"?new Rx(e,n):t==="array-contains-any"?new Cx(e,n):new lt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new wx(e,n):new Ax(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ji(t,this.value)):t!==null&&ti(this.value)===ti(t)&&this.matchesComparison(ji(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ar extends Vd{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ar(e,t)}matches(e){return Bd(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Bd(r){return r.op==="and"}function Ud(r){return Tx(r)&&Bd(r)}function Tx(r){for(const e of r.filters)if(e instanceof Ar)return!1;return!0}function vl(r){if(r instanceof lt)return r.field.canonicalString()+r.op.toString()+$i(r.value);if(Ud(r))return r.filters.map(e=>vl(e)).join(",");{const e=r.filters.map(t=>vl(t)).join(",");return`${r.op}(${e})`}}function Wd(r,e){return r instanceof lt?function(n,i){return i instanceof lt&&n.op===i.op&&n.field.isEqual(i.field)&&Nr(n.value,i.value)}(r,e):r instanceof Ar?function(n,i){return i instanceof Ar&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&Wd(a,i.filters[o]),!0):!1}(r,e):void ye()}function Hd(r){return r instanceof lt?function(t){return`${t.field.canonicalString()} ${t.op} ${$i(t.value)}`}(r):r instanceof Ar?function(t){return t.op.toString()+" {"+t.getFilters().map(Hd).join(" ,")+"}"}(r):"Filter"}class yx extends lt{constructor(e,t,n){super(e,t,n),this.key=ve.fromName(n.referenceValue)}matches(e){const t=ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class wx extends lt{constructor(e,t){super(e,"in",t),this.keys=jd("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ax extends lt{constructor(e,t){super(e,"not-in",t),this.keys=jd("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function jd(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>ve.fromName(n.referenceValue))}class Ix extends lt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jl(t)&&zs(t.arrayValue,this.value)}}class Sx extends lt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&zs(this.value.arrayValue,t)}}class Rx extends lt{constructor(e,t){super(e,"not-in",t)}matches(e){if(zs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!zs(this.value.arrayValue,t)}}class Cx extends lt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>zs(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e,t=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function gf(r,e=null,t=[],n=[],i=null,s=null,a=null){return new Px(r,e,t,n,i,s,a)}function Zl(r){const e=Ae(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vl(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ac(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>$i(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>$i(n)).join(",")),e.ue=t}return e.ue}function eu(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!xx(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Wd(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!mf(r.startAt,e.startAt)&&mf(r.endAt,e.endAt)}function El(r){return ve.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,t=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function kx(r,e,t,n,i,s,a,o){return new ga(r,e,t,n,i,s,a,o)}function tu(r){return new ga(r)}function _f(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function $d(r){return r.collectionGroup!==null}function Os(r){const e=Ae(r);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new kt(Rt.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Do(s,n))}),t.has(Rt.keyField().canonicalString())||e.ce.push(new Do(Rt.keyField(),n))}return e.ce}function Or(r){const e=Ae(r);return e.le||(e.le=Ox(e,Os(r))),e.le}function Ox(r,e){if(r.limitType==="F")return gf(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Do(i.field,s)});const t=r.endAt?new Fo(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Fo(r.startAt.position,r.startAt.inclusive):null;return gf(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function xl(r,e){const t=r.filters.concat([e]);return new ga(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Tl(r,e,t){return new ga(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function oc(r,e){return eu(Or(r),Or(e))&&r.limitType===e.limitType}function Gd(r){return`${Zl(Or(r))}|lt:${r.limitType}`}function Ii(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>Hd(i)).join(", ")}]`),ac(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>$i(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>$i(i)).join(",")),`Target(${n})`}(Or(r))}; limitType=${r.limitType})`}function cc(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ve.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of Os(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=pf(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Os(n),i)||n.endAt&&!function(a,o,l){const u=pf(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Os(n),i))}(r,e)}function Fx(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function zd(r){return(e,t)=>{let n=!1;for(const i of Os(r)){const s=Dx(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function Dx(r,e,t){const n=r.field.isKeyField()?ve.comparator(e.key,t.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?ji(l,u):ye()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return ye()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ai(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return bd(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx=new Ze(ve.comparator);function Zr(){return Nx}const qd=new Ze(ve.comparator);function Is(...r){let e=qd;for(const t of r)e=e.insert(t.key,t);return e}function Kd(r){let e=qd;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function qn(){return Fs()}function Xd(){return Fs()}function Fs(){return new Zi(r=>r.toString(),(r,e)=>r.isEqual(e))}const bx=new Ze(ve.comparator),Lx=new kt(ve.comparator);function Ce(...r){let e=Lx;for(const t of r)e=e.add(t);return e}const Mx=new kt(Le);function Vx(){return Mx}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oo(e)?"-0":e}}function Yd(r){return{integerValue:""+r}}function Qd(r,e){return mx(e)?Yd(e):ru(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(){this._=void 0}}function Bx(r,e,t){return r instanceof qs?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Yl(s)&&(s=Ql(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):r instanceof Ks?Zd(r,e):r instanceof Xs?ep(r,e):function(i,s){const a=Jd(i,s),o=vf(a)+vf(i.Pe);return _l(a)&&_l(i.Pe)?Yd(o):ru(i.serializer,o)}(r,e)}function Ux(r,e,t){return r instanceof Ks?Zd(r,e):r instanceof Xs?ep(r,e):t}function Jd(r,e){return r instanceof Ys?function(n){return _l(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class qs extends lc{}class Ks extends lc{constructor(e){super(),this.elements=e}}function Zd(r,e){const t=tp(e);for(const n of r.elements)t.some(i=>Nr(i,n))||t.push(n);return{arrayValue:{values:t}}}class Xs extends lc{constructor(e){super(),this.elements=e}}function ep(r,e){let t=tp(e);for(const n of r.elements)t=t.filter(i=>!Nr(i,n));return{arrayValue:{values:t}}}class Ys extends lc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function vf(r){return it(r.integerValue||r.doubleValue)}function tp(r){return Jl(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,t){this.field=e,this.transform=t}}function Wx(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ks&&i instanceof Ks||n instanceof Xs&&i instanceof Xs?Hi(n.elements,i.elements,Nr):n instanceof Ys&&i instanceof Ys?Nr(n.Pe,i.Pe):n instanceof qs&&i instanceof qs}(r.transform,e.transform)}class Hx{constructor(e,t){this.version=e,this.transformResults=t}}class Fr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Fr}static exists(e){return new Fr(void 0,e)}static updateTime(e){return new Fr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Eo(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class uc{}function np(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new sp(r.key,Fr.none()):new _a(r.key,r.data,Fr.none());{const t=r.data,n=Xt.empty();let i=new kt(Rt.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Nn(r.key,n,new or(i.toArray()),Fr.none())}}function jx(r,e,t){r instanceof _a?function(i,s,a){const o=i.value.clone(),l=xf(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(r,e,t):r instanceof Nn?function(i,s,a){if(!Eo(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=xf(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(ip(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(r,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Ds(r,e,t,n){return r instanceof _a?function(s,a,o,l){if(!Eo(s.precondition,a))return o;const u=s.value.clone(),h=Tf(s.fieldTransforms,l,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(r,e,t,n):r instanceof Nn?function(s,a,o,l){if(!Eo(s.precondition,a))return o;const u=Tf(s.fieldTransforms,l,a),h=a.data;return h.setAll(ip(s)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(r,e,t,n):function(s,a,o){return Eo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(r,e,t)}function $x(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=Jd(n.transform,i||null);s!=null&&(t===null&&(t=Xt.empty()),t.set(n.field,s))}return t||null}function Ef(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Hi(n,i,(s,a)=>Wx(s,a))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class _a extends uc{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Nn extends uc{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function ip(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function xf(r,e,t){const n=new Map;He(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,Ux(a,o,t[i]))}return n}function Tf(r,e,t){const n=new Map;for(const i of r){const s=i.transform,a=t.data.field(i.field);n.set(i.field,Bx(s,a,e))}return n}class sp extends uc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Gx extends uc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&jx(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ds(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ds(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Xd();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=np(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(we.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ce())}isEqual(e){return this.batchId===e.batchId&&Hi(this.mutations,e.mutations,(t,n)=>Ef(t,n))&&Hi(this.baseMutations,e.baseMutations,(t,n)=>Ef(t,n))}}class nu{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){He(e.mutations.length===n.length);let i=function(){return bx}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new nu(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,Oe;function Xx(r){switch(r){default:return ye();case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0}}function ap(r){if(r===void 0)return Jr("GRPC error has no .code"),Q.UNKNOWN;switch(r){case ct.OK:return Q.OK;case ct.CANCELLED:return Q.CANCELLED;case ct.UNKNOWN:return Q.UNKNOWN;case ct.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case ct.INTERNAL:return Q.INTERNAL;case ct.UNAVAILABLE:return Q.UNAVAILABLE;case ct.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case ct.NOT_FOUND:return Q.NOT_FOUND;case ct.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case ct.ABORTED:return Q.ABORTED;case ct.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case ct.DATA_LOSS:return Q.DATA_LOSS;default:return ye()}}(Oe=ct||(ct={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx=new Kn([4294967295,4294967295],0);function yf(r){const e=Yx().encode(r),t=new Rd;return t.update(e),new Uint8Array(t.digest())}function wf(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Kn([t,n],0),new Kn([i,s],0)]}class iu{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ss(`Invalid padding: ${t}`);if(n<0)throw new Ss(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ss(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ss(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Kn.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(Kn.fromNumber(n)));return i.compare(Qx)===1&&(i=new Kn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=yf(e),[n,i]=wf(t);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new iu(s,i,t);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const t=yf(e),[n,i]=wf(t);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ss extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,va.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new hc(we.min(),i,new Ze(Le),Zr(),Ce())}}class va{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new va(n,t,Ce(),Ce(),Ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class op{constructor(e,t){this.targetId=e,this.me=t}}class cp{constructor(e,t,n=Ft.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Af{constructor(){this.fe=0,this.ge=Sf(),this.pe=Ft.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ce(),t=Ce(),n=Ce();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:ye()}}),new va(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Sf()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,He(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Jx{constructor(e){this.Le=e,this.Be=new Map,this.ke=Zr(),this.qe=If(),this.Qe=new Ze(Le)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:ye()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const s=i.target;if(El(s))if(n===0){const a=new ve(s.path);this.Ue(t,a,Vt.newNoDocument(a,we.min()))}else He(n===1);else{const a=this.Ye(t);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=ei(n).toUint8Array()}catch(l){if(l instanceof Ld)return Wi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new iu(a,i,s)}catch(l){return Wi(l instanceof Ss?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&El(o.target)){const l=new ve(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Vt.newNoDocument(l,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let n=Ce();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new hc(e,t,this.Qe,this.ke,n);return this.ke=Zr(),this.qe=If(),this.Qe=new Ze(Le),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Af,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new kt(Le),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Af),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function If(){return new Ze(ve.comparator)}function Sf(){return new Ze(ve.comparator)}const Zx={asc:"ASCENDING",desc:"DESCENDING"},eT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tT={and:"AND",or:"OR"};class rT{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yl(r,e){return r.useProto3Json||ac(e)?e:{value:e}}function No(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function lp(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function nT(r,e){return No(r,e.toTimestamp())}function Dr(r){return He(!!r),we.fromTimestamp(function(t){const n=Sn(t);return new st(n.seconds,n.nanos)}(r))}function su(r,e){return wl(r,e).canonicalString()}function wl(r,e){const t=function(i){return new Ye(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function up(r){const e=Ye.fromString(r);return He(mp(e)),e}function Al(r,e){return su(r.databaseId,e.path)}function Gc(r,e){const t=up(e);if(t.get(1)!==r.databaseId.projectId)throw new fe(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new fe(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new ve(fp(t))}function hp(r,e){return su(r.databaseId,e)}function iT(r){const e=up(r);return e.length===4?Ye.emptyPath():fp(e)}function Il(r){return new Ye(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function fp(r){return He(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Rf(r,e,t){return{name:Al(r,e),fields:t.value.mapValue.fields}}function sT(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ye()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(He(h===void 0||typeof h=="string"),Ft.fromBase64String(h||"")):(He(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Ft.fromUint8Array(h||new Uint8Array))}(r,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const h=u.code===void 0?Q.UNKNOWN:ap(u.code);return new fe(h,u.message||"")}(a);t=new cp(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Gc(r,n.document.name),s=Dr(n.document.updateTime),a=n.document.createTime?Dr(n.document.createTime):we.min(),o=new Xt({mapValue:{fields:n.document.fields}}),l=Vt.newFoundDocument(i,s,a,o),u=n.targetIds||[],h=n.removedTargetIds||[];t=new xo(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Gc(r,n.document),s=n.readTime?Dr(n.readTime):we.min(),a=Vt.newNoDocument(i,s),o=n.removedTargetIds||[];t=new xo([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Gc(r,n.document),s=n.removedTargetIds||[];t=new xo([],s,i,null)}else{if(!("filter"in e))return ye();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new Kx(i,s),o=n.targetId;t=new op(o,a)}}return t}function aT(r,e){let t;if(e instanceof _a)t={update:Rf(r,e.key,e.value)};else if(e instanceof sp)t={delete:Al(r,e.key)};else if(e instanceof Nn)t={update:Rf(r,e.key,e.data),updateMask:mT(e.fieldMask)};else{if(!(e instanceof Gx))return ye();t={verify:Al(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof qs)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ks)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Xs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ys)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw ye()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:nT(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ye()}(r,e.precondition)),t}function oT(r,e){return r&&r.length>0?(He(e!==void 0),r.map(t=>function(i,s){let a=i.updateTime?Dr(i.updateTime):Dr(s);return a.isEqual(we.min())&&(a=Dr(s)),new Hx(a,i.transformResults||[])}(t,e))):[]}function cT(r,e){return{documents:[hp(r,e.path)]}}function lT(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=hp(r,i);const s=function(u){if(u.length!==0)return pp(Ar.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(h=>function(p){return{field:Si(p.field),direction:fT(p.dir)}}(h))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=yl(r,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function uT(r){let e=iT(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){He(n===1);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(d){const p=dp(d);return p instanceof Ar&&Ud(p)?p.getFilters():[p]}(t.where));let a=[];t.orderBy&&(a=function(d){return d.map(p=>function(T){return new Do(Ri(T.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(p))}(t.orderBy));let o=null;t.limit&&(o=function(d){let p;return p=typeof d=="object"?d.value:d,ac(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(d){const p=!!d.before,g=d.values||[];return new Fo(g,p)}(t.startAt));let u=null;return t.endAt&&(u=function(d){const p=!d.before,g=d.values||[];return new Fo(g,p)}(t.endAt)),kx(e,i,a,s,o,"F",l,u)}function hT(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function dp(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Ri(t.unaryFilter.field);return lt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Ri(t.unaryFilter.field);return lt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ri(t.unaryFilter.field);return lt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ri(t.unaryFilter.field);return lt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ye()}}(r):r.fieldFilter!==void 0?function(t){return lt.create(Ri(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ye()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return Ar.create(t.compositeFilter.filters.map(n=>dp(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ye()}}(t.compositeFilter.op))}(r):ye()}function fT(r){return Zx[r]}function dT(r){return eT[r]}function pT(r){return tT[r]}function Si(r){return{fieldPath:r.canonicalString()}}function Ri(r){return Rt.fromServerFormat(r.fieldPath)}function pp(r){return r instanceof lt?function(t){if(t.op==="=="){if(df(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NAN"}};if(ff(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(df(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NOT_NAN"}};if(ff(t.value))return{unaryFilter:{field:Si(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Si(t.field),op:dT(t.op),value:t.value}}}(r):r instanceof Ar?function(t){const n=t.getFilters().map(i=>pp(i));return n.length===1?n[0]:{compositeFilter:{op:pT(t.op),filters:n}}}(r):ye()}function mT(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function mp(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t,n,i,s=we.min(),a=we.min(),o=Ft.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new _n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e){this.ct=e}}function _T(r){const e=uT({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Tl(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(){this.un=new ET}addToCollectionParentIndex(e,t){return this.un.add(t),te.resolve()}getCollectionParents(e,t){return te.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return te.resolve()}deleteFieldIndex(e,t){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,t){return te.resolve()}getDocumentsMatchingTarget(e,t){return te.resolve(null)}getIndexType(e,t){return te.resolve(0)}getFieldIndexes(e,t){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,t){return te.resolve(In.min())}getMinOffsetFromCollectionGroup(e,t){return te.resolve(In.min())}updateCollectionGroup(e,t,n){return te.resolve()}updateIndexEntries(e,t){return te.resolve()}}class ET{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new kt(Ye.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new kt(Ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Gi(0)}static kn(){return new Gi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.changes=new Zi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?te.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Ds(n.mutation,i,or.empty(),st.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Ce()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Ce()){const i=qn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let a=Is();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const n=qn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Ce()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,n,i){let s=Zr();const a=Fs(),o=function(){return Fs()}();return t.forEach((l,u)=>{const h=n.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Nn)?s=s.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),Ds(h.mutation,u,h.mutation.getFieldMask(),st.now())):a.set(u.key,or.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>a.set(u,h)),t.forEach((u,h)=>{var d;return o.set(u,new TT(h,(d=a.get(u))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Fs();let i=new Ze((a,o)=>a-o),s=Ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let h=n.get(l)||or.empty();h=o.applyToLocalView(u,h),n.set(l,h);const d=(i.get(o.batchId)||Ce()).add(l);i=i.insert(o.batchId,d)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,h=l.value,d=Xd();h.forEach(p=>{if(!s.has(p)){const g=np(t.get(p),n.get(p));g!==null&&d.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,d))}return te.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(a){return ve.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):$d(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):te.resolve(qn());let o=-1,l=s;return a.next(u=>te.forEach(u,(h,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),s.get(h)?te.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ce())).next(h=>({batchId:o,changes:Kd(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ve(t)).next(n=>{let i=Is();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let a=Is();return this.indexManager.getCollectionParents(e,s).next(o=>te.forEach(o,l=>{const u=function(d,p){return new ga(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(h=>{h.forEach((d,p)=>{a=a.insert(d,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(a=>{s.forEach((l,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,Vt.newInvalidDocument(h)))});let o=Is();return a.forEach((l,u)=>{const h=s.get(l);h!==void 0&&Ds(h.mutation,u,or.empty(),st.now()),cc(t,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return te.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Dr(i.createTime)}}(t)),te.resolve()}getNamedQuery(e,t){return te.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:_T(i.bundledQuery),readTime:Dr(i.readTime)}}(t)),te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(){this.overlays=new Ze(ve.comparator),this.Ir=new Map}getOverlay(e,t){return te.resolve(this.overlays.get(t))}getOverlays(e,t){const n=qn();return te.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.ht(e,t,s)}),te.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),te.resolve()}getOverlaysForCollection(e,t,n){const i=qn(),s=t.length+1,a=new ve(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return te.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Ze((u,h)=>u-h);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>n){let h=s.get(u.largestBatchId);h===null&&(h=qn(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const o=qn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>o.set(u,h)),!(o.size()>=i)););return te.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new qx(t,n));let s=this.Ir.get(t);s===void 0&&(s=Ce(),this.Ir.set(t,s)),this.Ir.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(){this.sessionToken=Ft.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this.Tr=new kt(_t.Er),this.dr=new kt(_t.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new _t(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Vr(new _t(e,t))}mr(e,t){e.forEach(n=>this.removeReference(n,t))}gr(e){const t=new ve(new Ye([])),n=new _t(t,e),i=new _t(t,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ve(new Ye([])),n=new _t(t,e),i=new _t(t,e+1);let s=Ce();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new _t(e,0),n=this.Tr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class _t{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ve.comparator(e.key,t.key)||Le(e.wr,t.wr)}static Ar(e,t){return Le(e.wr,t.wr)||ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new kt(_t.Er)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new zx(s,t,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new _t(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return te.resolve(a)}lookupMutationBatch(e,t){return te.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),s=i<0?0:i;return te.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new _t(t,0),i=new _t(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),te.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new kt(Le);return t.forEach(i=>{const s=new _t(i,0),a=new _t(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),te.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;ve.isDocumentKey(s)||(s=s.child(""));const a=new _t(new ve(s),0);let o=new kt(Le);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.wr)),!0)},a),te.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){He(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return te.forEach(t.mutations,i=>{const s=new _t(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new _t(t,0),i=this.br.firstAfterOrEqual(n);return te.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e){this.Mr=e,this.docs=function(){return new Ze(ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return te.resolve(n?n.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let n=Zr();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Vt.newInvalidDocument(i))}),te.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Zr();const a=t.path,o=new ve(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||hx(ux(h),n)<=0||(i.has(h.key)||cc(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return te.resolve(s)}getAllFromCollectionGroup(e,t,n,i){ye()}Or(e,t){return te.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new CT(this)}getSize(e){return te.resolve(this.size)}}class CT extends xT{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),te.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e){this.persistence=e,this.Nr=new Zi(t=>Zl(t),eu),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.Lr=0,this.Br=new au,this.targetCount=0,this.kr=Gi.Bn()}forEachTarget(e,t){return this.Nr.forEach((n,i)=>t(i)),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),te.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Gi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,te.resolve()}updateTargetData(e,t){return this.Kn(t),te.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),te.waitFor(s).next(()=>i)}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return te.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),te.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),te.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),te.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return te.resolve(n)}containsKey(e,t){return te.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Xl(0),this.Kr=!1,this.Kr=!0,this.$r=new IT,this.referenceDelegate=e(this),this.Ur=new PT(this),this.indexManager=new vT,this.remoteDocumentCache=function(i){return new RT(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new gT(t),this.Gr=new wT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new ST(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){ge("MemoryPersistence","Starting transaction:",e);const i=new OT(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return te.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class OT extends dx{constructor(e){super(),this.currentSequenceNumber=e}}class ou{constructor(e){this.persistence=e,this.Jr=new au,this.Yr=null}static Zr(e){return new ou(e)}get Xr(){if(this.Yr)return this.Yr;throw ye()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),te.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),te.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),te.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.Xr,n=>{const i=ve.fromPath(n);return this.ei(e,i).next(s=>{s||t.removeEntry(i,we.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(n=>{n?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return te.or([()=>te.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=Ce(),i=Ce();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new cu(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return y1()?8:px(Wt())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new FT;return this.Xi(e,t,a).next(o=>{if(s.result=o,this.zi)return this.es(e,t,a,o.size)})}).next(()=>s.result)}es(e,t,n,i){return n.documentReadCount<this.ji?(xs()<=Pe.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",Ii(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),te.resolve()):(xs()<=Pe.DEBUG&&ge("QueryEngine","Query:",Ii(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(xs()<=Pe.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",Ii(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Or(t))):te.resolve())}Yi(e,t){if(_f(t))return te.resolve(null);let n=Or(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Tl(t,null,"F"),n=Or(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Ce(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(t,o);return this.ns(t,u,a,l.readTime)?this.Yi(e,Tl(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,n,i){return _f(t)||i.isEqual(we.min())?te.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(t,s);return this.ns(t,a,n,i)?te.resolve(null):(xs()<=Pe.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ii(t)),this.rs(e,a,t,lx(i,-1)).next(o=>o))})}ts(e,t){let n=new kt(zd(e));return t.forEach((i,s)=>{cc(e,s)&&(n=n.add(s))}),n}ns(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,n){return xs()<=Pe.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",Ii(t)),this.Ji.getDocumentsMatchingQuery(e,t,In.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ze(Le),this._s=new Zi(s=>Zl(s),eu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function bT(r,e,t,n){return new NT(r,e,t,n)}async function gp(r,e){const t=Ae(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Ce();for(const u of i){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function LT(r,e){const t=Ae(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,h){const d=u.batch,p=d.keys();let g=te.resolve();return p.forEach(T=>{g=g.next(()=>h.getEntry(l,T)).next(_=>{const y=u.docVersions.get(T);He(y!==null),_.version.compareTo(y)<0&&(d.applyToRemoteDocument(_,u),_.isValidDocument()&&(_.setReadTime(u.commitVersion),h.addEntry(_)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Ce();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function _p(r){const e=Ae(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function MT(r,e){const t=Ae(r),n=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const o=[];e.targetChanges.forEach((h,d)=>{const p=i.get(d);if(!p)return;o.push(t.Ur.removeMatchingKeys(s,h.removedDocuments,d).next(()=>t.Ur.addMatchingKeys(s,h.addedDocuments,d)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(Ft.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,n)),i=i.insert(d,g),function(_,y,L){return _.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,g,h)&&o.push(t.Ur.updateTargetData(s,g))});let l=Zr(),u=Ce();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),o.push(VT(s,a,e.documentUpdates).next(h=>{l=h.Ps,u=h.Is})),!n.isEqual(we.min())){const h=t.Ur.getLastRemoteSnapshotVersion(s).next(d=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(h)}return te.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.os=i,s))}function VT(r,e,t){let n=Ce(),i=Ce();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let a=Zr();return t.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(we.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):ge("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function BT(r,e){const t=Ae(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function UT(r,e){const t=Ae(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Ur.getTargetData(n,e).next(s=>s?(i=s,te.resolve(i)):t.Ur.allocateTargetId(n).next(a=>(i=new _n(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(n.targetId,n),t._s.set(e,n.targetId)),n})}async function Sl(r,e,t){const n=Ae(r),i=n.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ma(a))throw a;ge("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function Cf(r,e,t){const n=Ae(r);let i=we.min(),s=Ce();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,h){const d=Ae(l),p=d._s.get(h);return p!==void 0?te.resolve(d.os.get(p)):d.Ur.getTargetData(u,h)}(n,a,Or(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,t?i:we.min(),t?s:Ce())).next(o=>(WT(n,Fx(e),o),{documents:o,Ts:s})))}function WT(r,e,t){let n=r.us.get(e)||we.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.us.set(e,n)}class Pf{constructor(){this.activeTargetIds=Vx()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class HT{constructor(){this.so=new Pf,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Pf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ge("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ge("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ro=null;function zc(){return ro===null?ro=function(){return 268435456+Math.round(2147483648*Math.random())}():ro++,"0x"+ro.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $T={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lt="WebChannelConnection";class zT extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,n,i,s,a){const o=zc(),l=this.xo(t,n.toUriEncodedString());ge("RestConnection",`Sending RPC '${t}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(t,l,u,i).then(h=>(ge("RestConnection",`Received RPC '${t}' ${o}: `,h),h),h=>{throw Wi("RestConnection",`RPC '${t}' ${o} failed with error: `,h,"url: ",l,"request:",i),h})}Lo(t,n,i,s,a,o){return this.Mo(t,n,i,s,a)}Oo(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ji}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,n){const i=$T[t];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const s=zc();return new Promise((a,o)=>{const l=new Cd;l.setWithCredentials(!0),l.listenOnce(Pd.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case _o.NO_ERROR:const h=l.getResponseJson();ge(Lt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case _o.TIMEOUT:ge(Lt,`RPC '${e}' ${s} timed out`),o(new fe(Q.DEADLINE_EXCEEDED,"Request time out"));break;case _o.HTTP_ERROR:const d=l.getStatus();if(ge(Lt,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const T=function(y){const L=y.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(L)>=0?L:Q.UNKNOWN}(g.status);o(new fe(T,g.message))}else o(new fe(Q.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new fe(Q.UNAVAILABLE,"Connection failed."));break;default:ye()}}finally{ge(Lt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);ge(Lt,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",u,n,15)})}Bo(e,t,n){const i=zc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Fd(),o=Od(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const h=s.join("");ge(Lt,`Creating RPC '${e}' stream ${i}: ${h}`,l);const d=a.createWebChannel(h,l);let p=!1,g=!1;const T=new GT({Io:y=>{g?ge(Lt,`Not sending because RPC '${e}' stream ${i} is closed:`,y):(p||(ge(Lt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),ge(Lt,`RPC '${e}' stream ${i} sending:`,y),d.send(y))},To:()=>d.close()}),_=(y,L,M)=>{y.listen(L,N=>{try{M(N)}catch(G){setTimeout(()=>{throw G},0)}})};return _(d,As.EventType.OPEN,()=>{g||(ge(Lt,`RPC '${e}' stream ${i} transport opened.`),T.yo())}),_(d,As.EventType.CLOSE,()=>{g||(g=!0,ge(Lt,`RPC '${e}' stream ${i} transport closed`),T.So())}),_(d,As.EventType.ERROR,y=>{g||(g=!0,Wi(Lt,`RPC '${e}' stream ${i} transport errored:`,y),T.So(new fe(Q.UNAVAILABLE,"The operation could not be completed")))}),_(d,As.EventType.MESSAGE,y=>{var L;if(!g){const M=y.data[0];He(!!M);const N=M,G=N.error||((L=N[0])===null||L===void 0?void 0:L.error);if(G){ge(Lt,`RPC '${e}' stream ${i} received error:`,G);const J=G.status;let ne=function(E){const R=ct[E];if(R!==void 0)return ap(R)}(J),w=G.message;ne===void 0&&(ne=Q.INTERNAL,w="Unknown error status: "+J+" with message "+G.message),g=!0,T.So(new fe(ne,w)),d.close()}else ge(Lt,`RPC '${e}' stream ${i} received:`,M),T.bo(M)}}),_(o,kd.STAT_EVENT,y=>{y.stat===ml.PROXY?ge(Lt,`RPC '${e}' stream ${i} detected buffering proxy`):y.stat===ml.NOPROXY&&ge(Lt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}function qc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(r){return new rT(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&ge("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,t,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new vp(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===Q.RESOURCE_EXHAUSTED?(Jr(t.toString()),Jr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===t&&this.P_(n,i)},n=>{e(()=>{const i=new fe(Q.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ge("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(ge("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class qT extends Ep{constructor(e,t,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=sT(this.serializer,e),n=function(s){if(!("targetChange"in s))return we.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?we.min():a.readTime?Dr(a.readTime):we.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Il(this.serializer),t.addTarget=function(s,a){let o;const l=a.target;if(o=El(l)?{documents:cT(s,l)}:{query:lT(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=lp(s,a.resumeToken);const u=yl(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(we.min())>0){o.readTime=No(s,a.snapshotVersion.toTimestamp());const u=yl(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=hT(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Il(this.serializer),t.removeTarget=e,this.a_(t)}}class KT extends Ep{constructor(e,t,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return He(!!e.streamToken),this.lastStreamToken=e.streamToken,He(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){He(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=oT(e.writeResults,e.commitTime),n=Dr(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Il(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>aT(this.serializer,n))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new fe(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,wl(t,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new fe(Q.UNKNOWN,s.toString())})}Lo(e,t,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,wl(t,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new fe(Q.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class YT{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Jr(t),this.D_=!1):ge("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{oi(this)&&(ge("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=Ae(l);u.L_.add(4),await Ea(u),u.q_.set("Unknown"),u.L_.delete(4),await dc(u)}(this))})}),this.q_=new YT(n,i)}}async function dc(r){if(oi(r))for(const e of r.B_)await e(!0)}async function Ea(r){for(const e of r.B_)await e(!1)}function xp(r,e){const t=Ae(r);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),fu(t)?hu(t):es(t).r_()&&uu(t,e))}function lu(r,e){const t=Ae(r),n=es(t);t.N_.delete(e),n.r_()&&Tp(t,e),t.N_.size===0&&(n.r_()?n.o_():oi(t)&&t.q_.set("Unknown"))}function uu(r,e){if(r.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}es(r).A_(e)}function Tp(r,e){r.Q_.xe(e),es(r).R_(e)}function hu(r){r.Q_=new Jx({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.N_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),es(r).start(),r.q_.v_()}function fu(r){return oi(r)&&!es(r).n_()&&r.N_.size>0}function oi(r){return Ae(r).L_.size===0}function yp(r){r.Q_=void 0}async function JT(r){r.q_.set("Online")}async function ZT(r){r.N_.forEach((e,t)=>{uu(r,e)})}async function ey(r,e){yp(r),fu(r)?(r.q_.M_(e),hu(r)):r.q_.set("Unknown")}async function ty(r,e,t){if(r.q_.set("Online"),e instanceof cp&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(r,e)}catch(n){ge("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await bo(r,n)}else if(e instanceof xo?r.Q_.Ke(e):e instanceof op?r.Q_.He(e):r.Q_.We(e),!t.isEqual(we.min()))try{const n=await _p(r.localStore);t.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.N_.get(u);h&&s.N_.set(u,h.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const h=s.N_.get(l);if(!h)return;s.N_.set(l,h.withResumeToken(Ft.EMPTY_BYTE_STRING,h.snapshotVersion)),Tp(s,l);const d=new _n(h.target,l,u,h.sequenceNumber);uu(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(r,t)}catch(n){ge("RemoteStore","Failed to raise snapshot:",n),await bo(r,n)}}async function bo(r,e,t){if(!ma(e))throw e;r.L_.add(1),await Ea(r),r.q_.set("Offline"),t||(t=()=>_p(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{ge("RemoteStore","Retrying IndexedDB access"),await t(),r.L_.delete(1),await dc(r)})}function wp(r,e){return e().catch(t=>bo(r,t,e))}async function pc(r){const e=Ae(r),t=Rn(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;ry(e);)try{const i=await BT(e.localStore,n);if(i===null){e.O_.length===0&&t.o_();break}n=i.batchId,ny(e,i)}catch(i){await bo(e,i)}Ap(e)&&Ip(e)}function ry(r){return oi(r)&&r.O_.length<10}function ny(r,e){r.O_.push(e);const t=Rn(r);t.r_()&&t.V_&&t.m_(e.mutations)}function Ap(r){return oi(r)&&!Rn(r).n_()&&r.O_.length>0}function Ip(r){Rn(r).start()}async function iy(r){Rn(r).p_()}async function sy(r){const e=Rn(r);for(const t of r.O_)e.m_(t.mutations)}async function ay(r,e,t){const n=r.O_.shift(),i=nu.from(n,e,t);await wp(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await pc(r)}async function oy(r,e){e&&Rn(r).V_&&await async function(n,i){if(function(a){return Xx(a)&&a!==Q.ABORTED}(i.code)){const s=n.O_.shift();Rn(n).s_(),await wp(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await pc(n)}}(r,e),Ap(r)&&Ip(r)}async function Of(r,e){const t=Ae(r);t.asyncQueue.verifyOperationInProgress(),ge("RemoteStore","RemoteStore received new credentials");const n=oi(t);t.L_.add(3),await Ea(t),n&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await dc(t)}async function cy(r,e){const t=Ae(r);e?(t.L_.delete(2),await dc(t)):e||(t.L_.add(2),await Ea(t),t.q_.set("Unknown"))}function es(r){return r.K_||(r.K_=function(t,n,i){const s=Ae(t);return s.w_(),new qT(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:JT.bind(null,r),Ro:ZT.bind(null,r),mo:ey.bind(null,r),d_:ty.bind(null,r)}),r.B_.push(async e=>{e?(r.K_.s_(),fu(r)?hu(r):r.q_.set("Unknown")):(await r.K_.stop(),yp(r))})),r.K_}function Rn(r){return r.U_||(r.U_=function(t,n,i){const s=Ae(t);return s.w_(),new KT(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:()=>Promise.resolve(),Ro:iy.bind(null,r),mo:oy.bind(null,r),f_:sy.bind(null,r),g_:ay.bind(null,r)}),r.B_.push(async e=>{e?(r.U_.s_(),await pc(r)):(await r.U_.stop(),r.O_.length>0&&(ge("RemoteStore",`Stopping write stream with ${r.O_.length} pending writes`),r.O_=[]))})),r.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new zr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const a=Date.now()+n,o=new du(e,t,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pu(r,e){if(Jr("AsyncQueue",`${e}: ${r}`),ma(r))return new fe(Q.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.comparator=e?(t,n)=>e(t,n)||ve.comparator(t.key,n.key):(t,n)=>ve.comparator(t.key,n.key),this.keyedMap=Is(),this.sortedSet=new Ze(this.comparator)}static emptySet(e){return new Ni(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ni)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Ni;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(){this.W_=new Ze(ve.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(t,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(t):e.type===1&&n.type===2?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ye():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class zi{constructor(e,t,n,i,s,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,n,i,s){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new zi(e,t,Ni.emptySet(t),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class uy{constructor(){this.queries=Df(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,n){const i=Ae(t),s=i.queries;i.queries=Df(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new fe(Q.ABORTED,"Firestore shutting down"))}}function Df(){return new Zi(r=>Gd(r),oc)}async function Sp(r,e){const t=Ae(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new ly,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=pu(a,`Initialization of query '${Ii(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&mu(t)}async function Rp(r,e){const t=Ae(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function hy(r,e){const t=Ae(r);let n=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&mu(t)}function fy(r,e,t){const n=Ae(r),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(t);n.queries.delete(e)}function mu(r){r.Y_.forEach(e=>{e.next()})}var Rl,Nf;(Nf=Rl||(Rl={})).ea="default",Nf.Cache="cache";class Cp{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new zi(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const n=t!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=zi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Rl.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e){this.key=e}}class kp{constructor(e){this.key=e}}class dy{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ce(),this.mutatedKeys=Ce(),this.Aa=zd(e),this.Ra=new Ni(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Ff,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,d)=>{const p=i.get(h),g=cc(this.query,d)?d:null,T=!!p&&this.mutatedKeys.has(p.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let y=!1;p&&g?p.data.isEqual(g.data)?T!==_&&(n.track({type:3,doc:g}),y=!0):this.ga(p,g)||(n.track({type:2,doc:g}),y=!0,(l&&this.Aa(g,l)>0||u&&this.Aa(g,u)<0)&&(o=!0)):!p&&g?(n.track({type:0,doc:g}),y=!0):p&&!g&&(n.track({type:1,doc:p}),y=!0,(l||u)&&(o=!0)),y&&(g?(a=a.add(g),s=_?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),n.track({type:1,doc:h})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((h,d)=>function(g,T){const _=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye()}};return _(g)-_(T)}(h.type,d.type)||this.Aa(h.doc,d.doc)),this.pa(n),i=i!=null&&i;const o=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new zi(this.query,e.Ra,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ff,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ce(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const t=[];return e.forEach(n=>{this.da.has(n)||t.push(new kp(n))}),this.da.forEach(n=>{e.has(n)||t.push(new Pp(n))}),t}ba(e){this.Ta=e.Ts,this.da=Ce();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return zi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class py{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class my{constructor(e){this.key=e,this.va=!1}}class gy{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Zi(o=>Gd(o),oc),this.Ma=new Map,this.xa=new Set,this.Oa=new Ze(ve.comparator),this.Na=new Map,this.La=new au,this.Ba={},this.ka=new Map,this.qa=Gi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function _y(r,e,t=!0){const n=Lp(r);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Op(n,e,t,!0),i}async function vy(r,e){const t=Lp(r);await Op(t,e,!0,!1)}async function Op(r,e,t,n){const i=await UT(r.localStore,Or(e)),s=i.targetId,a=r.sharedClientState.addLocalQueryTarget(s,t);let o;return n&&(o=await Ey(r,e,s,a==="current",i.resumeToken)),r.isPrimaryClient&&t&&xp(r.remoteStore,i),o}async function Ey(r,e,t,n,i){r.Ka=(d,p,g)=>async function(_,y,L,M){let N=y.view.ma(L);N.ns&&(N=await Cf(_.localStore,y.query,!1).then(({documents:w})=>y.view.ma(w,N)));const G=M&&M.targetChanges.get(y.targetId),J=M&&M.targetMismatches.get(y.targetId)!=null,ne=y.view.applyChanges(N,_.isPrimaryClient,G,J);return Lf(_,y.targetId,ne.wa),ne.snapshot}(r,d,p,g);const s=await Cf(r.localStore,e,!0),a=new dy(e,s.Ts),o=a.ma(s.documents),l=va.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),u=a.applyChanges(o,r.isPrimaryClient,l);Lf(r,t,u.wa);const h=new py(e,t,a);return r.Fa.set(e,h),r.Ma.has(t)?r.Ma.get(t).push(e):r.Ma.set(t,[e]),u.snapshot}async function xy(r,e,t){const n=Ae(r),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!oc(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Sl(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&lu(n.remoteStore,i.targetId),Cl(n,i.targetId)}).catch(pa)):(Cl(n,i.targetId),await Sl(n.localStore,i.targetId,!0))}async function Ty(r,e){const t=Ae(r),n=t.Fa.get(e),i=t.Ma.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),lu(t.remoteStore,n.targetId))}async function yy(r,e,t){const n=Py(r);try{const i=await function(a,o){const l=Ae(a),u=st.now(),h=o.reduce((g,T)=>g.add(T.key),Ce());let d,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let T=Zr(),_=Ce();return l.cs.getEntries(g,h).next(y=>{T=y,T.forEach((L,M)=>{M.isValidDocument()||(_=_.add(L))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,T)).next(y=>{d=y;const L=[];for(const M of o){const N=$x(M,d.get(M.key).overlayedDocument);N!=null&&L.push(new Nn(M.key,N,Md(N.value.mapValue),Fr.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,L,o)}).next(y=>{p=y;const L=y.applyToLocalDocumentSet(d,_);return l.documentOverlayCache.saveOverlays(g,y.batchId,L)})}).then(()=>({batchId:p.batchId,changes:Kd(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new Ze(Le)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,i.batchId,t),await xa(n,i.changes),await pc(n.remoteStore)}catch(i){const s=pu(i,"Failed to persist write");t.reject(s)}}async function Fp(r,e){const t=Ae(r);try{const n=await MT(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.Na.get(s);a&&(He(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?He(a.va):i.removedDocuments.size>0&&(He(a.va),a.va=!1))}),await xa(t,n,e)}catch(n){await pa(n)}}function bf(r,e,t){const n=Ae(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Ae(a);l.onlineState=o;let u=!1;l.queries.forEach((h,d)=>{for(const p of d.j_)p.Z_(o)&&(u=!0)}),u&&mu(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function wy(r,e,t){const n=Ae(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Ze(ve.comparator);a=a.insert(s,Vt.newNoDocument(s,we.min()));const o=Ce().add(s),l=new hc(we.min(),new Map,new Ze(Le),a,o);await Fp(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),gu(n)}else await Sl(n.localStore,e,!1).then(()=>Cl(n,e,t)).catch(pa)}async function Ay(r,e){const t=Ae(r),n=e.batch.batchId;try{const i=await LT(t.localStore,e);Np(t,n,null),Dp(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await xa(t,i)}catch(i){await pa(i)}}async function Iy(r,e,t){const n=Ae(r);try{const i=await function(a,o){const l=Ae(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,o).next(d=>(He(d!==null),h=d.keys(),l.mutationQueue.removeMutationBatch(u,d))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(n.localStore,e);Np(n,e,t),Dp(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await xa(n,i)}catch(i){await pa(i)}}function Dp(r,e){(r.ka.get(e)||[]).forEach(t=>{t.resolve()}),r.ka.delete(e)}function Np(r,e,t){const n=Ae(r);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Cl(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Ma.get(e))r.Fa.delete(n),t&&r.Ca.$a(n,t);r.Ma.delete(e),r.isPrimaryClient&&r.La.gr(e).forEach(n=>{r.La.containsKey(n)||bp(r,n)})}function bp(r,e){r.xa.delete(e.path.canonicalString());const t=r.Oa.get(e);t!==null&&(lu(r.remoteStore,t),r.Oa=r.Oa.remove(e),r.Na.delete(t),gu(r))}function Lf(r,e,t){for(const n of t)n instanceof Pp?(r.La.addReference(n.key,e),Sy(r,n)):n instanceof kp?(ge("SyncEngine","Document no longer in limbo: "+n.key),r.La.removeReference(n.key,e),r.La.containsKey(n.key)||bp(r,n.key)):ye()}function Sy(r,e){const t=e.key,n=t.path.canonicalString();r.Oa.get(t)||r.xa.has(n)||(ge("SyncEngine","New document in limbo: "+t),r.xa.add(n),gu(r))}function gu(r){for(;r.xa.size>0&&r.Oa.size<r.maxConcurrentLimboResolutions;){const e=r.xa.values().next().value;r.xa.delete(e);const t=new ve(Ye.fromString(e)),n=r.qa.next();r.Na.set(n,new my(t)),r.Oa=r.Oa.insert(t,n),xp(r.remoteStore,new _n(Or(tu(t.path)),n,"TargetPurposeLimboResolution",Xl.oe))}}async function xa(r,e,t){const n=Ae(r),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,t).then(u=>{var h;if((u||t)&&n.isPrimaryClient){const d=u?!u.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){i.push(u);const d=cu.Wi(l.targetId,u);s.push(d)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,u){const h=Ae(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>te.forEach(u,p=>te.forEach(p.$i,g=>h.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>te.forEach(p.Ui,g=>h.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!ma(d))throw d;ge("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const p=d.targetId;if(!d.fromCache){const g=h.os.get(p),T=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(T);h.os=h.os.insert(p,_)}}}(n.localStore,s))}async function Ry(r,e){const t=Ae(r);if(!t.currentUser.isEqual(e)){ge("SyncEngine","User change. New user:",e.toKey());const n=await gp(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new fe(Q.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await xa(t,n.hs)}}function Cy(r,e){const t=Ae(r),n=t.Na.get(e);if(n&&n.va)return Ce().add(n.key);{let i=Ce();const s=t.Ma.get(e);if(!s)return i;for(const a of s){const o=t.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function Lp(r){const e=Ae(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Cy.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wy.bind(null,e),e.Ca.d_=hy.bind(null,e.eventManager),e.Ca.$a=fy.bind(null,e.eventManager),e}function Py(r){const e=Ae(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ay.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Iy.bind(null,e),e}class Lo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return bT(this.persistence,new DT,e.initialUser,this.serializer)}Ga(e){return new kT(ou.Zr,this.serializer)}Wa(e){return new HT}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lo.provider={build:()=>new Lo};class Pl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>bf(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ry.bind(null,this.syncEngine),await cy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new uy}()}createDatastore(e){const t=fc(e.databaseInfo.databaseId),n=function(s){return new zT(s)}(e.databaseInfo);return function(s,a,o,l){return new XT(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,a,o){return new QT(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>bf(this.syncEngine,t,0),function(){return kf.D()?new kf:new jT}())}createSyncEngine(e,t){return function(i,s,a,o,l,u,h){const d=new gy(i,s,a,o,l,u);return h&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Ae(i);ge("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ea(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Pl.provider={build:()=>new Pl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Jr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Mt.UNAUTHENTICATED,this.clientId=Nd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{ge("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(ge("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=pu(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Kc(r,e){r.asyncQueue.verifyOperationInProgress(),ge("FirestoreClient","Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await gp(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function Mf(r,e){r.asyncQueue.verifyOperationInProgress();const t=await Oy(r);ge("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>Of(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>Of(e.remoteStore,i)),r._onlineComponents=e}async function Oy(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){ge("FirestoreClient","Using user provided OfflineComponentProvider");try{await Kc(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Q.FAILED_PRECONDITION||i.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Wi("Error using user provided cache. Falling back to memory cache: "+t),await Kc(r,new Lo)}}else ge("FirestoreClient","Using default OfflineComponentProvider"),await Kc(r,new Lo);return r._offlineComponents}async function Vp(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(ge("FirestoreClient","Using user provided OnlineComponentProvider"),await Mf(r,r._uninitializedComponentsProvider._online)):(ge("FirestoreClient","Using default OnlineComponentProvider"),await Mf(r,new Pl))),r._onlineComponents}function Fy(r){return Vp(r).then(e=>e.syncEngine)}async function Bp(r){const e=await Vp(r),t=e.eventManager;return t.onListen=_y.bind(null,e.syncEngine),t.onUnlisten=xy.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vy.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Ty.bind(null,e.syncEngine),t}function Dy(r,e,t={}){const n=new zr;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const h=new Mp({next:p=>{h.Za(),a.enqueueAndForget(()=>Rp(s,d));const g=p.docs.has(o);!g&&p.fromCache?u.reject(new fe(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?u.reject(new fe(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),d=new Cp(tu(o.path),h,{includeMetadataChanges:!0,_a:!0});return Sp(s,d)}(await Bp(r),r.asyncQueue,e,t,n)),n.promise}function Ny(r,e,t={}){const n=new zr;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const h=new Mp({next:p=>{h.Za(),a.enqueueAndForget(()=>Rp(s,d)),p.fromCache&&l.source==="server"?u.reject(new fe(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),d=new Cp(o,h,{includeMetadataChanges:!0,_a:!0});return Sp(s,d)}(await Bp(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(r,e,t){if(!t)throw new fe(Q.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function by(r,e,t,n){if(e===!0&&n===!0)throw new fe(Q.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Bf(r){if(!ve.isDocumentKey(r))throw new fe(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Uf(r){if(ve.isDocumentKey(r))throw new fe(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function mc(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":ye()}function Cn(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new fe(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=mc(r);throw new fe(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new fe(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new fe(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}by("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Up((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new fe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new fe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new fe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gc{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wf({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wf(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new ex;switch(n.type){case"firstParty":return new ix(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new fe(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Vf.get(t);n&&(ge("ComponentProvider","Removing Datastore"),Vf.delete(t),n.terminate())}(this),Promise.resolve()}}function Ly(r,e,t,n={}){var i;const s=(r=Cn(r,gc))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Mt.MOCK_USER;else{o=m1(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new fe(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Mt(u)}r._authCredentials=new tx(new Dd(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ts(this.firestore,e,this._query)}}class Yt{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yt(this.firestore,e,this._key)}}class wn extends ts{constructor(e,t,n){super(e,t,tu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yt(this.firestore,null,new ve(e))}withConverter(e){return new wn(this.firestore,e,this._path)}}function ci(r,e,...t){if(r=gt(r),Wp("collection","path",e),r instanceof gc){const n=Ye.fromString(e,...t);return Uf(n),new wn(r,null,n)}{if(!(r instanceof Yt||r instanceof wn))throw new fe(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Ye.fromString(e,...t));return Uf(n),new wn(r.firestore,null,n)}}function li(r,e,...t){if(r=gt(r),arguments.length===1&&(e=Nd.newId()),Wp("doc","path",e),r instanceof gc){const n=Ye.fromString(e,...t);return Bf(n),new Yt(r,null,new ve(n))}{if(!(r instanceof Yt||r instanceof wn))throw new fe(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Ye.fromString(e,...t));return Bf(n),new Yt(r.firestore,r instanceof wn?r.converter:null,new ve(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new vp(this,"async_queue_retry"),this.Vu=()=>{const n=qc();n&&ge("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const t=qc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=qc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new zr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ma(e))throw e;ge("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Jr("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=du.createAndSchedule(this,e,t,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ye()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Ta extends gc{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Hf,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Hf(e),this._firestoreClient=void 0,await e}}}function My(r,e){const t=typeof r=="object"?r:$0(),n=typeof r=="string"?r:"(default)",i=Ml(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=d1("firestore");s&&Ly(i,...s)}return i}function _u(r){if(r._terminated)throw new fe(Q.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Vy(r),r._firestoreClient}function Vy(r){var e,t,n;const i=r._freezeSettings(),s=function(o,l,u,h){return new _x(o,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Up(h.experimentalLongPollingOptions),h.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new ky(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qi(Ft.fromBase64String(e))}catch(t){throw new fe(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new qi(Ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By=/^__.*__$/;class Uy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new _a(e,this.data,t,this.fieldTransforms)}}class Hp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function jp(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye()}}class xu{constructor(e,t,n,i,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new xu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Mo(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(jp(this.Cu)&&By.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Wy{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||fc(e)}Qu(e,t,n,i=!1){return new xu({Cu:e,methodName:t,qu:n,path:Rt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tu(r){const e=r._freezeSettings(),t=fc(r._databaseId);return new Wy(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Hy(r,e,t,n,i,s={}){const a=r.Qu(s.merge||s.mergeFields?2:0,e,t,i);Au("Data must be an object, but it was:",a,n);const o=$p(n,a);let l,u;if(s.merge)l=new or(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const p=kl(e,d,t);if(!a.contains(p))throw new fe(Q.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);zp(h,p)||h.push(p)}l=new or(h),u=a.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,u=a.fieldTransforms;return new Uy(new Xt(o),l,u)}class vc extends ya{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof vc}}class yu extends ya{_toFieldTransform(e){return new rp(e.path,new qs)}isEqual(e){return e instanceof yu}}class wu extends ya{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Ys(e.serializer,Qd(e.serializer,this.$u));return new rp(e.path,t)}isEqual(e){return e instanceof wu&&this.$u===e.$u}}function jy(r,e,t,n){const i=r.Qu(1,e,t);Au("Data must be an object, but it was:",i,n);const s=[],a=Xt.empty();ai(n,(l,u)=>{const h=Iu(e,l,t);u=gt(u);const d=i.Nu(h);if(u instanceof vc)s.push(h);else{const p=wa(u,d);p!=null&&(s.push(h),a.set(h,p))}});const o=new or(s);return new Hp(a,o,i.fieldTransforms)}function $y(r,e,t,n,i,s){const a=r.Qu(1,e,t),o=[kl(e,n,t)],l=[i];if(s.length%2!=0)throw new fe(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)o.push(kl(e,s[p])),l.push(s[p+1]);const u=[],h=Xt.empty();for(let p=o.length-1;p>=0;--p)if(!zp(u,o[p])){const g=o[p];let T=l[p];T=gt(T);const _=a.Nu(g);if(T instanceof vc)u.push(g);else{const y=wa(T,_);y!=null&&(u.push(g),h.set(g,y))}}const d=new or(u);return new Hp(h,d,a.fieldTransforms)}function Gy(r,e,t,n=!1){return wa(t,r.Qu(n?4:3,e))}function wa(r,e){if(Gp(r=gt(r)))return Au("Unsupported field value:",e,r),$p(r,e);if(r instanceof ya)return function(n,i){if(!jp(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=wa(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=gt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Qd(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=st.fromDate(n);return{timestampValue:No(i.serializer,s)}}if(n instanceof st){const s=new st(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:No(i.serializer,s)}}if(n instanceof vu)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof qi)return{bytesValue:lp(i.serializer,n._byteString)};if(n instanceof Yt){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:su(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Eu)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return ru(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${mc(n)}`)}(r,e)}function $p(r,e){const t={};return bd(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ai(r,(n,i)=>{const s=wa(i,e.Mu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function Gp(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof st||r instanceof vu||r instanceof qi||r instanceof Yt||r instanceof ya||r instanceof Eu)}function Au(r,e,t){if(!Gp(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=mc(t);throw n==="an object"?e.Bu(r+" a custom object"):e.Bu(r+" "+n)}}function kl(r,e,t){if((e=gt(e))instanceof _c)return e._internalPath;if(typeof e=="string")return Iu(r,e);throw Mo("Field path arguments must be of type string or ",r,!1,void 0,t)}const zy=new RegExp("[~\\*/\\[\\]]");function Iu(r,e,t){if(e.search(zy)>=0)throw Mo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new _c(...e.split("."))._internalPath}catch{throw Mo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Mo(r,e,t,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new fe(Q.INVALID_ARGUMENT,o+r+l)}function zp(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qy(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Su("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class qy extends qp{data(){return super.data()}}function Su(r,e){return typeof e=="string"?Iu(r,e):e instanceof _c?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new fe(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ru{}class Xy extends Ru{}function Aa(r,e,...t){let n=[];e instanceof Ru&&n.push(e),n=n.concat(t),function(s){const a=s.filter(l=>l instanceof Cu).length,o=s.filter(l=>l instanceof Ec).length;if(a>1||a>0&&o>0)throw new fe(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Ec extends Xy{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ec(e,t,n)}_apply(e){const t=this._parse(e);return Kp(e._query,t),new ts(e.firestore,e.converter,xl(e._query,t))}_parse(e){const t=Tu(e.firestore);return function(s,a,o,l,u,h,d){let p;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new fe(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){$f(d,h);const g=[];for(const T of d)g.push(jf(l,s,T));p={arrayValue:{values:g}}}else p=jf(l,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||$f(d,h),p=Gy(o,a,d,h==="in"||h==="not-in");return lt.create(u,h,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ki(r,e,t){const n=e,i=Su("where",r);return Ec._create(i,n,t)}class Cu extends Ru{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Cu(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:Ar.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)Kp(a,l),a=xl(a,l)}(e._query,t),new ts(e.firestore,e.converter,xl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function jf(r,e,t){if(typeof(t=gt(t))=="string"){if(t==="")throw new fe(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$d(e)&&t.indexOf("/")!==-1)throw new fe(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Ye.fromString(t));if(!ve.isDocumentKey(n))throw new fe(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return hf(r,new ve(n))}if(t instanceof Yt)return hf(r,t._key);throw new fe(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mc(t)}.`)}function $f(r,e){if(!Array.isArray(r)||r.length===0)throw new fe(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Kp(r,e){const t=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new fe(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Yy{convertValue(e,t="none"){switch(ti(e)){case 0:return null;case 1:return e.booleanValue;case 2:return it(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ye()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ai(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>it(a.doubleValue));return new Eu(s)}convertGeoPoint(e){return new vu(it(e.latitude),it(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ql(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp($s(e));default:return null}}convertTimestamp(e){const t=Sn(e);return new st(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ye.fromString(e);He(mp(n));const i=new Gs(n.get(1),n.get(3)),s=new ve(n.popFirst(5));return i.isEqual(t)||Jr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(r,e,t){let n;return n=r?r.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xp extends qp{constructor(e,t,n,i,s,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new To(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Su("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class To extends Xp{data(e={}){return super.data(e)}}class Jy{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Rs(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new To(this._firestore,this._userDataWriter,n.key,n,new Rs(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new To(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Rs(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new To(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Rs(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:Zy(o.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Zy(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(r){r=Cn(r,Yt);const e=Cn(r.firestore,Ta);return Dy(_u(e),r._key).then(t=>tw(e,r,t))}class Yp extends Yy{constructor(e){super(),this.firestore=e}convertBytes(e){return new qi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yt(this.firestore,null,t)}}function Ia(r){r=Cn(r,ts);const e=Cn(r.firestore,Ta),t=_u(e),n=new Yp(e);return Ky(r._query),Ny(t,r._query).then(i=>new Jy(e,n,r,i))}function Sa(r,e,t,...n){r=Cn(r,Yt);const i=Cn(r.firestore,Ta),s=Tu(i);let a;return a=typeof(e=gt(e))=="string"||e instanceof _c?$y(s,"updateDoc",r._key,e,t,n):jy(s,"updateDoc",r._key,e),Jp(i,[a.toMutation(r._key,Fr.exists(!0))])}function Qp(r,e){const t=Cn(r.firestore,Ta),n=li(r),i=Qy(r.converter,e);return Jp(t,[Hy(Tu(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Fr.exists(!1))]).then(()=>n)}function Jp(r,e){return function(n,i){const s=new zr;return n.asyncQueue.enqueueAndForget(async()=>yy(await Fy(n),i,s)),s.promise}(_u(r),e)}function tw(r,e,t){const n=t.docs.get(e._key),i=new Yp(r);return new Xp(r,i,e._key,n,new Rs(t.hasPendingWrites,t.fromCache),e.converter)}function rw(){return new yu("serverTimestamp")}function nw(r){return new wu("increment",r)}(function(e,t=!0){(function(i){Ji=i})(Yi),Ui(new Yn("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Ta(new rx(n.getProvider("auth-internal")),new ax(n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new fe(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gs(u.options.projectId,h)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),yn(af,"4.7.3",e),yn(af,"4.7.3","esm2017")})();const iw={apiKey:"AIzaSyDIOKsNlkgdsnPmOuMZKh_t9G_-PUTCDpk",authDomain:"opin-voting.firebaseapp.com",projectId:"opin-voting",storageBucket:"opin-voting.firebasestorage.app",messagingSenderId:"161636127648",appId:"1:161636127648:web:b9fc135d43f2ad3c914ac5"},Zp=j0(iw),rs=JE(Zp),cr=My(Zp);async function em(r){await Vv(rs,r?Ed:Gl)}async function sw(r,e,t=!1){return await em(t),(await Lv(rs,r,e)).user}async function aw(r,e,t=!1){return await em(t),(await Mv(rs,r,e)).user}async function ow(){await Hv(rs)}function tm(r){return Wv(rs,r)}function bn(){return rs.currentUser}const en="opins";function cw(){const r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let t=0;t<8;t++)e+=r.charAt(Math.floor(Math.random()*r.length));return e}async function lw({name:r,question:e,options:t,expiresAt:n,multiSelect:i,maxSelections:s,anonymous:a}){const o=bn();if(!o)throw new Error("You must be logged in to create an Opin");const l=cw(),u={name:r,question:e,options:t,expiresAt:st.fromDate(new Date(n)),multiSelect:i||!1,maxSelections:i?s:1,anonymous:a||!1,status:"active",creatorId:o.uid,creatorEmail:o.email,linkId:l,createdAt:rw(),votes:{}};return t.forEach((d,p)=>{u.votes[p]=0}),{id:(await Qp(ci(cr,en),u)).id,linkId:l}}async function uw(){const r=bn();if(!r)return[];const e=Aa(ci(cr,en),Ki("creatorId","==",r.uid));return(await Ia(e)).docs.map(i=>({id:i.id,...i.data()})).sort((i,s)=>{var l,u,h,d;const a=((u=(l=i.createdAt)==null?void 0:l.toMillis)==null?void 0:u.call(l))||0;return(((d=(h=s.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)-a})}async function hw(r){const e=Aa(ci(cr,en),Ki("linkId","==",r)),t=await Ia(e);if(t.empty)return null;const n=t.docs[0];return{id:n.id,...n.data()}}async function Ra(r){const e=li(cr,en,r),t=await ew(e);return t.exists()?{id:t.id,...t.data()}:null}async function fw(r){const e=bn(),t=await Ra(r);if(!t)throw new Error("Opin not found");if(t.creatorId!==e.uid)throw new Error("You can only pause your own Opins");if(t.status==="ended")throw new Error("Cannot pause an ended Opin");await Sa(li(cr,en,r),{status:"paused"})}async function dw(r){const e=bn(),t=await Ra(r);if(!t)throw new Error("Opin not found");if(t.creatorId!==e.uid)throw new Error("You can only reactivate your own Opins");if(t.status!=="paused")throw new Error("Only paused Opins can be reactivated");await Sa(li(cr,en,r),{status:"active"})}async function pw(r){const e=bn(),t=await Ra(r);if(!t)throw new Error("Opin not found");if(t.creatorId!==e.uid)throw new Error("You can only end your own Opins");await Sa(li(cr,en,r),{status:"ended"})}async function rm(){const r=bn();if(!r)return;const e=st.now(),t=Aa(ci(cr,en),Ki("creatorId","==",r.uid)),n=await Ia(t);for(const i of n.docs){const s=i.data();(s.status==="active"||s.status==="paused")&&s.expiresAt&&s.expiresAt.toMillis()<e.toMillis()&&await Sa(li(cr,en,i.id),{status:"ended"})}}function mw(r){return`${window.location.origin}/vote/${r}`}function gw(r){return`${window.location.origin}/graph/${r}`}const Pu="votes",_w="opins";async function vw(r,e){const t=bn();if(!t)throw new Error("You must be logged in to vote");const n=await Ra(r);if(!n)throw new Error("Opin not found");if(n.status!=="active")throw new Error("This Opin is not accepting votes");if(await nm(r))throw new Error("You have already voted on this Opin");if(e.length===0)throw new Error("Please select at least one option");if(!n.multiSelect&&e.length>1)throw new Error("You can only select one option");if(n.multiSelect&&e.length>n.maxSelections)throw new Error(`You can select at most ${n.maxSelections} options`);await Qp(ci(cr,Pu),{opinId:r,oderId:t.uid,voterEmail:t.email,selectedOptions:e,votedAt:new Date});const s={};e.forEach(a=>{s[`votes.${a}`]=nw(1)}),await Sa(li(cr,_w,r),s)}async function nm(r){const e=bn();if(!e)return!1;const t=Aa(ci(cr,Pu),Ki("opinId","==",r),Ki("oderId","==",e.uid));return!(await Ia(t)).empty}async function Ew(r){const e=Aa(ci(cr,Pu),Ki("opinId","==",r));return(await Ia(e)).docs.map(n=>({id:n.id,...n.data()}))}async function xw(r){const e=await Ra(r);if(!e)return null;const t=await Ew(r),n=e.options.map((i,s)=>{const a=t.filter(o=>o.selectedOptions.includes(s)).map(o=>o.voterEmail);return{text:i,count:e.votes[s]||0,voters:e.anonymous?[]:a}});return{opin:e,options:n,totalVotes:t.length}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Vo={};Vo.version="0.18.5";var im=1252,Tw=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],sm=function(r){Tw.indexOf(r)!=-1&&(im=r)};function yw(){sm(1252)}var Qs=function(r){sm(r)};function ww(){Qs(1200),yw()}var no=function(e){return String.fromCharCode(e)},Gf=function(e){return String.fromCharCode(e)},Bo,vn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Js(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<r.length;)t=r.charCodeAt(u++),s=t>>2,n=r.charCodeAt(u++),a=(t&3)<<4|n>>4,i=r.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=vn.charAt(s)+vn.charAt(a)+vn.charAt(o)+vn.charAt(l);return e}function tn(r){var e="",t=0,n=0,i=0,s=0,a=0,o=0,l=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<r.length;)s=vn.indexOf(r.charAt(u++)),a=vn.indexOf(r.charAt(u++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=vn.indexOf(r.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=vn.indexOf(r.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Me=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),sn=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ri(r){return Me?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function zf(r){return Me?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var xr=function(e){return Me?sn(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function xc(r){if(typeof ArrayBuffer>"u")return xr(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Ca(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function Aw(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var Ct=Me?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:sn(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Iw(r){for(var e=[],t=0,n=r.length+250,i=ri(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>n&&(e.push(i.slice(0,t)),t=0,i=ri(65535),n=65530)}return e.push(i.slice(0,t)),Ct(e)}var Ns=/\u0000/g,io=/[\u0001-\u0006]/g;function bi(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Tr(r,e){var t=""+r;return t.length>=e?t:rt("0",e-t.length)+t}function ku(r,e){var t=""+r;return t.length>=e?t:rt(" ",e-t.length)+t}function Uo(r,e){var t=""+r;return t.length>=e?t:t+rt(" ",e-t.length)}function Sw(r,e){var t=""+Math.round(r);return t.length>=e?t:rt("0",e-t.length)+t}function Rw(r,e){var t=""+r;return t.length>=e?t:rt("0",e-t.length)+t}var qf=Math.pow(2,32);function yi(r,e){if(r>qf||r<-qf)return Sw(r,e);var t=Math.round(r);return Rw(t,e)}function Wo(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Kf=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Cw(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Xf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Pw={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ho(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,a=1,o=0,l=1,u=0,h=0,d=Math.floor(i);u<e&&(d=Math.floor(i),o=d*a+s,h=d*u+l,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,l=u,u=h;if(h>e&&(u>e?(h=l,o=s):(h=u,o=a)),!t)return[0,n*o,h];var p=Math.floor(n*o/h);return[p,n*o-p*h,h]}function so(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,a=[],o={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),t&&(s=Lw(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var am=new Date(1899,11,31,0,0,0),kw=am.getTime(),Ow=new Date(1900,2,1,0,0,0);function om(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=Ow&&(t+=24*60*60*1e3),(t-(kw+(r.getTimezoneOffset()-am.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ou(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Fw(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Dw(r){var e=r<0?12:11,t=Ou(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function Nw(r){var e=Ou(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function bw(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=Dw(r):e===10?t=r.toFixed(10).substr(0,12):t=Nw(r),Ou(Fw(t.toUpperCase()))}function Ol(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):bw(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Pn(14,om(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function Lw(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function Mw(r,e,t,n){var i="",s=0,a=0,o=t.y,l,u=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,u=e.length;break;case 3:return Xc[t.m-1][1];case 5:return Xc[t.m-1][0];default:return Xc[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,u=e.length;break;case 3:return Kf[t.q][0];default:return Kf[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Tr(t.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Tr(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var h=u>0?Tr(l,u):"";return h}function En(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var cm=/%/g;function Vw(r,e,t){var n=e.replace(cm,""),i=e.length-n.length;return qr(r,n,t*Math.pow(10,2*i))+rt("%",i)}function Bw(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return qr(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function lm(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lm(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var um=/# (\?+)( ?)\/( ?)(\d+)/;function Uw(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return t+(s===0?"":""+s)+" "+(a===0?rt(" ",r[1].length+1+r[4].length):ku(a,r[1].length)+r[2]+"/"+r[3]+Tr(o,r[4].length))}function Ww(r,e,t){return t+(e===0?"":""+e)+rt(" ",r[1].length+2+r[4].length)}var hm=/^#*0*\.([0#]+)/,fm=/\).*[0#]/,dm=/\(###\) ###\\?-####/;function $t(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Yf(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Qf(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function Hw(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function jw(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function fr(r,e,t){if(r.charCodeAt(0)===40&&!e.match(fm)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?fr("n",n,t):"("+fr("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Bw(r,e,t);if(e.indexOf("%")!==-1)return Vw(r,e,t);if(e.indexOf("E")!==-1)return lm(e,t);if(e.charCodeAt(0)===36)return"$"+fr(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+yi(l,e.length);if(e.match(/^[#?]+$/))return i=yi(t,0),i==="0"&&(i=""),i.length>e.length?i:$t(e.substr(0,e.length-i.length))+i;if(s=e.match(um))return Uw(s,l,u);if(e.match(/^#+0+$/))return u+yi(l,e.length-e.indexOf("0"));if(s=e.match(hm))return i=Yf(t,s[1].length).replace(/^([^\.]+)$/,"$1."+$t(s[1])).replace(/\.$/,"."+$t(s[1])).replace(/\.(\d*)$/,function(T,_){return"."+_+rt("0",$t(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+Yf(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+En(yi(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+fr(r,e,-t):En(""+(Math.floor(t)+Hw(t,s[1].length)))+"."+Tr(Qf(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return fr(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bi(fr(r,e.replace(/[\\-]/g,""),t)),a=0,bi(bi(e.replace(/\\/g,"")).replace(/[0#]/g,function(T){return a<i.length?i.charAt(a++):T==="0"?"0":""}));if(e.match(dm))return i=fr(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ho(l,Math.pow(10,a)-1,!1),i=""+u,h=qr("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Uo(o[2],a),h.length<s[4].length&&(h=$t(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ho(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ku(o[1],a)+s[2]+"/"+s[3]+Uo(o[2],a):rt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=yi(t,0),e.length<=i.length?i:$t(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,p=e.length-i.length-d;return $t(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Qf(t,s[1].length),t<0?"-"+fr(r,e,-t):En(jw(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?Tr(0,3-T.length):"")+T})+"."+Tr(a,s[1].length);switch(e){case"###,##0.00":return fr(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var g=En(yi(l,0));return g!=="0"?u+g:"";case"###,###.00":return fr(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return fr(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function $w(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return qr(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function Gw(r,e,t){var n=e.replace(cm,""),i=e.length-n.length;return qr(r,n,t*Math.pow(10,2*i))+rt("%",i)}function pm(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+pm(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sr(r,e,t){if(r.charCodeAt(0)===40&&!e.match(fm)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sr("n",n,t):"("+Sr("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return $w(r,e,t);if(e.indexOf("%")!==-1)return Gw(r,e,t);if(e.indexOf("E")!==-1)return pm(e,t);if(e.charCodeAt(0)===36)return"$"+Sr(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+Tr(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:$t(e.substr(0,e.length-i.length))+i;if(s=e.match(um))return Ww(s,l,u);if(e.match(/^#+0+$/))return u+Tr(l,e.length-e.indexOf("0"));if(s=e.match(hm))return i=(""+t).replace(/^([^\.]+)$/,"$1."+$t(s[1])).replace(/\.$/,"."+$t(s[1])),i=i.replace(/\.(\d*)$/,function(T,_){return"."+_+rt("0",$t(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+En(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sr(r,e,-t):En(""+t)+"."+rt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Sr(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bi(Sr(r,e.replace(/[\\-]/g,""),t)),a=0,bi(bi(e.replace(/\\/g,"")).replace(/[0#]/g,function(T){return a<i.length?i.charAt(a++):T==="0"?"0":""}));if(e.match(dm))return i=Sr(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Ho(l,Math.pow(10,a)-1,!1),i=""+u,h=qr("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Uo(o[2],a),h.length<s[4].length&&(h=$t(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Ho(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ku(o[1],a)+s[2]+"/"+s[3]+Uo(o[2],a):rt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:$t(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,p=e.length-i.length-d;return $t(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sr(r,e,-t):En(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?Tr(0,3-T.length):"")+T})+"."+Tr(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=En(""+l);return g!=="0"?u+g:"";default:if(e.match(/\.[0#?]*$/))return Sr(r,e.slice(0,e.lastIndexOf(".")),t)+$t(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function qr(r,e,t){return(t|0)===t?Sr(r,e,t):fr(r,e,t)}function zw(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var mm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function gm(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":Wo(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(mm))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function qw(r,e,t,n){for(var i=[],s="",a=0,o="",l="t",u,h,d,p="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!Wo(r,a))throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=r.charAt(++a),T=g==="("||g===")"?g:"t";i[i.length]={t:T,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(u==null&&(u=so(e,t,r.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:r.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=so(e,t),u==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var _={t:o,v:o};if(u==null&&(u=so(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(_.v=u.H>=12?"P":"A"),_.t="T",p="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(_.v=u.H>=12?"PM":"AM"),_.t="T",a+=5,p="h"):r.substr(a,5).toUpperCase()==="/"?(u!=null&&(_.v=u.H>=12?"":""),_.t="T",a+=5,p="h"):(_.t="t",++a),u==null&&_.t==="T")return"";i[i.length]=_,l=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(mm)){if(u==null&&(u=so(e,t),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",gm(r)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"t",v:o},++a;break}var y=0,L=0,M;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",y<1&&(y=1);break;case"s":(M=i[a].v.match(/\.0+$/))&&(L=Math.max(L,M[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[a].v.match(/[Hh]/)&&(y=1),y<2&&i[a].v.match(/[Mm]/)&&(y=2),y<3&&i[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var N="",G;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Mw(i[a].t.charCodeAt(0),i[a].v,u,L),i[a].t="t";break;case"n":case"?":for(G=a+1;i[G]!=null&&((o=i[G].t)==="?"||o==="D"||(o===" "||o==="t")&&i[G+1]!=null&&(i[G+1].t==="?"||i[G+1].t==="t"&&i[G+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[G].v==="/"||i[G].v===" "&&i[G+1]!=null&&i[G+1].t=="?"));)i[a].v+=i[G].v,i[G]={v:"",t:";"},++G;N+=i[a].v,a=G-1;break;case"G":i[a].t="t",i[a].v=Ol(e,t);break}var J="",ne,w;if(N.length>0){N.charCodeAt(0)==40?(ne=e<0&&N.charCodeAt(0)===45?-e:e,w=qr("n",N,ne)):(ne=e<0&&n>1?-e:e,w=qr("n",N,ne),ne<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),G=w.length-1;var x=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){x=a;break}var E=i.length;if(x===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(G>=i[a].v.length-1?(G-=i[a].v.length,i[a].v=w.substr(G+1,i[a].v.length)):G<0?i[a].v="":(i[a].v=w.substr(0,G+1),G=-1),i[a].t="t",E=a);G>=0&&E<i.length&&(i[E].v=w.substr(0,G+1)+i[E].v)}else if(x!==i.length&&w.indexOf("E")===-1){for(G=w.indexOf(".")-1,a=x;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===x?i[a].v.indexOf(".")-1:i[a].v.length-1,J=i[a].v.substr(h+1);h>=0;--h)G>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(J=w.charAt(G--)+J);i[a].v=J,i[a].t="t",E=a}for(G>=0&&E<i.length&&(i[E].v=w.substr(0,G+1)+i[E].v),G=w.indexOf(".")+1,a=x;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==x)){for(h=i[a].v.indexOf(".")>-1&&a===x?i[a].v.indexOf(".")+1:0,J=i[a].v.substr(0,h);h<i[a].v.length;++h)G<w.length&&(J+=w.charAt(G++));i[a].v=J,i[a].t="t",E=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(ne=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=qr(i[a].t,i[a].v,ne),i[a].t="t");var R="";for(a=0;a!==i.length;++a)i[a]!=null&&(R+=i[a].v);return R}var Jf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Zf(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function Kw(r,e){var t=zw(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Jf),o=t[1].match(Jf);return Zf(e,a)?[n,t[0]]:Zf(e,o)?[n,t[1]]:[n,t[a!=null&&o!=null?2:1]]}return[n,s]}function Pn(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:nt)[r],n==null&&(n=t.table&&t.table[Xf[r]]||nt[Xf[r]]),n==null&&(n=Pw[r]||"General");break}if(Wo(n,0))return Ol(e,t);e instanceof Date&&(e=om(e,t.date1904));var i=Kw(n,e);if(Wo(i[1]))return Ol(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return qw(i[1],e,t,i[0])}function _m(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(nt[t]==null){e<0&&(e=t);continue}if(nt[t]==r){e=t;break}}e<0&&(e=391)}return nt[e]=r,e}function Tc(r){for(var e=0;e!=392;++e)r[e]!==void 0&&_m(r[e],e)}function yc(){nt=Cw()}var vm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Xw(r){var e=typeof r=="number"?nt[r]:r;return e=e.replace(vm,"(\\d+)"),new RegExp("^"+e+"$")}function Yw(r,e,t){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(vm)||[]).forEach(function(d,p){var g=parseInt(t[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":l=g;break;case"m":a>=0?o=g:i=g;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?h:u+"T"+h}var Qw=function(){var r={};r.version="1.2.0";function e(){for(var w=0,x=new Array(256),E=0;E!=256;++E)w=E,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,x[E]=w;return typeof Int32Array<"u"?new Int32Array(x):x}var t=e();function n(w){var x=0,E=0,R=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)P[R]=w[R];for(R=0;R!=256;++R)for(E=w[R],x=256+R;x<4096;x+=256)E=P[x]=E>>>8^w[E&255];var D=[];for(R=1;R!=16;++R)D[R-1]=typeof Int32Array<"u"?P.subarray(R*256,R*256+256):P.slice(R*256,R*256+256);return D}var i=n(t),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],h=i[5],d=i[6],p=i[7],g=i[8],T=i[9],_=i[10],y=i[11],L=i[12],M=i[13],N=i[14];function G(w,x){for(var E=x^-1,R=0,P=w.length;R<P;)E=E>>>8^t[(E^w.charCodeAt(R++))&255];return~E}function J(w,x){for(var E=x^-1,R=w.length-15,P=0;P<R;)E=N[w[P++]^E&255]^M[w[P++]^E>>8&255]^L[w[P++]^E>>16&255]^y[w[P++]^E>>>24]^_[w[P++]]^T[w[P++]]^g[w[P++]]^p[w[P++]]^d[w[P++]]^h[w[P++]]^u[w[P++]]^l[w[P++]]^o[w[P++]]^a[w[P++]]^s[w[P++]]^t[w[P++]];for(R+=15;P<R;)E=E>>>8^t[(E^w[P++])&255];return~E}function ne(w,x){for(var E=x^-1,R=0,P=w.length,D=0,C=0;R<P;)D=w.charCodeAt(R++),D<128?E=E>>>8^t[(E^D)&255]:D<2048?(E=E>>>8^t[(E^(192|D>>6&31))&255],E=E>>>8^t[(E^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,C=w.charCodeAt(R++)&1023,E=E>>>8^t[(E^(240|D>>8&7))&255],E=E>>>8^t[(E^(128|D>>2&63))&255],E=E>>>8^t[(E^(128|C>>6&15|(D&3)<<4))&255],E=E>>>8^t[(E^(128|C&63))&255]):(E=E>>>8^t[(E^(224|D>>12&15))&255],E=E>>>8^t[(E^(128|D>>6&63))&255],E=E>>>8^t[(E^(128|D&63))&255]);return~E}return r.table=t,r.bstr=G,r.buf=J,r.str=ne,r}(),$e=function(){var e={};e.version="1.2.1";function t(v,k){for(var I=v.split("/"),S=k.split("/"),O=0,F=0,H=Math.min(I.length,S.length);O<H;++O){if(F=I[O].length-S[O].length)return F;if(I[O]!=S[O])return I[O]<S[O]?-1:1}return I.length-S.length}function n(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:n(v.slice(0,-1));var k=v.lastIndexOf("/");return k===-1?v:v.slice(0,k+1)}function i(v){if(v.charAt(v.length-1)=="/")return i(v.slice(0,-1));var k=v.lastIndexOf("/");return k===-1?v:v.slice(k+1)}function s(v,k){typeof k=="string"&&(k=new Date(k));var I=k.getHours();I=I<<6|k.getMinutes(),I=I<<5|k.getSeconds()>>>1,v.write_shift(2,I);var S=k.getFullYear()-1980;S=S<<4|k.getMonth()+1,S=S<<5|k.getDate(),v.write_shift(2,S)}function a(v){var k=v.read_shift(2)&65535,I=v.read_shift(2)&65535,S=new Date,O=I&31;I>>>=5;var F=I&15;I>>>=4,S.setMilliseconds(0),S.setFullYear(I+1980),S.setMonth(F-1),S.setDate(O);var H=k&31;k>>>=5;var X=k&63;return k>>>=6,S.setHours(k),S.setMinutes(X),S.setSeconds(H<<1),S}function o(v){ir(v,0);for(var k={},I=0;v.l<=v.length-4;){var S=v.read_shift(2),O=v.read_shift(2),F=v.l+O,H={};switch(S){case 21589:I=v.read_shift(1),I&1&&(H.mtime=v.read_shift(4)),O>5&&(I&2&&(H.atime=v.read_shift(4)),I&4&&(H.ctime=v.read_shift(4))),H.mtime&&(H.mt=new Date(H.mtime*1e3));break}v.l=F,k[S]=H}return k}var l;function u(){return l||(l={})}function h(v,k){if(v[0]==80&&v[1]==75)return hs(v,k);if((v[0]|32)==109&&(v[1]|32)==105)return Ba(v,k);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var I=3,S=512,O=0,F=0,H=0,X=0,j=0,z=[],q=v.slice(0,512);ir(q,0);var re=d(q);switch(I=re[0],I){case 3:S=512;break;case 4:S=4096;break;case 0:if(re[1]==0)return hs(v,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}S!==512&&(q=v.slice(0,S),ir(q,28));var oe=v.slice(0,S);p(q,I);var he=q.read_shift(4,"i");if(I===3&&he!==0)throw new Error("# Directory Sectors: Expected 0 saw "+he);q.l+=4,H=q.read_shift(4,"i"),q.l+=4,q.chk("00100000","Mini Stream Cutoff Size: "),X=q.read_shift(4,"i"),O=q.read_shift(4,"i"),j=q.read_shift(4,"i"),F=q.read_shift(4,"i");for(var ie=-1,ue=0;ue<109&&(ie=q.read_shift(4,"i"),!(ie<0));++ue)z[ue]=ie;var Te=g(v,S);y(j,F,Te,S,z);var ze=M(Te,H,z,S);ze[H].name="!Directory",O>0&&X!==C&&(ze[X].name="!MiniFAT"),ze[z[0]].name="!FAT",ze.fat_addrs=z,ze.ssz=S;var Ve={},Je=[],Br=[],Hn=[];N(H,ze,Te,Je,O,Ve,Br,X),T(Br,Hn,Je),Je.shift();var cn={FileIndex:Br,FullPaths:Hn};return k&&k.raw&&(cn.raw={header:oe,sectors:Te}),cn}function d(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(Se,"Header Signature: "),v.l+=16;var k=v.read_shift(2,"u");return[v.read_shift(2,"u"),k]}function p(v,k){var I=9;switch(v.l+=2,I=v.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function g(v,k){for(var I=Math.ceil(v.length/k)-1,S=[],O=1;O<I;++O)S[O-1]=v.slice(O*k,(O+1)*k);return S[I-1]=v.slice(I*k),S}function T(v,k,I){for(var S=0,O=0,F=0,H=0,X=0,j=I.length,z=[],q=[];S<j;++S)z[S]=q[S]=S,k[S]=I[S];for(;X<q.length;++X)S=q[X],O=v[S].L,F=v[S].R,H=v[S].C,z[S]===S&&(O!==-1&&z[O]!==O&&(z[S]=z[O]),F!==-1&&z[F]!==F&&(z[S]=z[F])),H!==-1&&(z[H]=S),O!==-1&&S!=z[S]&&(z[O]=z[S],q.lastIndexOf(O)<X&&q.push(O)),F!==-1&&S!=z[S]&&(z[F]=z[S],q.lastIndexOf(F)<X&&q.push(F));for(S=1;S<j;++S)z[S]===S&&(F!==-1&&z[F]!==F?z[S]=z[F]:O!==-1&&z[O]!==O&&(z[S]=z[O]));for(S=1;S<j;++S)if(v[S].type!==0){if(X=S,X!=z[X])do X=z[X],k[S]=k[X]+"/"+k[S];while(X!==0&&z[X]!==-1&&X!=z[X]);z[S]=-1}for(k[0]+="/",S=1;S<j;++S)v[S].type!==2&&(k[S]+="/")}function _(v,k,I){for(var S=v.start,O=v.size,F=[],H=S;I&&O>0&&H>=0;)F.push(k.slice(H*D,H*D+D)),O-=D,H=zn(I,H*4);return F.length===0?Y(0):Ct(F).slice(0,v.size)}function y(v,k,I,S,O){var F=C;if(v===C){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var H=I[v],X=(S>>>2)-1;if(!H)return;for(var j=0;j<X&&(F=zn(H,j*4))!==C;++j)O.push(F);y(zn(H,S-4),k-1,I,S,O)}}function L(v,k,I,S,O){var F=[],H=[];O||(O=[]);var X=S-1,j=0,z=0;for(j=k;j>=0;){O[j]=!0,F[F.length]=j,H.push(v[j]);var q=I[Math.floor(j*4/S)];if(z=j*4&X,S<4+z)throw new Error("FAT boundary crossed: "+j+" 4 "+S);if(!v[q])break;j=zn(v[q],z)}return{nodes:F,data:o0([H])}}function M(v,k,I,S){var O=v.length,F=[],H=[],X=[],j=[],z=S-1,q=0,re=0,oe=0,he=0;for(q=0;q<O;++q)if(X=[],oe=q+k,oe>=O&&(oe-=O),!H[oe]){j=[];var ie=[];for(re=oe;re>=0;){ie[re]=!0,H[re]=!0,X[X.length]=re,j.push(v[re]);var ue=I[Math.floor(re*4/S)];if(he=re*4&z,S<4+he)throw new Error("FAT boundary crossed: "+re+" 4 "+S);if(!v[ue]||(re=zn(v[ue],he),ie[re]))break}F[oe]={nodes:X,data:o0([j])}}return F}function N(v,k,I,S,O,F,H,X){for(var j=0,z=S.length?2:0,q=k[v].data,re=0,oe=0,he;re<q.length;re+=128){var ie=q.slice(re,re+128);ir(ie,64),oe=ie.read_shift(2),he=Lu(ie,0,oe-z),S.push(he);var ue={name:he,type:ie.read_shift(1),color:ie.read_shift(1),L:ie.read_shift(4,"i"),R:ie.read_shift(4,"i"),C:ie.read_shift(4,"i"),clsid:ie.read_shift(16),state:ie.read_shift(4,"i"),start:0,size:0},Te=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);Te!==0&&(ue.ct=G(ie,ie.l-8));var ze=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);ze!==0&&(ue.mt=G(ie,ie.l-8)),ue.start=ie.read_shift(4,"i"),ue.size=ie.read_shift(4,"i"),ue.size<0&&ue.start<0&&(ue.size=ue.type=0,ue.start=C,ue.name=""),ue.type===5?(j=ue.start,O>0&&j!==C&&(k[j].name="!StreamData")):ue.size>=4096?(ue.storage="fat",k[ue.start]===void 0&&(k[ue.start]=L(I,ue.start,k.fat_addrs,k.ssz)),k[ue.start].name=ue.name,ue.content=k[ue.start].data.slice(0,ue.size)):(ue.storage="minifat",ue.size<0?ue.size=0:j!==C&&ue.start!==C&&k[j]&&(ue.content=_(ue,k[j].data,(k[X]||{}).data))),ue.content&&ir(ue.content,0),F[he]=ue,H.push(ue)}}function G(v,k){return new Date((ar(v,k+4)/1e7*Math.pow(2,32)+ar(v,k)/1e7-11644473600)*1e3)}function J(v,k){return u(),h(l.readFileSync(v),k)}function ne(v,k){var I=k&&k.type;switch(I||Me&&Buffer.isBuffer(v)&&(I="buffer"),I||"base64"){case"file":return J(v,k);case"base64":return h(xr(tn(v)),k);case"binary":return h(xr(v),k)}return h(v,k)}function w(v,k){var I=k||{},S=I.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=S+"/",v.FileIndex[0]={name:S,type:5}),I.CLSID&&(v.FileIndex[0].clsid=I.CLSID),x(v)}function x(v){var k="Sh33tJ5";if(!$e.find(v,"/"+k)){var I=Y(4);I[0]=55,I[1]=I[3]=50,I[2]=54,v.FileIndex.push({name:k,type:2,content:I,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+k),E(v)}}function E(v,k){w(v);for(var I=!1,S=!1,O=v.FullPaths.length-1;O>=0;--O){var F=v.FileIndex[O];switch(F.type){case 0:S?I=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(F.R*F.L*F.C)&&(I=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!k)){var H=new Date(1987,1,19),X=0,j=Object.create?Object.create(null):{},z=[];for(O=0;O<v.FullPaths.length;++O)j[v.FullPaths[O]]=!0,v.FileIndex[O].type!==0&&z.push([v.FullPaths[O],v.FileIndex[O]]);for(O=0;O<z.length;++O){var q=n(z[O][0]);S=j[q],S||(z.push([q,{name:i(q).replace("/",""),type:1,clsid:ft,ct:H,mt:H,content:null}]),j[q]=!0)}for(z.sort(function(he,ie){return t(he[0],ie[0])}),v.FullPaths=[],v.FileIndex=[],O=0;O<z.length;++O)v.FullPaths[O]=z[O][0],v.FileIndex[O]=z[O][1];for(O=0;O<z.length;++O){var re=v.FileIndex[O],oe=v.FullPaths[O];if(re.name=i(oe).replace("/",""),re.L=re.R=re.C=-(re.color=1),re.size=re.content?re.content.length:0,re.start=0,re.clsid=re.clsid||ft,O===0)re.C=z.length>1?1:-1,re.size=0,re.type=5;else if(oe.slice(-1)=="/"){for(X=O+1;X<z.length&&n(v.FullPaths[X])!=oe;++X);for(re.C=X>=z.length?-1:X,X=O+1;X<z.length&&n(v.FullPaths[X])!=n(oe);++X);re.R=X>=z.length?-1:X,re.type=1}else n(v.FullPaths[O+1]||"")==n(oe)&&(re.R=O+1),re.type=2}}}function R(v,k){var I=k||{};if(I.fileType=="mad")return yt(v,I);switch(E(v),I.fileType){case"zip":return fs(v,I)}var S=function(he){for(var ie=0,ue=0,Te=0;Te<he.FileIndex.length;++Te){var ze=he.FileIndex[Te];if(ze.content){var Ve=ze.content.length;Ve>0&&(Ve<4096?ie+=Ve+63>>6:ue+=Ve+511>>9)}}for(var Je=he.FullPaths.length+3>>2,Br=ie+7>>3,Hn=ie+127>>7,cn=Br+ue+Je+Hn,Ir=cn+127>>7,vi=Ir<=109?0:Math.ceil((Ir-109)/127);cn+Ir+vi+127>>7>Ir;)vi=++Ir<=109?0:Math.ceil((Ir-109)/127);var tr=[1,vi,Ir,Hn,Je,ue,ie,0];return he.FileIndex[0].size=ie<<6,tr[7]=(he.FileIndex[0].start=tr[0]+tr[1]+tr[2]+tr[3]+tr[4]+tr[5])+(tr[6]+7>>3),tr}(v),O=Y(S[7]<<9),F=0,H=0;{for(F=0;F<8;++F)O.write_shift(1,Ee[F]);for(F=0;F<8;++F)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),F=0;F<3;++F)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,S[2]),O.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:C),O.write_shift(4,S[3]),O.write_shift(-4,S[1]?S[0]-1:C),O.write_shift(4,S[1]),F=0;F<109;++F)O.write_shift(-4,F<S[2]?S[1]+F:-1)}if(S[1])for(H=0;H<S[1];++H){for(;F<236+H*127;++F)O.write_shift(-4,F<S[2]?S[1]+F:-1);O.write_shift(-4,H===S[1]-1?C:H+1)}var X=function(he){for(H+=he;F<H-1;++F)O.write_shift(-4,F+1);he&&(++F,O.write_shift(-4,C))};for(H=F=0,H+=S[1];F<H;++F)O.write_shift(-4,Ge.DIFSECT);for(H+=S[2];F<H;++F)O.write_shift(-4,Ge.FATSECT);X(S[3]),X(S[4]);for(var j=0,z=0,q=v.FileIndex[0];j<v.FileIndex.length;++j)q=v.FileIndex[j],q.content&&(z=q.content.length,!(z<4096)&&(q.start=H,X(z+511>>9)));for(X(S[6]+7>>3);O.l&511;)O.write_shift(-4,Ge.ENDOFCHAIN);for(H=F=0,j=0;j<v.FileIndex.length;++j)q=v.FileIndex[j],q.content&&(z=q.content.length,!(!z||z>=4096)&&(q.start=H,X(z+63>>6)));for(;O.l&511;)O.write_shift(-4,Ge.ENDOFCHAIN);for(F=0;F<S[4]<<2;++F){var re=v.FullPaths[F];if(!re||re.length===0){for(j=0;j<17;++j)O.write_shift(4,0);for(j=0;j<3;++j)O.write_shift(4,-1);for(j=0;j<12;++j)O.write_shift(4,0);continue}q=v.FileIndex[F],F===0&&(q.start=q.size?q.start-1:C);var oe=F===0&&I.root||q.name;if(z=2*(oe.length+1),O.write_shift(64,oe,"utf16le"),O.write_shift(2,z),O.write_shift(1,q.type),O.write_shift(1,q.color),O.write_shift(-4,q.L),O.write_shift(-4,q.R),O.write_shift(-4,q.C),q.clsid)O.write_shift(16,q.clsid,"hex");else for(j=0;j<4;++j)O.write_shift(4,0);O.write_shift(4,q.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,q.start),O.write_shift(4,q.size),O.write_shift(4,0)}for(F=1;F<v.FileIndex.length;++F)if(q=v.FileIndex[F],q.size>=4096)if(O.l=q.start+1<<9,Me&&Buffer.isBuffer(q.content))q.content.copy(O,O.l,0,q.size),O.l+=q.size+511&-512;else{for(j=0;j<q.size;++j)O.write_shift(1,q.content[j]);for(;j&511;++j)O.write_shift(1,0)}for(F=1;F<v.FileIndex.length;++F)if(q=v.FileIndex[F],q.size>0&&q.size<4096)if(Me&&Buffer.isBuffer(q.content))q.content.copy(O,O.l,0,q.size),O.l+=q.size+63&-64;else{for(j=0;j<q.size;++j)O.write_shift(1,q.content[j]);for(;j&63;++j)O.write_shift(1,0)}if(Me)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function P(v,k){var I=v.FullPaths.map(function(j){return j.toUpperCase()}),S=I.map(function(j){var z=j.split("/");return z[z.length-(j.slice(-1)=="/"?2:1)]}),O=!1;k.charCodeAt(0)===47?(O=!0,k=I[0].slice(0,-1)+k):O=k.indexOf("/")!==-1;var F=k.toUpperCase(),H=O===!0?I.indexOf(F):S.indexOf(F);if(H!==-1)return v.FileIndex[H];var X=!F.match(io);for(F=F.replace(Ns,""),X&&(F=F.replace(io,"!")),H=0;H<I.length;++H)if((X?I[H].replace(io,"!"):I[H]).replace(Ns,"")==F||(X?S[H].replace(io,"!"):S[H]).replace(Ns,"")==F)return v.FileIndex[H];return null}var D=64,C=-2,Se="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],ft="00000000000000000000000000000000",Ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:C,FREESECT:-1,HEADER_SIGNATURE:Se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ft,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Tt(v,k,I){u();var S=R(v,I);l.writeFileSync(k,S)}function et(v){for(var k=new Array(v.length),I=0;I<v.length;++I)k[I]=String.fromCharCode(v[I]);return k.join("")}function Ht(v,k){var I=R(v,k);switch(k&&k.type||"buffer"){case"file":return u(),l.writeFileSync(k.filename,I),I;case"binary":return typeof I=="string"?I:et(I);case"base64":return Js(typeof I=="string"?I:et(I));case"buffer":if(Me)return Buffer.isBuffer(I)?I:sn(I);case"array":return typeof I=="string"?xr(I):I}return I}var jt;function b(v){try{var k=v.InflateRaw,I=new k;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)jt=v;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function W(v,k){if(!jt)return gi(v,k);var I=jt.InflateRaw,S=new I,O=S._processChunk(v.slice(v.l),S._finishFlushFlag);return v.l+=S.bytesRead,O}function B(v){return jt?jt.deflateRawSync(v):os(v)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _e(v){var k=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(k>>16|k>>8|k)&255}for(var me=typeof Uint8Array<"u",le=me?new Uint8Array(256):[],De=0;De<256;++De)le[De]=_e(De);function Re(v,k){var I=le[v&255];return k<=8?I>>>8-k:(I=I<<8|le[v>>8&255],k<=16?I>>>16-k:(I=I<<8|le[v>>16&255],I>>>24-k))}function dt(v,k){var I=k&7,S=k>>>3;return(v[S]|(I<=6?0:v[S+1]<<8))>>>I&3}function ke(v,k){var I=k&7,S=k>>>3;return(v[S]|(I<=5?0:v[S+1]<<8))>>>I&7}function er(v,k){var I=k&7,S=k>>>3;return(v[S]|(I<=4?0:v[S+1]<<8))>>>I&15}function Ke(v,k){var I=k&7,S=k>>>3;return(v[S]|(I<=3?0:v[S+1]<<8))>>>I&31}function de(v,k){var I=k&7,S=k>>>3;return(v[S]|(I<=1?0:v[S+1]<<8))>>>I&127}function qt(v,k,I){var S=k&7,O=k>>>3,F=(1<<I)-1,H=v[O]>>>S;return I<8-S||(H|=v[O+1]<<8-S,I<16-S)||(H|=v[O+2]<<16-S,I<24-S)||(H|=v[O+3]<<24-S),H&F}function ur(v,k,I){var S=k&7,O=k>>>3;return S<=5?v[O]|=(I&7)<<S:(v[O]|=I<<S&255,v[O+1]=(I&7)>>8-S),k+3}function gr(v,k,I){var S=k&7,O=k>>>3;return I=(I&1)<<S,v[O]|=I,k+1}function Lr(v,k,I){var S=k&7,O=k>>>3;return I<<=S,v[O]|=I&255,I>>>=8,v[O+1]=I,k+8}function Na(v,k,I){var S=k&7,O=k>>>3;return I<<=S,v[O]|=I&255,I>>>=8,v[O+1]=I&255,v[O+2]=I>>>8,k+16}function Mn(v,k){var I=v.length,S=2*I>k?2*I:k+5,O=0;if(I>=k)return v;if(Me){var F=zf(S);if(v.copy)v.copy(F);else for(;O<v.length;++O)F[O]=v[O];return F}else if(me){var H=new Uint8Array(S);if(H.set)H.set(v);else for(;O<I;++O)H[O]=v[O];return H}return v.length=S,v}function Kt(v){for(var k=new Array(v),I=0;I<v;++I)k[I]=0;return k}function Vn(v,k,I){var S=1,O=0,F=0,H=0,X=0,j=v.length,z=me?new Uint16Array(32):Kt(32);for(F=0;F<32;++F)z[F]=0;for(F=j;F<I;++F)v[F]=0;j=v.length;var q=me?new Uint16Array(j):Kt(j);for(F=0;F<j;++F)z[O=v[F]]++,S<O&&(S=O),q[F]=0;for(z[0]=0,F=1;F<=S;++F)z[F+16]=X=X+z[F-1]<<1;for(F=0;F<j;++F)X=v[F],X!=0&&(q[F]=z[X+16]++);var re=0;for(F=0;F<j;++F)if(re=v[F],re!=0)for(X=Re(q[F],S)>>S-re,H=(1<<S+4-re)-1;H>=0;--H)k[X|H<<re]=re&15|F<<4;return S}var at=me?new Uint16Array(512):Kt(512),pt=me?new Uint16Array(32):Kt(32);if(!me){for(var hr=0;hr<512;++hr)at[hr]=0;for(hr=0;hr<32;++hr)pt[hr]=0}(function(){for(var v=[],k=0;k<32;k++)v.push(5);Vn(v,pt,32);var I=[];for(k=0;k<=143;k++)I.push(8);for(;k<=255;k++)I.push(9);for(;k<=279;k++)I.push(7);for(;k<=287;k++)I.push(8);Vn(I,at,288)})();var ba=function(){for(var k=me?new Uint8Array(32768):[],I=0,S=0;I<pe.length-1;++I)for(;S<pe[I+1];++S)k[S]=I;for(;S<32768;++S)k[S]=29;var O=me?new Uint8Array(259):[];for(I=0,S=0;I<ee.length-1;++I)for(;S<ee[I+1];++S)O[S]=I;function F(X,j){for(var z=0;z<X.length;){var q=Math.min(65535,X.length-z),re=z+q==X.length;for(j.write_shift(1,+re),j.write_shift(2,q),j.write_shift(2,~q&65535);q-- >0;)j[j.l++]=X[z++]}return j.l}function H(X,j){for(var z=0,q=0,re=me?new Uint16Array(32768):[];q<X.length;){var oe=Math.min(65535,X.length-q);if(oe<10){for(z=ur(j,z,+(q+oe==X.length)),z&7&&(z+=8-(z&7)),j.l=z/8|0,j.write_shift(2,oe),j.write_shift(2,~oe&65535);oe-- >0;)j[j.l++]=X[q++];z=j.l*8;continue}z=ur(j,z,+(q+oe==X.length)+2);for(var he=0;oe-- >0;){var ie=X[q];he=(he<<5^ie)&32767;var ue=-1,Te=0;if((ue=re[he])&&(ue|=q&-32768,ue>q&&(ue-=32768),ue<q))for(;X[ue+Te]==X[q+Te]&&Te<250;)++Te;if(Te>2){ie=O[Te],ie<=22?z=Lr(j,z,le[ie+1]>>1)-1:(Lr(j,z,3),z+=5,Lr(j,z,le[ie-23]>>5),z+=3);var ze=ie<8?0:ie-4>>2;ze>0&&(Na(j,z,Te-ee[ie]),z+=ze),ie=k[q-ue],z=Lr(j,z,le[ie]>>3),z-=3;var Ve=ie<4?0:ie-2>>1;Ve>0&&(Na(j,z,q-ue-pe[ie]),z+=Ve);for(var Je=0;Je<Te;++Je)re[he]=q&32767,he=(he<<5^X[q])&32767,++q;oe-=Te-1}else ie<=143?ie=ie+48:z=gr(j,z,1),z=Lr(j,z,le[ie]),re[he]=q&32767,++q}z=Lr(j,z,0)-1}return j.l=(z+7)/8|0,j.l}return function(j,z){return j.length<8?F(j,z):H(j,z)}}();function os(v){var k=Y(50+Math.floor(v.length*1.1)),I=ba(v,k);return k.slice(0,I)}var La=me?new Uint16Array(32768):Kt(32768),an=me?new Uint16Array(32768):Kt(32768),cs=me?new Uint16Array(128):Kt(128),ls=1,mi=1;function Cc(v,k){var I=Ke(v,k)+257;k+=5;var S=Ke(v,k)+1;k+=5;var O=er(v,k)+4;k+=4;for(var F=0,H=me?new Uint8Array(19):Kt(19),X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],j=1,z=me?new Uint8Array(8):Kt(8),q=me?new Uint8Array(8):Kt(8),re=H.length,oe=0;oe<O;++oe)H[V[oe]]=F=ke(v,k),j<F&&(j=F),z[F]++,k+=3;var he=0;for(z[0]=0,oe=1;oe<=j;++oe)q[oe]=he=he+z[oe-1]<<1;for(oe=0;oe<re;++oe)(he=H[oe])!=0&&(X[oe]=q[he]++);var ie=0;for(oe=0;oe<re;++oe)if(ie=H[oe],ie!=0){he=le[X[oe]]>>8-ie;for(var ue=(1<<7-ie)-1;ue>=0;--ue)cs[he|ue<<ie]=ie&7|oe<<3}var Te=[];for(j=1;Te.length<I+S;)switch(he=cs[de(v,k)],k+=he&7,he>>>=3){case 16:for(F=3+dt(v,k),k+=2,he=Te[Te.length-1];F-- >0;)Te.push(he);break;case 17:for(F=3+ke(v,k),k+=3;F-- >0;)Te.push(0);break;case 18:for(F=11+de(v,k),k+=7;F-- >0;)Te.push(0);break;default:Te.push(he),j<he&&(j=he);break}var ze=Te.slice(0,I),Ve=Te.slice(I);for(oe=I;oe<286;++oe)ze[oe]=0;for(oe=S;oe<30;++oe)Ve[oe]=0;return ls=Vn(ze,La,286),mi=Vn(Ve,an,30),k}function Pc(v,k){if(v[0]==3&&!(v[1]&3))return[ri(k),2];for(var I=0,S=0,O=zf(k||1<<18),F=0,H=O.length>>>0,X=0,j=0;!(S&1);){if(S=ke(v,I),I+=3,S>>>1)S>>1==1?(X=9,j=5):(I=Cc(v,I),X=ls,j=mi);else{I&7&&(I+=8-(I&7));var z=v[I>>>3]|v[(I>>>3)+1]<<8;if(I+=32,z>0)for(!k&&H<F+z&&(O=Mn(O,F+z),H=O.length);z-- >0;)O[F++]=v[I>>>3],I+=8;continue}for(;;){!k&&H<F+32767&&(O=Mn(O,F+32767),H=O.length);var q=qt(v,I,X),re=S>>>1==1?at[q]:La[q];if(I+=re&15,re>>>=4,!(re>>>8&255))O[F++]=re;else{if(re==256)break;re-=257;var oe=re<8?0:re-4>>2;oe>5&&(oe=0);var he=F+ee[re];oe>0&&(he+=qt(v,I,oe),I+=oe),q=qt(v,I,j),re=S>>>1==1?pt[q]:an[q],I+=re&15,re>>>=4;var ie=re<4?0:re-2>>1,ue=pe[re];for(ie>0&&(ue+=qt(v,I,ie),I+=ie),!k&&H<he&&(O=Mn(O,he+100),H=O.length);F<he;)O[F]=O[F-ue],++F}}}return k?[O,I+7>>>3]:[O.slice(0,F),I+7>>>3]}function gi(v,k){var I=v.slice(v.l||0),S=Pc(I,k);return v.l+=S[1],S[0]}function us(v,k){if(v)typeof console<"u"&&console.error(k);else throw new Error(k)}function hs(v,k){var I=v;ir(I,0);var S=[],O=[],F={FileIndex:S,FullPaths:O};w(F,{root:k.root});for(var H=I.length-4;(I[H]!=80||I[H+1]!=75||I[H+2]!=5||I[H+3]!=6)&&H>=0;)--H;I.l=H+4,I.l+=4;var X=I.read_shift(2);I.l+=6;var j=I.read_shift(4);for(I.l=j,H=0;H<X;++H){I.l+=20;var z=I.read_shift(4),q=I.read_shift(4),re=I.read_shift(2),oe=I.read_shift(2),he=I.read_shift(2);I.l+=8;var ie=I.read_shift(4),ue=o(I.slice(I.l+re,I.l+re+oe));I.l+=re+oe+he;var Te=I.l;I.l=ie+4,Bn(I,z,q,F,ue),I.l=Te}return F}function Bn(v,k,I,S,O){v.l+=2;var F=v.read_shift(2),H=v.read_shift(2),X=a(v);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var j=v.read_shift(4),z=v.read_shift(4),q=v.read_shift(4),re=v.read_shift(2),oe=v.read_shift(2),he="",ie=0;ie<re;++ie)he+=String.fromCharCode(v[v.l++]);if(oe){var ue=o(v.slice(v.l,v.l+oe));(ue[21589]||{}).mt&&(X=ue[21589].mt),((O||{})[21589]||{}).mt&&(X=O[21589].mt)}v.l+=oe;var Te=v.slice(v.l,v.l+z);switch(H){case 8:Te=W(v,q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var ze=!1;F&8&&(j=v.read_shift(4),j==134695760&&(j=v.read_shift(4),ze=!0),z=v.read_shift(4),q=v.read_shift(4)),z!=k&&us(ze,"Bad compressed size: "+k+" != "+z),q!=I&&us(ze,"Bad uncompressed size: "+I+" != "+q),Vr(S,he,Te,{unsafe:!0,mt:X})}function fs(v,k){var I=k||{},S=[],O=[],F=Y(1),H=I.compression?8:0,X=0,j=0,z=0,q=0,re=0,oe=v.FullPaths[0],he=oe,ie=v.FileIndex[0],ue=[],Te=0;for(j=1;j<v.FullPaths.length;++j)if(he=v.FullPaths[j].slice(oe.length),ie=v.FileIndex[j],!(!ie.size||!ie.content||he=="Sh33tJ5")){var ze=q,Ve=Y(he.length);for(z=0;z<he.length;++z)Ve.write_shift(1,he.charCodeAt(z)&127);Ve=Ve.slice(0,Ve.l),ue[re]=Qw.buf(ie.content,0);var Je=ie.content;H==8&&(Je=B(Je)),F=Y(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,X),F.write_shift(2,H),ie.mt?s(F,ie.mt):F.write_shift(4,0),F.write_shift(-4,ue[re]),F.write_shift(4,Je.length),F.write_shift(4,ie.content.length),F.write_shift(2,Ve.length),F.write_shift(2,0),q+=F.length,S.push(F),q+=Ve.length,S.push(Ve),q+=Je.length,S.push(Je),F=Y(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,X),F.write_shift(2,H),F.write_shift(4,0),F.write_shift(-4,ue[re]),F.write_shift(4,Je.length),F.write_shift(4,ie.content.length),F.write_shift(2,Ve.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,ze),Te+=F.l,O.push(F),Te+=Ve.length,O.push(Ve),++re}return F=Y(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,re),F.write_shift(2,re),F.write_shift(4,Te),F.write_shift(4,q),F.write_shift(2,0),Ct([Ct(S),Ct(O),F])}var on={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Mr(v,k){if(v.ctype)return v.ctype;var I=v.name||"",S=I.match(/\.([^\.]+)$/);return S&&on[S[1]]||k&&(S=(I=k).match(/[\.\\]([^\.\\])+$/),S&&on[S[1]])?on[S[1]]:"application/octet-stream"}function Ma(v){for(var k=Js(v),I=[],S=0;S<k.length;S+=76)I.push(k.slice(S,S+76));return I.join(`\r
`)+`\r
`}function _i(v){var k=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(z){var q=z.charCodeAt(0).toString(16).toUpperCase();return"="+(q.length==1?"0"+q:q)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],S=k.split(`\r
`),O=0;O<S.length;++O){var F=S[O];if(F.length==0){I.push("");continue}for(var H=0;H<F.length;){var X=76,j=F.slice(H,H+X);j.charAt(X-1)=="="?X--:j.charAt(X-2)=="="?X-=2:j.charAt(X-3)=="="&&(X-=3),j=F.slice(H,H+X),H+=X,H<F.length&&(j+="="),I.push(j)}}return I.join(`\r
`)}function Va(v){for(var k=[],I=0;I<v.length;++I){for(var S=v[I];I<=v.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+v[++I];k.push(S)}for(var O=0;O<k.length;++O)k[O]=k[O].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return xr(k.join(`\r
`))}function Un(v,k,I){for(var S="",O="",F="",H,X=0;X<10;++X){var j=k[X];if(!j||j.match(/^\s*$/))break;var z=j.match(/^(.*?):\s*([^\s].*)$/);if(z)switch(z[1].toLowerCase()){case"content-location":S=z[2].trim();break;case"content-type":F=z[2].trim();break;case"content-transfer-encoding":O=z[2].trim();break}}switch(++X,O.toLowerCase()){case"base64":H=xr(tn(k.slice(X).join("")));break;case"quoted-printable":H=Va(k.slice(X));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var q=Vr(v,S.slice(I.length),H,{unsafe:!0});F&&(q.ctype=F)}function Ba(v,k){if(et(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=k&&k.root||"",S=(Me&&Buffer.isBuffer(v)?v.toString("binary"):et(v)).split(`\r
`),O=0,F="";for(O=0;O<S.length;++O)if(F=S[O],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),I||(I=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),F.slice(0,I.length)!=I););var H=(S[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var X="--"+(H[1]||""),j=[],z=[],q={FileIndex:j,FullPaths:z};w(q);var re,oe=0;for(O=0;O<S.length;++O){var he=S[O];he!==X&&he!==X+"--"||(oe++&&Un(q,S.slice(re,O),I),re=O)}return q}function yt(v,k){var I=k||{},S=I.boundary||"SheetJS";S="------="+S;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],F=v.FullPaths[0],H=F,X=v.FileIndex[0],j=1;j<v.FullPaths.length;++j)if(H=v.FullPaths[j].slice(F.length),X=v.FileIndex[j],!(!X.size||!X.content||H=="Sh33tJ5")){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Te){return"_x"+Te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Te){return"_u"+Te.charCodeAt(0).toString(16)+"_"});for(var z=X.content,q=Me&&Buffer.isBuffer(z)?z.toString("binary"):et(z),re=0,oe=Math.min(1024,q.length),he=0,ie=0;ie<=oe;++ie)(he=q.charCodeAt(ie))>=32&&he<128&&++re;var ue=re>=oe*4/5;O.push(S),O.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+H),O.push("Content-Transfer-Encoding: "+(ue?"quoted-printable":"base64")),O.push("Content-Type: "+Mr(X,H)),O.push(""),O.push(ue?_i(q):Ma(q))}return O.push(S+`--\r
`),O.join(`\r
`)}function Ua(v){var k={};return w(k,v),k}function Vr(v,k,I,S){var O=S&&S.unsafe;O||w(v);var F=!O&&$e.find(v,k);if(!F){var H=v.FullPaths[0];k.slice(0,H.length)==H?H=k:(H.slice(-1)!="/"&&(H+="/"),H=(H+k).replace("//","/")),F={name:i(k),type:2},v.FileIndex.push(F),v.FullPaths.push(H),O||$e.utils.cfb_gc(v)}return F.content=I,F.size=I?I.length:0,S&&(S.CLSID&&(F.clsid=S.CLSID),S.mt&&(F.mt=S.mt),S.ct&&(F.ct=S.ct)),F}function Wn(v,k){w(v);var I=$e.find(v,k);if(I){for(var S=0;S<v.FileIndex.length;++S)if(v.FileIndex[S]==I)return v.FileIndex.splice(S,1),v.FullPaths.splice(S,1),!0}return!1}function kc(v,k,I){w(v);var S=$e.find(v,k);if(S){for(var O=0;O<v.FileIndex.length;++O)if(v.FileIndex[O]==S)return v.FileIndex[O].name=i(I),v.FullPaths[O]=I,!0}return!1}function Oc(v){E(v,!0)}return e.find=P,e.read=ne,e.parse=h,e.write=Ht,e.writeFile=Tt,e.utils={cfb_new:Ua,cfb_add:Vr,cfb_del:Wn,cfb_mov:kc,cfb_gc:Oc,ReadShift:Ls,CheckField:Lm,prep_blob:ir,bconcat:Ct,use_zlib:b,_deflateRaw:os,_inflateRaw:gi,consts:Ge},e}();function Jw(r){return typeof r=="string"?xc(r):Array.isArray(r)?Aw(r):r}function Pa(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=xc(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?ea(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([Jw(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Ca(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+r)}function Dt(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function e0(r,e){for(var t=[],n=Dt(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function Fu(r){for(var e=[],t=Dt(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function wc(r){for(var e=[],t=Dt(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function Zw(r){for(var e=[],t=Dt(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var jo=new Date(1899,11,30,0,0,0);function Jt(r,e){var t=r.getTime(),n=jo.getTime()+(r.getTimezoneOffset()-jo.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Em=new Date,e2=jo.getTime()+(Em.getTimezoneOffset()-jo.getTimezoneOffset())*6e4,t0=Em.getTimezoneOffset();function xm(r){var e=new Date;return e.setTime(r*24*60*60*1e3+e2),e.getTimezoneOffset()!==t0&&e.setTime(e.getTime()+(e.getTimezoneOffset()-t0)*6e4),e}var r0=new Date("2017-02-19T19:06:09.000Z"),Tm=isNaN(r0.getFullYear())?new Date("2/19/17"):r0,t2=Tm.getFullYear()==2017;function zt(r,e){var t=new Date(r);if(t2)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(Tm.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ac(r,e){if(Me&&Buffer.isBuffer(r))return r.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function Zt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Zt(r[t]));return e}function rt(r,e){for(var t="";t.length<e;)t+=r;return t}function Kr(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var r2=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zs(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&r2.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}function Ie(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return Me?n=sn(t):n=Iw(t),$e.utils.cfb_add(r,e,n)}$e.utils.cfb_add(r,e,t)}else r.file(e,t)}function Du(){return $e.utils.cfb_new()}var ht=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,n2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Nu=Fu(n2),bu=/[&<>'"]/g,i2=/[\u0000-\u0008\u000b-\u001f]/g;function We(r){var e=r+"";return e.replace(bu,function(t){return Nu[t]}).replace(i2,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function n0(r){return We(r).replace(/ /g,"_x0020_")}var ym=/[\u0000-\u001f]/g;function s2(r){var e=r+"";return e.replace(bu,function(t){return Nu[t]}).replace(/\n/g,"<br/>").replace(ym,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function a2(r){var e=r+"";return e.replace(bu,function(t){return Nu[t]}).replace(ym,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function o2(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function c2(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Yc(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function i0(r){var e=ri(2*r.length),t,n,i=1,s=0,a=0,o;for(n=0;n<r.length;n+=i)i=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),i=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function s0(r){return sn(r,"binary").toString("utf8")}var ao="foo bar baz",bs=Me&&(s0(ao)==Yc(ao)&&s0||i0(ao)==Yc(ao)&&i0)||Yc,ea=Me?function(r){return sn(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},l2=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}}(),wm=/(^\s|\s$|\n)/;function Pt(r,e){return"<"+r+(e.match(wm)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function ta(r){return Dt(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function se(r,e,t){return"<"+r+(t!=null?ta(t):"")+(e!=null?(e.match(wm)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Fl(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function u2(r,e){switch(typeof r){case"string":var t=se("vt:lpwstr",We(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return se((r|0)==r?"vt:i4":"vt:r8",We(String(r)));case"boolean":return se("vt:bool",r?"true":"false")}if(r instanceof Date)return se("vt:filetime",Fl(r));throw new Error("Unable to serialize "+r)}var vt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ns=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],sr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function h2(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function f2(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var a0=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},o0=Me?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:sn(e)})):a0(r)}:a0,c0=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(Cs(r,i)));return n.join("").replace(Ns,"")},Lu=Me?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Ns,""):c0(r,e,t)}:c0,l0=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},Am=Me?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):l0(r,e,t)}:l0,u0=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(Ci(r,i)));return n.join("")},ka=Me?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):u0(e,t,n)}:u0,Im=function(r,e){var t=ar(r,e);return t>0?ka(r,e+4,e+4+t-1):""},Sm=Im,Rm=function(r,e){var t=ar(r,e);return t>0?ka(r,e+4,e+4+t-1):""},Cm=Rm,Pm=function(r,e){var t=2*ar(r,e);return t>0?ka(r,e+4,e+4+t-1):""},km=Pm,Om=function(e,t){var n=ar(e,t);return n>0?Lu(e,t+4,t+4+n):""},Fm=Om,Dm=function(r,e){var t=ar(r,e);return t>0?ka(r,e+4,e+4+t):""},Nm=Dm,bm=function(r,e){return h2(r,e)},$o=bm,Mu=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Me&&(Sm=function(e,t){if(!Buffer.isBuffer(e))return Im(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Cm=function(e,t){if(!Buffer.isBuffer(e))return Rm(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},km=function(e,t){if(!Buffer.isBuffer(e))return Pm(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Fm=function(e,t){if(!Buffer.isBuffer(e))return Om(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Nm=function(e,t){if(!Buffer.isBuffer(e))return Dm(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},$o=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):bm(e,t)},Mu=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ci=function(r,e){return r[e]},Cs=function(r,e){return r[e+1]*256+r[e]},d2=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},ar=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},zn=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},p2=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Ls(r,e){var t="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Me&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)t+=String.fromCharCode(Cs(this,u)),u+=2;r*=2;break;case"utf8":t=ka(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Lu(this,this.l,this.l+r);break;case"wstr":return Ls.call(this,r,"dbcs");case"lpstr-ansi":t=Sm(this,this.l),r=4+ar(this,this.l);break;case"lpstr-cp":t=Cm(this,this.l),r=4+ar(this,this.l);break;case"lpwstr":t=km(this,this.l),r=4+2*ar(this,this.l);break;case"lpp4":r=4+ar(this,this.l),t=Fm(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ar(this,this.l),t=Nm(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=Ci(this,this.l+r++))!==0;)s.push(no(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=Cs(this,this.l+r))!==0;)s.push(no(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ci(this,u),this.l=u+1,o=Ls.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(no(Cs(this,u))),u+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ci(this,u),this.l=u+1,o=Ls.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(no(Ci(this,u))),u+=1}t=s.join("");break;default:switch(r){case 1:return n=Ci(this,this.l),this.l++,n;case 2:return n=(e==="i"?d2:Cs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?zn:p2)(this,this.l),this.l+=4,n):(i=ar(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=$o(this,this.l):i=$o([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=Am(this,this.l,r);break}}return this.l+=r,t}var m2=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},g2=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},_2=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function v2(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)_2(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,m2(this,e,this.l);break;case 8:if(n=8,t==="f"){f2(this,e,this.l);break}case 16:break;case-4:n=4,g2(this,e,this.l);break}return this.l+=n,this}function Lm(r,e){var t=Am(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function ir(r,e){r.l=e,r.read_shift=Ls,r.chk=Lm,r.write_shift=v2}function br(r,e){r.l+=e}function Y(r){var e=ri(r);return ir(e,0),e}function Qt(){var r=[],e=Me?256:2048,t=function(u){var h=Y(u);return ir(h,0),h},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=t(Math.max(u+1,e)))},a=function(){return i(),Ct(r)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:r}}function Z(r,e,t,n){var i=+e,s;if(!isNaN(i)){n||(n=h4[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=r.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Mu(t)&&r.push(t)}}function Ms(r,e,t){var n=Zt(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function h0(r,e,t){var n=Zt(r);return n.s=Ms(n.s,e.s,t),n.e=Ms(n.e,e.s,t),n}function Vs(r,e){if(r.cRel&&r.c<0)for(r=Zt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Zt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=je(r);return!r.cRel&&r.cRel!=null&&(t=T2(t)),!r.rRel&&r.rRel!=null&&(t=E2(t)),t}function Qc(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Bt(r.s.c)+":"+(r.e.cRel?"":"$")+Bt(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Ot(r.s.r)+":"+(r.e.rRel?"":"$")+Ot(r.e.r):Vs(r.s,e.biff)+":"+Vs(r.e,e.biff)}function Vu(r){return parseInt(x2(r),10)-1}function Ot(r){return""+(r+1)}function E2(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function x2(r){return r.replace(/\$(\d+)$/,"$1")}function Bu(r){for(var e=y2(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function Bt(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function T2(r){return r.replace(/^([A-Z])/,"$$$1")}function y2(r){return r.replace(/^\$([A-Z])/,"$1")}function w2(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Et(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function je(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function lr(r){var e=r.indexOf(":");return e==-1?{s:Et(r),e:Et(r)}:{s:Et(r.slice(0,e)),e:Et(r.slice(e+1))}}function ut(r,e){return typeof e>"u"||typeof e=="number"?ut(r.s,r.e):(typeof r!="string"&&(r=je(r)),typeof e!="string"&&(e=je(e)),r==e?r:r+":"+e)}function Qe(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function f0(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Pn(r.z,t?Jt(e):e)}catch{}try{return r.w=Pn((r.XF||{}).numFmtId||(t?14:0),t?Jt(e):e)}catch{return""+e}}function rn(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Oa[r.v]||r.v:e==null?f0(r,r.v):f0(r,e))}function ui(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function Mm(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Et(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=Qe(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(u.e.r=a=h.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[d].length;++p)if(!(typeof e[d][p]>"u")){var g={v:e[d][p]},T=a+d,_=o+p;if(u.s.r>T&&(u.s.r=T),u.s.c>_&&(u.s.c=_),u.e.r<T&&(u.e.r=T),u.e.c<_&&(u.e.c=_),e[d][p]&&typeof e[d][p]=="object"&&!Array.isArray(e[d][p])&&!(e[d][p]instanceof Date))g=e[d][p];else if(Array.isArray(g.v)&&(g.f=e[d][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||nt[14],n.cellDates?(g.t="d",g.w=Pn(g.z,Jt(g.v))):(g.t="n",g.v=Jt(g.v),g.w=Pn(g.z,g.v))):g.t="s";if(i)s[T]||(s[T]=[]),s[T][_]&&s[T][_].z&&(g.z=s[T][_].z),s[T][_]=g;else{var y=je({c:_,r:T});s[y]&&s[y].z&&(g.z=s[y].z),s[y]=g}}}return u.s.c<1e7&&(s["!ref"]=ut(u)),s}function is(r,e){return Mm(null,r,e)}function A2(r){return r.read_shift(4,"i")}function yr(r,e){return e||(e=Y(4)),e.write_shift(4,r),e}function Ut(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function xt(r,e){var t=!1;return e==null&&(t=!0,e=Y(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function I2(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function S2(r,e){return e||(e=Y(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Uu(r,e){var t=r.l,n=r.read_shift(1),i=Ut(r),s=[],a={t:i,h:i};if(n&1){for(var o=r.read_shift(4),l=0;l!=o;++l)s.push(I2(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function R2(r,e){var t=!1;return e==null&&(t=!0,e=Y(15+4*r.t.length)),e.write_shift(1,0),xt(r.t,e),t?e.slice(0,e.l):e}var C2=Uu;function P2(r,e){var t=!1;return e==null&&(t=!0,e=Y(23+4*r.t.length)),e.write_shift(1,1),xt(r.t,e),e.write_shift(4,1),S2({},e),t?e.slice(0,e.l):e}function mr(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function hi(r,e){return e==null&&(e=Y(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function fi(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function di(r,e){return e==null&&(e=Y(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var k2=Ut,Vm=xt;function Wu(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function Go(r,e){var t=!1;return e==null&&(t=!0,e=Y(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var O2=Ut,Dl=Wu,Hu=Go;function Bm(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?$o([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):zn(e,0)>>2;return t?i/100:i}function Um(r,e){e==null&&(e=Y(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function Wm(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function F2(r,e){return e||(e=Y(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var pi=Wm,ss=F2;function as(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ni(r,e){return(e||Y(8)).write_shift(8,r,"f")}function D2(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),l=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=H2[i];u&&(e.rgb=w0(u));break;case 2:e.rgb=w0([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function zo(r,e){if(e||(e=Y(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function N2(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function b2(r,e){e||(e=Y(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var Hm=2,nr=3,oo=11,qo=19,co=64,L2=65,M2=71,V2=4108,B2=4126,It=80,d0={1:{n:"CodePage",t:Hm},2:{n:"Category",t:It},3:{n:"PresentationFormat",t:It},4:{n:"ByteCount",t:nr},5:{n:"LineCount",t:nr},6:{n:"ParagraphCount",t:nr},7:{n:"SlideCount",t:nr},8:{n:"NoteCount",t:nr},9:{n:"HiddenCount",t:nr},10:{n:"MultimediaClipCount",t:nr},11:{n:"ScaleCrop",t:oo},12:{n:"HeadingPairs",t:V2},13:{n:"TitlesOfParts",t:B2},14:{n:"Manager",t:It},15:{n:"Company",t:It},16:{n:"LinksUpToDate",t:oo},17:{n:"CharacterCount",t:nr},19:{n:"SharedDoc",t:oo},22:{n:"HyperlinksChanged",t:oo},23:{n:"AppVersion",t:nr,p:"version"},24:{n:"DigSig",t:L2},26:{n:"ContentType",t:It},27:{n:"ContentStatus",t:It},28:{n:"Language",t:It},29:{n:"Version",t:It},255:{},2147483648:{n:"Locale",t:qo},2147483651:{n:"Behavior",t:qo},1919054434:{}},p0={1:{n:"CodePage",t:Hm},2:{n:"Title",t:It},3:{n:"Subject",t:It},4:{n:"Author",t:It},5:{n:"Keywords",t:It},6:{n:"Comments",t:It},7:{n:"Template",t:It},8:{n:"LastAuthor",t:It},9:{n:"RevNumber",t:It},10:{n:"EditTime",t:co},11:{n:"LastPrinted",t:co},12:{n:"CreatedDate",t:co},13:{n:"ModifiedDate",t:co},14:{n:"PageCount",t:nr},15:{n:"WordCount",t:nr},16:{n:"CharCount",t:nr},17:{n:"Thumbnail",t:M2},18:{n:"Application",t:It},19:{n:"DocSecurity",t:nr},255:{},2147483648:{n:"Locale",t:qo},2147483651:{n:"Behavior",t:qo},1919054434:{}};function U2(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var W2=U2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),H2=Zt(W2),Oa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},j2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},lo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function $m(r,e){var t=Zw(j2),n=[],i;n[n.length]=ht,n[n.length]=se("Types",null,{xmlns:vt.CT,"xmlns:xsd":vt.xsd,"xmlns:xsi":vt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return se("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){r[l]&&r[l].length>0&&(i=r[l][0],n[n.length]=se("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:lo[l][e.bookType]||lo[l].xlsx}))},a=function(l){(r[l]||[]).forEach(function(u){n[n.length]=se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:lo[l][e.bookType]||lo[l].xlsx})})},o=function(l){(r[l]||[]).forEach(function(u){n[n.length]=se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var be={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Gm(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Li(r){var e=[ht,se("Relationships",null,{xmlns:vt.RELS})];return Dt(r["!id"]).forEach(function(t){e[e.length]=se("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ue(r,e,t,n,i,s){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[be.HLINK,be.XPATH,be.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}function $2(r){var e=[ht];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function m0(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function G2(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function z2(r){var e=[ht];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(m0(r[t][0],r[t][1])),e.push(G2("",r[t][0]));return e.push(m0("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function zm(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Vo.version+"</meta:generator></office:meta></office:document-meta>"}var Xn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Jc(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=We(e),n[n.length]=t?se(r,e,t):Pt(r,e))}function qm(r,e){var t=e||{},n=[ht,se("cp:coreProperties",null,{"xmlns:cp":vt.CORE_PROPS,"xmlns:dc":vt.dc,"xmlns:dcterms":vt.dcterms,"xmlns:dcmitype":vt.dcmitype,"xmlns:xsi":vt.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&Jc("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Fl(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&Jc("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Fl(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Xn.length;++s){var a=Xn[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Jc(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Mi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Km=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Xm(r){var e=[],t=se;return r||(r={}),r.Application="SheetJS",e[e.length]=ht,e[e.length]=se("Properties",null,{xmlns:vt.EXT_PROPS,"xmlns:vt":vt.vt}),Mi.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=We(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+We(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Ym(r){var e=[ht,se("Properties",null,{xmlns:vt.CUST_PROPS,"xmlns:vt":vt.vt})];if(!r)return e.join("");var t=1;return Dt(r).forEach(function(i){++t,e[e.length]=se("property",u2(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:We(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var g0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function q2(r,e){var t=[];return Dt(g0).map(function(n){for(var i=0;i<Xn.length;++i)if(Xn[i][1]==n)return Xn[i];for(i=0;i<Mi.length;++i)if(Mi[i][1]==n)return Mi[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Pt(g0[n[1]]||n[1],i))}}),se("DocumentProperties",t.join(""),{xmlns:sr.o})}function K2(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Dt(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<Xn.length;++a)if(s==Xn[a][1])return;for(a=0;a<Mi.length;++a)if(s==Mi[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=r[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(se(n0(s),o,{"dt:dt":l}))}}),e&&Dt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(se(n0(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+sr.o+'">'+i.join("")+"</"+n+">"}function X2(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Y(8);return a.write_shift(4,n),a.write_shift(4,i),a}function _0(r,e){var t=Y(4),n=Y(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=Y(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=X2(e);break;case 31:case 80:for(n=Y(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return Ct([t,n])}var Qm=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Y2(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function v0(r,e,t){var n=Y(8),i=[],s=[],a=8,o=0,l=Y(8),u=Y(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Y(8),u.write_shift(4,0),i.unshift(u);var h=[Y(4)];for(h[0].write_shift(4,r.length),o=0;o<r.length;++o){var d=r[o][0];for(l=Y(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Ct(h),s.unshift(l),a+=8+l.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(Qm.indexOf(r[o][0])>-1||Km.indexOf(r[o][0])>-1)&&r[o][1]!=null){var p=r[o][1],g=0;if(e){g=+e[r[o][0]];var T=t[g];if(T.p=="version"&&typeof p=="string"){var _=p.split(".");p=(+_[0]<<16)+(+_[1]||0)}l=_0(T.t,p)}else{var y=Y2(p);y==-1&&(y=31,p=String(p)),l=_0(y,p)}s.push(l),u=Y(8),u.write_shift(4,e?g:2+o),i.push(u),a+=8+l.length}var L=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,L),L+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Ct([n].concat(i).concat(s))}function E0(r,e,t,n,i,s){var a=Y(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=v0(r,t,n);if(o.push(l),i){var u=v0(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Ct(o)}function Q2(r,e){e||(e=Y(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function J2(r,e){return r.read_shift(e)===1}function Gt(r,e){return e||(e=Y(2)),e.write_shift(2,+!!r),e}function Jm(r){return r.read_shift(2,"u")}function dr(r,e){return e||(e=Y(2)),e.write_shift(2,r),e}function Zm(r,e,t){return t||(t=Y(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function eg(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=r.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=n?r.read_shift(n,i):"";return a}function Z2(r){var e=r.t||"",t=Y(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=Y(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return Ct(i)}function eA(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function tA(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):eA(r,n,t)}function rA(r,e,t){if(t.biff>5)return tA(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function tg(r,e,t){return t||(t=Y(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function x0(r,e){e||(e=Y(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function nA(r){var e=Y(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)n=n.slice(1),x0(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&x0(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),t=0;t<n.length-3*l;++t)e.write_shift(1,n.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function ii(r,e,t,n){return n||(n=Y(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function iA(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),a=r.read_shift(n,"i");return[i,s,a]}function sA(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function rg(r,e){return e||(e=Y(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function ju(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Y(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function aA(r,e){var t=!e||e.biff==8,n=Y(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function oA(r,e){var t=!e||e.biff>=8?2:1,n=Y(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function cA(r,e){var t=Y(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=Z2(r[i]);var s=Ct([t].concat(n));return s.parts=[t.length].concat(n.map(function(a){return a.length})),s}function lA(){var r=Y(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function uA(r){var e=Y(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function hA(r,e){var t=r.name||"Arial",n=e&&e.biff==5,i=n?15+t.length:16+2*t.length,s=Y(i);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function fA(r,e,t,n){var i=Y(10);return ii(r,e,n,i),i.write_shift(4,t),i}function dA(r,e,t,n,i){var s=!i||i.biff==8,a=Y(8+ +s+(1+s)*t.length);return ii(r,e,n,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function pA(r,e,t,n){var i=t&&t.biff==5;n||(n=Y(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function mA(r,e){var t=e.biff==8||!e.biff?4:2,n=Y(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function T0(r,e,t,n){var i=t&&t.biff==5;n||(n=Y(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function gA(r){var e=Y(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function _A(r,e,t,n,i,s){var a=Y(8);return ii(r,e,n,a),Zm(t,s,a),a}function vA(r,e,t,n){var i=Y(14);return ii(r,e,n,i),ni(t,i),i}function EA(r,e,t){if(t.biff<8)return xA(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(iA(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function xA(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=eg(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function TA(r){var e=Y(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)rg(r[t],e);return e}function yA(r){var e=Y(24),t=Et(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Ct([e,nA(r[1])])}function wA(r){var e=r[1].Tooltip,t=Y(10+2*(e.length+1));t.write_shift(2,2048);var n=Et(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function AA(r){return r||(r=Y(4)),r.write_shift(2,1),r.write_shift(2,1),r}function IA(r,e,t){if(!t.cellStyles)return br(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(n),l=r.read_shift(2);n==2&&(r.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function SA(r,e){var t=Y(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function RA(r){for(var e=Y(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}function CA(r,e,t){var n=Y(15);return Da(n,r,e),n.write_shift(8,t,"f"),n}function PA(r,e,t){var n=Y(9);return Da(n,r,e),n.write_shift(2,t),n}var kA=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Fu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var u=[],h=ri(1);switch(l.type){case"base64":h=xr(tn(o));break;case"binary":h=xr(o);break;case"buffer":case"array":h=o;break}ir(h,0);var d=h.read_shift(1),p=!!(d&136),g=!1,T=!1;switch(d){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:T=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var _=0,y=521;d==2&&(_=h.read_shift(2)),h.l+=3,d!=2&&(_=h.read_shift(4)),_>1048576&&(_=1e6),d!=2&&(y=h.read_shift(2));var L=h.read_shift(2),M=l.codepage||1252;d!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(M=r[h[h.l]]),h.l+=1,h.l+=2),T&&(h.l+=36);for(var N=[],G={},J=Math.min(h.length,d==2?521:y-10-(g?264:0)),ne=T?32:11;h.l<J&&h[h.l]!=13;)switch(G={},G.name=Bo.utils.decode(M,h.slice(h.l,h.l+ne)).replace(/[\u0000\r\n].*$/g,""),h.l+=ne,G.type=String.fromCharCode(h.read_shift(1)),d!=2&&!T&&(G.offset=h.read_shift(4)),G.len=h.read_shift(1),d==2&&(G.offset=h.read_shift(2)),G.dec=h.read_shift(1),G.name.length&&N.push(G),d!=2&&(h.l+=T?13:14),G.type){case"B":(!g||G.len!=8)&&l.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(h[h.l]!==13&&(h.l=y-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=y;var w=0,x=0;for(u[0]=[],x=0;x!=N.length;++x)u[0][x]=N[x].name;for(;_-- >0;){if(h[h.l]===42){h.l+=L;continue}for(++h.l,u[++w]=[],x=0,x=0;x!=N.length;++x){var E=h.slice(h.l,h.l+N[x].len);h.l+=N[x].len,ir(E,0);var R=Bo.utils.decode(M,E);switch(N[x].type){case"C":R.trim().length&&(u[w][x]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[w][x]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[w][x]=R;break;case"F":u[w][x]=parseFloat(R.trim());break;case"+":case"I":u[w][x]=T?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[w][x]=!0;break;case"N":case"F":u[w][x]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[w][x]="##MEMO##"+(T?parseInt(R.trim(),10):E.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[w][x]=+R||0);break;case"@":u[w][x]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[w][x]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[w][x]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][x]=-E.read_shift(-8,"f");break;case"B":if(g&&N[x].len==8){u[w][x]=E.read_shift(8,"f");break}case"G":case"P":E.l+=N[x].len;break;case"0":if(N[x].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[x].type)}}}if(d!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=N,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=is(t(o,u),u);return h["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,h}function i(o,l){try{return ui(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Qs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=Qt(),d=Jo(o,{header:1,raw:!0,cellDates:!0}),p=d[0],g=d.slice(1),T=o["!cols"]||[],_=0,y=0,L=0,M=1;for(_=0;_<p.length;++_){if(((T[_]||{}).DBF||{}).name){p[_]=T[_].DBF.name,++L;continue}if(p[_]!=null){if(++L,typeof p[_]=="number"&&(p[_]=p[_].toString(10)),typeof p[_]!="string")throw new Error("DBF Invalid column name "+p[_]+" |"+typeof p[_]+"|");if(p.indexOf(p[_])!==_){for(y=0;y<1024;++y)if(p.indexOf(p[_]+"_"+y)==-1){p[_]+="_"+y;break}}}}var N=Qe(o["!ref"]),G=[],J=[],ne=[];for(_=0;_<=N.e.c-N.s.c;++_){var w="",x="",E=0,R=[];for(y=0;y<g.length;++y)g[y][_]!=null&&R.push(g[y][_]);if(R.length==0||p[_]==null){G[_]="?";continue}for(y=0;y<R.length;++y){switch(typeof R[y]){case"number":x="B";break;case"string":x="C";break;case"boolean":x="L";break;case"object":x=R[y]instanceof Date?"D":"C";break;default:x="C"}E=Math.max(E,String(R[y]).length),w=w&&w!=x?"C":x}E>250&&(E=250),x=((T[_]||{}).DBF||{}).type,x=="C"&&T[_].DBF.len>E&&(E=T[_].DBF.len),w=="B"&&x=="N"&&(w="N",ne[_]=T[_].DBF.dec,E=T[_].DBF.len),J[_]=w=="C"||x=="N"?E:s[w]||0,M+=J[_],G[_]=w}var P=h.next(32);for(P.write_shift(4,318902576),P.write_shift(4,g.length),P.write_shift(2,296+32*L),P.write_shift(2,M),_=0;_<4;++_)P.write_shift(4,0);for(P.write_shift(4,0|(+e[im]||3)<<8),_=0,y=0;_<p.length;++_)if(p[_]!=null){var D=h.next(32),C=(p[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,C,"sbcs"),D.write_shift(1,G[_]=="?"?"C":G[_],"sbcs"),D.write_shift(4,y),D.write_shift(1,J[_]||s[G[_]]||0),D.write_shift(1,ne[_]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),y+=J[_]||s[G[_]]||0}var Se=h.next(264);for(Se.write_shift(4,13),_=0;_<65;++_)Se.write_shift(4,0);for(_=0;_<g.length;++_){var Ee=h.next(M);for(Ee.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(G[y]){case"L":Ee.write_shift(1,g[_][y]==null?63:g[_][y]?84:70);break;case"B":Ee.write_shift(8,g[_][y]||0,"f");break;case"N":var ft="0";for(typeof g[_][y]=="number"&&(ft=g[_][y].toFixed(ne[y]||0)),L=0;L<J[y]-ft.length;++L)Ee.write_shift(1,32);Ee.write_shift(1,ft,"sbcs");break;case"D":g[_][y]?(Ee.write_shift(4,("0000"+g[_][y].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(g[_][y].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+g[_][y].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Ge=String(g[_][y]!=null?g[_][y]:"").slice(0,J[y]);for(Ee.write_shift(1,Ge,"sbcs"),L=0;L<J[y]-Ge.length;++L)Ee.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),OA=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Dt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(p,g){var T=r[g];return typeof T=="number"?Gf(T):T},n=function(p,g,T){var _=g.charCodeAt(0)-32<<4|T.charCodeAt(0)-48;return _==59?p:Gf(_)};r["|"]=254;function i(p,g){switch(g.type){case"base64":return s(tn(p),g);case"binary":return s(p,g);case"buffer":return s(Me&&Buffer.isBuffer(p)?p.toString("binary"):Ca(p),g);case"array":return s(Ac(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var T=p.split(/[\n\r]+/),_=-1,y=-1,L=0,M=0,N=[],G=[],J=null,ne={},w=[],x=[],E=[],R=0,P;for(+g.codepage>=0&&Qs(+g.codepage);L!==T.length;++L){R=0;var D=T[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),C=D.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),Se=C[0],Ee;if(D.length>0)switch(Se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":C[1].charAt(0)=="P"&&G.push(D.slice(3).replace(/;;/g,";"));break;case"C":var ft=!1,Ge=!1,Tt=!1,et=!1,Ht=-1,jt=-1;for(M=1;M<C.length;++M)switch(C[M].charAt(0)){case"A":break;case"X":y=parseInt(C[M].slice(1))-1,Ge=!0;break;case"Y":for(_=parseInt(C[M].slice(1))-1,Ge||(y=0),P=N.length;P<=_;++P)N[P]=[];break;case"K":Ee=C[M].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(Kr(Ee))?isNaN(Zs(Ee).getDate())||(Ee=zt(Ee)):(Ee=Kr(Ee),J!==null&&gm(J)&&(Ee=xm(Ee))),ft=!0;break;case"E":et=!0;var b=PI(C[M].slice(1),{r:_,c:y});N[_][y]=[N[_][y],b];break;case"S":Tt=!0,N[_][y]=[N[_][y],"S5S"];break;case"G":break;case"R":Ht=parseInt(C[M].slice(1))-1;break;case"C":jt=parseInt(C[M].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}if(ft&&(N[_][y]&&N[_][y].length==2?N[_][y][0]=Ee:N[_][y]=Ee,J=null),Tt){if(et)throw new Error("SYLK shared formula cannot have own formula");var W=Ht>-1&&N[Ht][jt];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");N[_][y][1]=kI(W[1],{r:_-Ht,c:y-jt})}break;case"F":var B=0;for(M=1;M<C.length;++M)switch(C[M].charAt(0)){case"X":y=parseInt(C[M].slice(1))-1,++B;break;case"Y":for(_=parseInt(C[M].slice(1))-1,P=N.length;P<=_;++P)N[P]=[];break;case"M":R=parseInt(C[M].slice(1))/20;break;case"F":break;case"G":break;case"P":J=G[parseInt(C[M].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=C[M].slice(1).split(" "),P=parseInt(E[0],10);P<=parseInt(E[1],10);++P)R=parseInt(E[2],10),x[P-1]=R===0?{hidden:!0}:{wch:R},$u(x[P-1]);break;case"C":y=parseInt(C[M].slice(1))-1,x[y]||(x[y]={});break;case"R":_=parseInt(C[M].slice(1))-1,w[_]||(w[_]={}),R>0?(w[_].hpt=R,w[_].hpx=og(R)):R===0&&(w[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}B<1&&(J=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+D)}}return w.length>0&&(ne["!rows"]=w),x.length>0&&(ne["!cols"]=x),g&&g.sheetRows&&(N=N.slice(0,g.sheetRows)),[N,ne]}function a(p,g){var T=i(p,g),_=T[0],y=T[1],L=is(_,g);return Dt(y).forEach(function(M){L[M]=y[M]}),L}function o(p,g){return ui(a(p,g),g)}function l(p,g,T,_){var y="C;Y"+(T+1)+";X"+(_+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+zu(p.f,{r:T,c:_}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,g){g.forEach(function(T,_){var y="F;W"+(_+1)+" "+(_+1)+" ";T.hidden?y+="0":(typeof T.width=="number"&&!T.wpx&&(T.wpx=Ko(T.width)),typeof T.wpx=="number"&&!T.wch&&(T.wch=Xo(T.wpx)),typeof T.wch=="number"&&(y+=Math.round(T.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function h(p,g){g.forEach(function(T,_){var y="F;";T.hidden?y+="M0;":T.hpt?y+="M"+20*T.hpt+";":T.hpx&&(y+="M"+20*Yo(T.hpx)+";"),y.length>2&&p.push(y+"R"+(_+1))})}function d(p,g){var T=["ID;PWXL;N;E"],_=[],y=Qe(p["!ref"]),L,M=Array.isArray(p),N=`\r
`;T.push("P;PGeneral"),T.push("F;P0;DG0G8;M255"),p["!cols"]&&u(T,p["!cols"]),p["!rows"]&&h(T,p["!rows"]),T.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var G=y.s.r;G<=y.e.r;++G)for(var J=y.s.c;J<=y.e.c;++J){var ne=je({r:G,c:J});L=M?(p[G]||[])[J]:p[ne],!(!L||L.v==null&&(!L.f||L.F))&&_.push(l(L,p,G,J))}return T.join(N)+N+_.join(N)+N+"E"+N}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),FA=function(){function r(s,a){switch(a.type){case"base64":return e(tn(s),a);case"binary":return e(s,a);case"buffer":return e(Me&&Buffer.isBuffer(s)?s.toString("binary"):Ca(s),a);case"array":return e(Ac(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,h=0,d=[];h!==o.length;++h){if(o[h].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var p=o[h].trim().split(","),g=p[0],T=p[1];++h;for(var _=o[h]||"";(_.match(/["]/g)||[]).length&1&&h<o.length-1;)_+=`
`+o[++h];switch(_=_.trim(),+g){case-1:if(_==="BOT"){d[++l]=[],u=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?d[l][u]=!0:_==="FALSE"?d[l][u]=!1:isNaN(Kr(T))?isNaN(Zs(T).getDate())?d[l][u]=T:d[l][u]=zt(T):d[l][u]=Kr(T),++u;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),d[l][u++]=_!==""?_:null;break}if(_==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function t(s,a){return is(r(s,a),a)}function n(s,a){return ui(t(s,a),a)}var i=function(){var s=function(l,u,h,d,p){l.push(u),l.push(h+","+d),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,u,h,d){l.push(u+","+h),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],h=Qe(l["!ref"]),d,p=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){a(u,-1,0,"BOT");for(var T=h.s.c;T<=h.e.c;++T){var _=je({r:g,c:T});if(d=p?(l[g]||[])[T]:l[_],!d){a(u,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?a(u,1,0,"="+d.f):a(u,1,0,""):a(u,0,y,"V");break;case"b":a(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Pn(d.z||nt[14],Jt(zt(d.v)))),a(u,0,d.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var L=`\r
`,M=u.join(L);return M}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),ng=function(){function r(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,p){for(var g=d.split(`
`),T=-1,_=-1,y=0,L=[];y!==g.length;++y){var M=g[y].trim().split(":");if(M[0]==="cell"){var N=Et(M[1]);if(L.length<=N.r)for(T=L.length;T<=N.r;++T)L[T]||(L[T]=[]);switch(T=N.r,_=N.c,M[2]){case"t":L[T][_]=r(M[3]);break;case"v":L[T][_]=+M[3];break;case"vtf":var G=M[M.length-1];case"vtc":switch(M[3]){case"nl":L[T][_]=!!+M[4];break;default:L[T][_]=+M[4];break}M[2]=="vtf"&&(L[T][_]=[L[T][_],G])}}}return p&&p.sheetRows&&(L=L.slice(0,p.sheetRows)),L}function n(d,p){return is(t(d,p),p)}function i(d,p){return ui(n(d,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],g=[],T,_="",y=lr(d["!ref"]),L=Array.isArray(d),M=y.s.r;M<=y.e.r;++M)for(var N=y.s.c;N<=y.e.c;++N)if(_=je({r:M,c:N}),T=L?(d[M]||[])[N]:d[_],!(!T||T.v==null||T.t==="z")){switch(g=["cell",_,"t"],T.t){case"s":case"str":g.push(e(T.v));break;case"n":T.f?(g[2]="vtf",g[3]="n",g[4]=T.v,g[5]=e(T.f)):(g[2]="v",g[3]=T.v);break;case"b":g[2]="vt"+(T.f?"f":"c"),g[3]="nl",g[4]=T.v?"1":"0",g[5]=e(T.f||(T.v?"TRUE":"FALSE"));break;case"d":var G=Jt(zt(T.v));g[2]="vtc",g[3]="nd",g[4]=""+G,g[5]=T.w||Pn(T.z||nt[14],G);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function h(d){return[s,a,o,a,u(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),DA=function(){function r(h,d,p,g,T){T.raw?d[p][g]=h:h===""||(h==="TRUE"?d[p][g]=!0:h==="FALSE"?d[p][g]=!1:isNaN(Kr(h))?isNaN(Zs(h).getDate())?d[p][g]=h:d[p][g]=zt(h):d[p][g]=Kr(h))}function e(h,d){var p=d||{},g=[];if(!h||h.length===0)return g;for(var T=h.split(/[\r\n]/),_=T.length-1;_>=0&&T[_].length===0;)--_;for(var y=10,L=0,M=0;M<=_;++M)L=T[M].indexOf(" "),L==-1?L=T[M].length:L++,y=Math.max(y,L);for(M=0;M<=_;++M){g[M]=[];var N=0;for(r(T[M].slice(0,y).trim(),g,M,N,p),N=1;N<=(T[M].length-y)/10+1;++N)r(T[M].slice(y+(N-1)*10,y+N*10).trim(),g,M,N,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var d={},p=!1,g=0,T=0;g<h.length;++g)(T=h.charCodeAt(g))==34?p=!p:!p&&T in t&&(d[T]=(d[T]||0)+1);T=[];for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&T.push([d[g],g]);if(!T.length){d=n;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&T.push([d[g],g])}return T.sort(function(_,y){return _[0]-y[0]||n[_[1]]-n[y[1]]}),t[T.pop()[1]]||44}function s(h,d){var p=d||{},g="",T=p.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=i(h.slice(0,1024)):p&&p.FS?g=p.FS:g=i(h.slice(0,1024));var y=0,L=0,M=0,N=0,G=0,J=g.charCodeAt(0),ne=!1,w=0,x=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var E=p.dateNF!=null?Xw(p.dateNF):null;function R(){var P=h.slice(N,G),D={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)D.t="z";else if(p.raw)D.t="s",D.v=P;else if(P.trim().length===0)D.t="s",D.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(D.t="s",D.v=P.slice(2,-1).replace(/""/g,'"')):OI(P)?(D.t="n",D.f=P.slice(1)):(D.t="s",D.v=P);else if(P=="TRUE")D.t="b",D.v=!0;else if(P=="FALSE")D.t="b",D.v=!1;else if(!isNaN(M=Kr(P)))D.t="n",p.cellText!==!1&&(D.w=P),D.v=M;else if(!isNaN(Zs(P).getDate())||E&&P.match(E)){D.z=p.dateNF||nt[14];var C=0;E&&P.match(E)&&(P=Yw(P,p.dateNF,P.match(E)||[]),C=1),p.cellDates?(D.t="d",D.v=zt(P,C)):(D.t="n",D.v=Jt(zt(P,C))),p.cellText!==!1&&(D.w=Pn(D.z,D.v instanceof Date?Jt(D.v):D.v)),p.cellNF||delete D.z}else D.t="s",D.v=P;if(D.t=="z"||(p.dense?(T[y]||(T[y]=[]),T[y][L]=D):T[je({c:L,r:y})]=D),N=G+1,x=h.charCodeAt(N),_.e.c<L&&(_.e.c=L),_.e.r<y&&(_.e.r=y),w==J)++L;else if(L=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;G<h.length;++G)switch(w=h.charCodeAt(G)){case 34:x===34&&(ne=!ne);break;case J:case 10:case 13:if(!ne&&R())break e;break}return G-N>0&&R(),T["!ref"]=ut(_),T}function a(h,d){return!(d&&d.PRN)||d.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,d):is(e(h,d),d)}function o(h,d){var p="",g=d.type=="string"?[0,0,0,0]:G4(h,d);switch(d.type){case"base64":p=tn(h);break;case"binary":p=h;break;case"buffer":d.codepage==65001?p=h.toString("utf8"):d.codepage&&typeof Bo<"u"||(p=Me&&Buffer.isBuffer(h)?h.toString("binary"):Ca(h));break;case"array":p=Ac(h);break;case"string":p=h;break;default:throw new Error("Unrecognized type "+d.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=bs(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=bs(p):d.type=="binary"&&typeof Bo<"u",p.slice(0,19)=="socialcalc:version:"?ng.to_sheet(d.type=="string"?p:bs(p),d):a(p,d)}function l(h,d){return ui(o(h,d),d)}function u(h){for(var d=[],p=Qe(h["!ref"]),g,T=Array.isArray(h),_=p.s.r;_<=p.e.r;++_){for(var y=[],L=p.s.c;L<=p.e.c;++L){var M=je({r:_,c:L});if(g=T?(h[_]||[])[L]:h[M],!g||g.v==null){y.push("          ");continue}for(var N=(g.w||(rn(g),g.w)||"").slice(0,10);N.length<10;)N+=" ";y.push(N+(L===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),y0=function(){function r(b,W,B){if(b){ir(b,b.l||0);for(var V=B.Enum||Ht;b.l<b.length;){var ee=b.read_shift(2),pe=V[ee]||V[65535],_e=b.read_shift(2),me=b.l+_e,le=pe.f&&pe.f(b,_e,B);if(b.l=me,W(le,pe,ee))return}}}function e(b,W){switch(W.type){case"base64":return t(xr(tn(b)),W);case"binary":return t(xr(b),W);case"buffer":case"array":return t(b,W)}throw"Unsupported type "+W.type}function t(b,W){if(!b)return b;var B=W||{},V=B.dense?[]:{},ee="Sheet1",pe="",_e=0,me={},le=[],De=[],Re={s:{r:0,c:0},e:{r:0,c:0}},dt=B.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)B.Enum=Ht,r(b,function(de,qt,ur){switch(ur){case 0:B.vers=de,de>=4096&&(B.qpro=!0);break;case 6:Re=de;break;case 204:de&&(pe=de);break;case 222:pe=de;break;case 15:case 51:B.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:ur==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=B.dateNF||nt[14],B.cellDates&&(de[1].t="d",de[1].v=xm(de[1].v))),B.qpro&&de[3]>_e&&(V["!ref"]=ut(Re),me[ee]=V,le.push(ee),V=B.dense?[]:{},Re={s:{r:0,c:0},e:{r:0,c:0}},_e=de[3],ee=pe||"Sheet"+(_e+1),pe="");var gr=B.dense?(V[de[0].r]||[])[de[0].c]:V[je(de[0])];if(gr){gr.t=de[1].t,gr.v=de[1].v,de[1].z!=null&&(gr.z=de[1].z),de[1].f!=null&&(gr.f=de[1].f);break}B.dense?(V[de[0].r]||(V[de[0].r]=[]),V[de[0].r][de[0].c]=de[1]):V[je(de[0])]=de[1];break}},B);else if(b[2]==26||b[2]==14)B.Enum=jt,b[2]==14&&(B.qpro=!0,b.l=0),r(b,function(de,qt,ur){switch(ur){case 204:ee=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>_e&&(V["!ref"]=ut(Re),me[ee]=V,le.push(ee),V=B.dense?[]:{},Re={s:{r:0,c:0},e:{r:0,c:0}},_e=de[3],ee="Sheet"+(_e+1)),dt>0&&de[0].r>=dt)break;B.dense?(V[de[0].r]||(V[de[0].r]=[]),V[de[0].r][de[0].c]=de[1]):V[je(de[0])]=de[1],Re.e.c<de[0].c&&(Re.e.c=de[0].c),Re.e.r<de[0].r&&(Re.e.r=de[0].r);break;case 27:de[14e3]&&(De[de[14e3][0]]=de[14e3][1]);break;case 1537:De[de[0]]=de[1],de[0]==_e&&(ee=de[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(V["!ref"]=ut(Re),me[pe||ee]=V,le.push(pe||ee),!De.length)return{SheetNames:le,Sheets:me};for(var ke={},er=[],Ke=0;Ke<De.length;++Ke)me[le[Ke]]?(er.push(De[Ke]||le[Ke]),ke[De[Ke]]=me[De[Ke]]||me[le[Ke]]):(er.push(De[Ke]),ke[De[Ke]]={"!ref":"A1"});return{SheetNames:er,Sheets:ke}}function n(b,W){var B=W||{};if(+B.codepage>=0&&Qs(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Qt(),ee=Qe(b["!ref"]),pe=Array.isArray(b),_e=[];ae(V,0,s(1030)),ae(V,6,l(ee));for(var me=Math.min(ee.e.r,8191),le=ee.s.r;le<=me;++le)for(var De=Ot(le),Re=ee.s.c;Re<=ee.e.c;++Re){le===ee.s.r&&(_e[Re]=Bt(Re));var dt=_e[Re]+De,ke=pe?(b[le]||[])[Re]:b[dt];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?ae(V,13,g(le,Re,ke.v)):ae(V,14,_(le,Re,ke.v));else{var er=rn(ke);ae(V,15,d(le,Re,er.slice(0,239)))}}return ae(V,1),V.end()}function i(b,W){var B=W||{};if(+B.codepage>=0&&Qs(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Qt();ae(V,0,a(b));for(var ee=0,pe=0;ee<b.SheetNames.length;++ee)(b.Sheets[b.SheetNames[ee]]||{})["!ref"]&&ae(V,27,et(b.SheetNames[ee],pe++));var _e=0;for(ee=0;ee<b.SheetNames.length;++ee){var me=b.Sheets[b.SheetNames[ee]];if(!(!me||!me["!ref"])){for(var le=Qe(me["!ref"]),De=Array.isArray(me),Re=[],dt=Math.min(le.e.r,8191),ke=le.s.r;ke<=dt;++ke)for(var er=Ot(ke),Ke=le.s.c;Ke<=le.e.c;++Ke){ke===le.s.r&&(Re[Ke]=Bt(Ke));var de=Re[Ke]+er,qt=De?(me[ke]||[])[Ke]:me[de];if(!(!qt||qt.t=="z"))if(qt.t=="n")ae(V,23,R(ke,Ke,_e,qt.v));else{var ur=rn(qt);ae(V,22,w(ke,Ke,_e,ur.slice(0,239)))}}++_e}}return ae(V,1),V.end()}function s(b){var W=Y(2);return W.write_shift(2,b),W}function a(b){var W=Y(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var B=0,V=0,ee=0,pe=0;pe<b.SheetNames.length;++pe){var _e=b.SheetNames[pe],me=b.Sheets[_e];if(!(!me||!me["!ref"])){++ee;var le=lr(me["!ref"]);B<le.e.r&&(B=le.e.r),V<le.e.c&&(V=le.e.c)}}return B>8191&&(B=8191),W.write_shift(2,B),W.write_shift(1,ee),W.write_shift(1,V),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(b,W,B){var V={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&B.qpro?(V.s.c=b.read_shift(1),b.l++,V.s.r=b.read_shift(2),V.e.c=b.read_shift(1),b.l++,V.e.r=b.read_shift(2),V):(V.s.c=b.read_shift(2),V.s.r=b.read_shift(2),W==12&&B.qpro&&(b.l+=2),V.e.c=b.read_shift(2),V.e.r=b.read_shift(2),W==12&&B.qpro&&(b.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function l(b){var W=Y(8);return W.write_shift(2,b.s.c),W.write_shift(2,b.s.r),W.write_shift(2,b.e.c),W.write_shift(2,b.e.r),W}function u(b,W,B){var V=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(V[0].c=b.read_shift(1),V[3]=b.read_shift(1),V[0].r=b.read_shift(2),b.l+=2):(V[2]=b.read_shift(1),V[0].c=b.read_shift(2),V[0].r=b.read_shift(2)),V}function h(b,W,B){var V=b.l+W,ee=u(b,W,B);if(ee[1].t="s",B.vers==20768){b.l++;var pe=b.read_shift(1);return ee[1].v=b.read_shift(pe,"utf8"),ee}return B.qpro&&b.l++,ee[1].v=b.read_shift(V-b.l,"cstr"),ee}function d(b,W,B){var V=Y(7+B.length);V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,b),V.write_shift(1,39);for(var ee=0;ee<V.length;++ee){var pe=B.charCodeAt(ee);V.write_shift(1,pe>=128?95:pe)}return V.write_shift(1,0),V}function p(b,W,B){var V=u(b,W,B);return V[1].v=b.read_shift(2,"i"),V}function g(b,W,B){var V=Y(7);return V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,b),V.write_shift(2,B,"i"),V}function T(b,W,B){var V=u(b,W,B);return V[1].v=b.read_shift(8,"f"),V}function _(b,W,B){var V=Y(13);return V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,b),V.write_shift(8,B,"f"),V}function y(b,W,B){var V=b.l+W,ee=u(b,W,B);if(ee[1].v=b.read_shift(8,"f"),B.qpro)b.l=V;else{var pe=b.read_shift(2);G(b.slice(b.l,b.l+pe),ee),b.l+=pe}return ee}function L(b,W,B){var V=W&32768;return W&=-32769,W=(V?b:0)+(W>=8192?W-16384:W),(V?"":"$")+(B?Bt(W):Ot(W))}var M={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function G(b,W){ir(b,0);for(var B=[],V=0,ee="",pe="",_e="",me="";b.l<b.length;){var le=b[b.l++];switch(le){case 0:B.push(b.read_shift(8,"f"));break;case 1:pe=L(W[0].c,b.read_shift(2),!0),ee=L(W[0].r,b.read_shift(2),!1),B.push(pe+ee);break;case 2:{var De=L(W[0].c,b.read_shift(2),!0),Re=L(W[0].r,b.read_shift(2),!1);pe=L(W[0].c,b.read_shift(2),!0),ee=L(W[0].r,b.read_shift(2),!1),B.push(De+Re+":"+pe+ee)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(b.read_shift(2));break;case 6:{for(var dt="";le=b[b.l++];)dt+=String.fromCharCode(le);B.push('"'+dt.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:me=B.pop(),_e=B.pop(),B.push(["AND","OR"][le-20]+"("+_e+","+me+")");break;default:if(le<32&&N[le])me=B.pop(),_e=B.pop(),B.push(_e+N[le]+me);else if(M[le]){if(V=M[le][1],V==69&&(V=b[b.l++]),V>B.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+B.join("|")+"|");return}var ke=B.slice(-V);B.length-=V,B.push(M[le][0]+"("+ke.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}B.length==1?W[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function J(b){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=b.read_shift(2),W[3]=b[b.l++],W[0].c=b[b.l++],W}function ne(b,W){var B=J(b);return B[1].t="s",B[1].v=b.read_shift(W-4,"cstr"),B}function w(b,W,B,V){var ee=Y(6+V.length);ee.write_shift(2,b),ee.write_shift(1,B),ee.write_shift(1,W),ee.write_shift(1,39);for(var pe=0;pe<V.length;++pe){var _e=V.charCodeAt(pe);ee.write_shift(1,_e>=128?95:_e)}return ee.write_shift(1,0),ee}function x(b,W){var B=J(b);B[1].v=b.read_shift(2);var V=B[1].v>>1;if(B[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return B[1].v=V,B}function E(b,W){var B=J(b),V=b.read_shift(4),ee=b.read_shift(4),pe=b.read_shift(2);if(pe==65535)return V===0&&ee===3221225472?(B[1].t="e",B[1].v=15):V===0&&ee===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var _e=pe&32768;return pe=(pe&32767)-16446,B[1].v=(1-_e*2)*(ee*Math.pow(2,pe+32)+V*Math.pow(2,pe)),B}function R(b,W,B,V){var ee=Y(14);if(ee.write_shift(2,b),ee.write_shift(1,B),ee.write_shift(1,W),V==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var pe=0,_e=0,me=0,le=0;return V<0&&(pe=1,V=-V),_e=Math.log2(V)|0,V/=Math.pow(2,_e-31),le=V>>>0,le&2147483648||(V/=2,++_e,le=V>>>0),V-=le,le|=2147483648,le>>>=0,V*=Math.pow(2,32),me=V>>>0,ee.write_shift(4,me),ee.write_shift(4,le),_e+=16383+(pe?32768:0),ee.write_shift(2,_e),ee}function P(b,W){var B=E(b);return b.l+=W-14,B}function D(b,W){var B=J(b),V=b.read_shift(4);return B[1].v=V>>6,B}function C(b,W){var B=J(b),V=b.read_shift(8,"f");return B[1].v=V,B}function Se(b,W){var B=C(b);return b.l+=W-10,B}function Ee(b,W){return b[b.l+W-1]==0?b.read_shift(W,"cstr"):""}function ft(b,W){var B=b[b.l++];B>W-1&&(B=W-1);for(var V="";V.length<B;)V+=String.fromCharCode(b[b.l++]);return V}function Ge(b,W,B){if(!(!B.qpro||W<21)){var V=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var ee=b.read_shift(W-21,"cstr");return[V,ee]}}function Tt(b,W){for(var B={},V=b.l+W;b.l<V;){var ee=b.read_shift(2);if(ee==14e3){for(B[ee]=[0,""],B[ee][0]=b.read_shift(2);b[b.l];)B[ee][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return B}function et(b,W){var B=Y(5+b.length);B.write_shift(2,14e3),B.write_shift(2,W);for(var V=0;V<b.length;++V){var ee=b.charCodeAt(V);B[B.l++]=ee>127?95:ee}return B[B.l++]=0,B}var Ht={0:{n:"BOF",f:Jm},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:T},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:ft},65535:{n:""}},jt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ne},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:x},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Tt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:C},40:{n:"FORMULA28",f:Se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),NA=/^\s|\s$|[\t\n\r]/;function ig(r,e){if(!e.bookSST)return"";var t=[ht];t[t.length]=se("sst",null,{xmlns:ns[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(NA)&&(s+=' xml:space="preserve"'),s+=">"+We(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function bA(r){return[r.read_shift(4),r.read_shift(4)]}function LA(r,e){return e||(e=Y(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var MA=R2;function VA(r){var e=Qt();Z(e,159,LA(r));for(var t=0;t<r.length;++t)Z(e,19,MA(r[t]));return Z(e,160),e.end()}function BA(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function sg(r){var e=0,t,n=BA(r),i=n.length+1,s,a,o,l,u;for(t=ri(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)a=t[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var UA=function(){function r(i,s){switch(s.type){case"base64":return e(tn(i),s);case"binary":return e(i,s);case"buffer":return e(Me&&Buffer.isBuffer(i)?i.toString("binary"):Ca(i),s);case"array":return e(Ac(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,g=0,T,_=-1;T=p.exec(h);){switch(T[0]){case"\\cell":var y=h.slice(g,p.lastIndex-T[0].length);if(y[0]==" "&&(y=y.slice(1)),++_,y.length){var L={v:y,t:"s"};Array.isArray(o)?o[d][_]=L:o[je({r:d,c:_})]=L}break}g=p.lastIndex}_>u.e.c&&(u.e.c=_)}),o["!ref"]=ut(u),o}function t(i,s){return ui(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Qe(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var d=je({r:u,c:h});o=l?(i[u]||[])[h]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(rn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function w0(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}var WA=6,Xr=WA;function Ko(r){return Math.floor((r+Math.round(128/Xr)/256)*Xr)}function Xo(r){return Math.floor((r-5)/Xr*100+.5)/100}function Nl(r){return Math.round((r*Xr+5)/Xr*256)/256}function $u(r){r.width?(r.wpx=Ko(r.width),r.wch=Xo(r.wpx),r.MDW=Xr):r.wpx?(r.wch=Xo(r.wpx),r.width=Nl(r.wch),r.MDW=Xr):typeof r.wch=="number"&&(r.width=Nl(r.wch),r.wpx=Ko(r.width),r.MDW=Xr),r.customWidth&&delete r.customWidth}var HA=96,ag=HA;function Yo(r){return r*96/ag}function og(r){return r*ag/96}function jA(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=se("numFmt",null,{numFmtId:n,formatCode:We(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=se("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function $A(r){var e=[];return e[e.length]=se("cellXfs",null),r.forEach(function(t){e[e.length]=se("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=se("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function cg(r,e){var t=[ht,se("styleSheet",null,{xmlns:ns[0],"xmlns:vt":vt.vt})],n;return r.SSF&&(n=jA(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=$A(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function GA(r,e){var t=r.read_shift(2),n=Ut(r);return[t,n]}function zA(r,e,t){t||(t=Y(6+4*e.length)),t.write_shift(2,r),xt(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function qA(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=N2(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(n.underline=a);var o=r.read_shift(1);o>0&&(n.family=o);var l=r.read_shift(1);switch(l>0&&(n.charset=l),r.l++,n.color=D2(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ut(r),n}function KA(r,e){e||(e=Y(25+4*32)),e.write_shift(2,r.sz*20),b2(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),zo(r.color,e);var n=0;return n=2,e.write_shift(1,n),xt(r.name,e),e.length>e.l?e.slice(0,e.l):e}var XA=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zc,YA=br;function A0(r,e){e||(e=Y(4*3+8*7+16*1)),Zc||(Zc=Fu(XA));var t=Zc[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(zo({auto:1},e),zo({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function QA(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function lg(r,e,t){t||(t=Y(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Ts(r,e){return e||(e=Y(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var JA=br;function ZA(r,e){return e||(e=Y(51)),e.write_shift(1,0),Ts(null,e),Ts(null,e),Ts(null,e),Ts(null,e),Ts(null,e),e.length>e.l?e.slice(0,e.l):e}function eI(r,e){return e||(e=Y(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Go(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function tI(r,e,t){var n=Y(2052);return n.write_shift(4,r),Go(e,n),Go(t,n),n.length>n.l?n.slice(0,n.l):n}function rI(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(Z(r,615,yr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Z(r,44,zA(i,e[i]))}),Z(r,616))}}function nI(r){var e=1;Z(r,611,yr(e)),Z(r,43,KA({sz:12,color:{theme:1},name:"Calibri",family:2})),Z(r,612)}function iI(r){var e=2;Z(r,603,yr(e)),Z(r,45,A0({patternType:"none"})),Z(r,45,A0({patternType:"gray125"})),Z(r,604)}function sI(r){var e=1;Z(r,613,yr(e)),Z(r,46,ZA()),Z(r,614)}function aI(r){var e=1;Z(r,626,yr(e)),Z(r,47,lg({numFmtId:0},65535)),Z(r,627)}function oI(r,e){Z(r,617,yr(e.length)),e.forEach(function(t){Z(r,47,lg(t,0))}),Z(r,618)}function cI(r){var e=1;Z(r,619,yr(e)),Z(r,48,eI({xfId:0,name:"Normal"})),Z(r,620)}function lI(r){var e=0;Z(r,505,yr(e)),Z(r,506)}function uI(r){var e=0;Z(r,508,tI(e,"TableStyleMedium9","PivotStyleMedium4")),Z(r,509)}function hI(r,e){var t=Qt();return Z(t,278),rI(t,r.SSF),nI(t),iI(t),sI(t),aI(t),oI(t,e.cellXfs),cI(t),lI(t),uI(t),Z(t,279),t.end()}function ug(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[ht];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function fI(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Ut(r)}}function dI(r){var e=Y(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),xt(r.name,e),e.slice(0,e.l)}function pI(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function mI(r){var e=Y(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function gI(r,e){var t=Y(8+2*e.length);return t.write_shift(4,r),xt(e,t),t.slice(0,t.l)}function _I(r){return r.l+=4,r.read_shift(4)!=0}function vI(r,e){var t=Y(8);return t.write_shift(4,r),t.write_shift(4,1),t}function EI(){var r=Qt();return Z(r,332),Z(r,334,yr(1)),Z(r,335,dI({name:"XLDAPR",version:12e4,flags:3496657072})),Z(r,336),Z(r,339,gI(1,"XLDAPR")),Z(r,52),Z(r,35,yr(514)),Z(r,4096,yr(0)),Z(r,4097,dr(1)),Z(r,36),Z(r,53),Z(r,340),Z(r,337,vI(1)),Z(r,51,mI([[1,0]])),Z(r,338),Z(r,333),r.end()}function hg(){var r=[ht];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function xI(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=je(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var ki=1024;function fg(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[se("xml",null,{"xmlns:v":sr.v,"xmlns:o":sr.o,"xmlns:x":sr.x,"xmlns:mv":sr.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];ki<r*1e3;)ki+=1e3;return e.forEach(function(s){var a=Et(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=se("v:fill",l,o),h={on:"t",obscured:"t"};++ki,i=i.concat(["<v:shape"+ta({id:"_x0000_s"+ki,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,se("v:shadow",null,h),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Pt("x:AutoFill","False"),Pt("x:Row",String(a.r)),Pt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function dg(r){var e=[ht,se("comments",null,{xmlns:ns[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var s=We(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=t.indexOf(We(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Pt("t",We(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Pt("t",We(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function TI(r,e,t){var n=[ht,se("ThreadedComments",null,{xmlns:vt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(se("threadedComment",Pt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function yI(r){var e=[ht,se("personList",null,{xmlns:vt.TCMNT,"xmlns:x":ns[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(se("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function wI(r){var e={};e.iauthor=r.read_shift(4);var t=pi(r);return e.rfx=t.s,e.ref=je(t.s),r.l+=16,e}function AI(r,e){return e==null&&(e=Y(36)),e.write_shift(4,r[1].iauthor),ss(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var II=Ut;function SI(r){return xt(r.slice(0,54))}function RI(r){var e=Qt(),t=[];return Z(e,628),Z(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Z(e,632,SI(i.a)))})}),Z(e,631),Z(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Et(n[0]),e:Et(n[0])};Z(e,635,AI([s,i])),i.t&&i.t.length>0&&Z(e,637,P2(i)),Z(e,636),delete i.iauthor})}),Z(e,634),Z(e,629),e.end()}function CI(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&$e.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var pg=["xlsb","xlsm","xlam","biff8","xla"],PI=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?u+=e.r:--u,i+(o?"":"$")+Bt(h)+(l?"":"$")+Ot(u)}return function(i,s){return e=s,i.replace(r,t)}}(),Gu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zu=function(){return function(e,t){return e.replace(Gu,function(n,i,s,a,o,l){var u=Bu(a)-(s?0:t.c),h=Vu(l)-(o?0:t.r),d=h==0?"":o?h+1:"["+h+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+d+"C"+p})}}();function kI(r,e){return r.replace(Gu,function(t,n,i,s,a,o){return n+(i=="$"?i+s:Bt(Bu(s)+e.c))+(a=="$"?a+o:Ot(Vu(o)+e.r))})}function OI(r){return r.length!=1}function ot(r){r.l+=1}function kn(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function mg(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return gg(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),a=kn(r),o=kn(r);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function gg(r){var e=kn(r),t=kn(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function FI(r,e,t){if(t.biff<8)return gg(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=kn(r),a=kn(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function _g(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return DI(r);var n=r.read_shift(t&&t.biff==12?4:2),i=kn(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function DI(r){var e=kn(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function NI(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function bI(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return LI(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function LI(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function MI(r,e,t){var n=(r[r.l++]&96)>>5,i=mg(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function VI(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=mg(r,s,t);return[n,i,a]}function BI(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function UI(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function WI(r,e,t){var n=(r[r.l++]&96)>>5,i=FI(r,e-1,t);return[n,i]}function HI(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function I0(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function jI(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function $I(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function GI(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function zI(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function qI(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function vg(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function KI(r){return r.read_shift(2),vg(r)}function XI(r){return r.read_shift(2),vg(r)}function YI(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=_g(r,0,t);return[n,i]}function QI(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=bI(r,0,t);return[n,i]}function JI(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=_g(r,0,t);return[n,i,s]}function ZI(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[ZS[i],Tg[i],n]}function eS(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:tS(r);return[i,(s[0]===0?Tg:JS)[s[1]]]}function tS(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function rS(r,e,t){r.l+=t&&t.biff==2?3:4}function nS(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function iS(r){return r.l++,Oa[r.read_shift(1)]}function sS(r){return r.l++,r.read_shift(2)}function aS(r){return r.l++,r.read_shift(1)!==0}function oS(r){return r.l++,as(r)}function cS(r,e,t){return r.l++,eg(r,e-1,t)}function lS(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=J2(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Oa[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=as(r);break;case 2:t[1]=rA(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function uS(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?pi:sA)(r));return i}function hS(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=lS(r,t.biff);return a}function fS(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function dS(r,e,t){if(t.biff==5)return pS(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function pS(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function mS(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function gS(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function _S(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function vS(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var ES=br,xS=br,TS=br;function Fa(r,e,t){return r.l+=2,[NI(r)]}function qu(r){return r.l+=6,[]}var yS=Fa,wS=qu,AS=qu,IS=Fa;function Eg(r){return r.l+=2,[Jm(r),r.read_shift(2)&1]}var SS=Fa,RS=Eg,CS=qu,PS=Fa,kS=Fa,OS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function FS(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),a=OS[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:n,c:i,C:s}}function DS(r){return r.l+=2,[r.read_shift(4)]}function NS(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function bS(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function LS(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function MS(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function VS(r){return r.l+=4,[0,0]}var S0={1:{n:"PtgExp",f:nS},2:{n:"PtgTbl",f:TS},3:{n:"PtgAdd",f:ot},4:{n:"PtgSub",f:ot},5:{n:"PtgMul",f:ot},6:{n:"PtgDiv",f:ot},7:{n:"PtgPower",f:ot},8:{n:"PtgConcat",f:ot},9:{n:"PtgLt",f:ot},10:{n:"PtgLe",f:ot},11:{n:"PtgEq",f:ot},12:{n:"PtgGe",f:ot},13:{n:"PtgGt",f:ot},14:{n:"PtgNe",f:ot},15:{n:"PtgIsect",f:ot},16:{n:"PtgUnion",f:ot},17:{n:"PtgRange",f:ot},18:{n:"PtgUplus",f:ot},19:{n:"PtgUminus",f:ot},20:{n:"PtgPercent",f:ot},21:{n:"PtgParen",f:ot},22:{n:"PtgMissArg",f:ot},23:{n:"PtgStr",f:cS},26:{n:"PtgSheet",f:NS},27:{n:"PtgEndSheet",f:bS},28:{n:"PtgErr",f:iS},29:{n:"PtgBool",f:aS},30:{n:"PtgInt",f:sS},31:{n:"PtgNum",f:oS},32:{n:"PtgArray",f:HI},33:{n:"PtgFunc",f:ZI},34:{n:"PtgFuncVar",f:eS},35:{n:"PtgName",f:fS},36:{n:"PtgRef",f:YI},37:{n:"PtgArea",f:MI},38:{n:"PtgMemArea",f:mS},39:{n:"PtgMemErr",f:ES},40:{n:"PtgMemNoMem",f:xS},41:{n:"PtgMemFunc",f:gS},42:{n:"PtgRefErr",f:_S},43:{n:"PtgAreaErr",f:BI},44:{n:"PtgRefN",f:QI},45:{n:"PtgAreaN",f:WI},46:{n:"PtgMemAreaN",f:LS},47:{n:"PtgMemNoMemN",f:MS},57:{n:"PtgNameX",f:dS},58:{n:"PtgRef3d",f:JI},59:{n:"PtgArea3d",f:VI},60:{n:"PtgRefErr3d",f:vS},61:{n:"PtgAreaErr3d",f:UI},255:{}},BS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},US={1:{n:"PtgElfLel",f:Eg},2:{n:"PtgElfRw",f:PS},3:{n:"PtgElfCol",f:yS},6:{n:"PtgElfRwV",f:kS},7:{n:"PtgElfColV",f:IS},10:{n:"PtgElfRadical",f:SS},11:{n:"PtgElfRadicalS",f:CS},13:{n:"PtgElfColS",f:wS},15:{n:"PtgElfColSV",f:AS},16:{n:"PtgElfRadicalLel",f:RS},25:{n:"PtgList",f:FS},29:{n:"PtgSxName",f:DS},255:{}},WS={0:{n:"PtgAttrNoop",f:VS},1:{n:"PtgAttrSemi",f:qI},2:{n:"PtgAttrIf",f:GI},4:{n:"PtgAttrChoose",f:jI},8:{n:"PtgAttrGoto",f:$I},16:{n:"PtgAttrSum",f:rS},32:{n:"PtgAttrBaxcel",f:I0},33:{n:"PtgAttrBaxcel",f:I0},64:{n:"PtgAttrSpace",f:KI},65:{n:"PtgAttrSpaceSemi",f:XI},128:{n:"PtgAttrIfError",f:zI},255:{}};function HS(r,e,t,n){if(n.biff<8)return br(r,e);for(var i=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=hS(r,0,n),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=uS(r,t[a][1],n),s.push(t[a][2]);break;case"PtgExp":n&&n.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-r.l,e!==0&&s.push(br(r,e)),s}function jS(r,e,t){for(var n=r.l+e,i,s,a=[];n!=r.l;)e=n-r.l,s=r[r.l],i=S0[s]||S0[BS[s]],(s===24||s===25)&&(i=(s===24?US:WS)[r[r.l+1]]),!i||!i.f?br(r,e):a.push([i.n,i.f(r,e,t)]);return a}function $S(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var GS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zS(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function xg(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function R0(r,e,t){var n=xg(r,e,t);return n=="#REF"?n:zS(n,t)}function Xi(r,e,t,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,h,d=0,p=0,g,T="";if(!r[0]||!r[0][0])return"";for(var _=-1,y="",L=0,M=r[0].length;L<M;++L){var N=r[0][L];switch(N[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),_>=0){switch(r[0][_][1][0]){case 0:y=rt(" ",r[0][_][1][1]);break;case 1:y=rt("\r",r[0][_][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][_][1][0])}u=u+y,_=-1}o.push(u+GS[N[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Ms(N[1][1],a,i),o.push(Vs(h,s));break;case"PtgRefN":h=t?Ms(N[1][1],t,i):N[1][1],o.push(Vs(h,s));break;case"PtgRef3d":d=N[1][1],h=Ms(N[1][2],a,i),T=R0(n,d,i),o.push(T+"!"+Vs(h,s));break;case"PtgFunc":case"PtgFuncVar":var G=N[1][0],J=N[1][1];G||(G=0),G&=127;var ne=G==0?[]:o.slice(-G);o.length-=G,J==="User"&&(J=ne.shift()),o.push(J+"("+ne.join(",")+")");break;case"PtgBool":o.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(N[1]);break;case"PtgNum":o.push(String(N[1]));break;case"PtgStr":o.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(N[1]);break;case"PtgAreaN":g=h0(N[1][1],t?{s:t}:a,i),o.push(Qc(g,i));break;case"PtgArea":g=h0(N[1][1],a,i),o.push(Qc(g,i));break;case"PtgArea3d":d=N[1][1],g=N[1][2],T=R0(n,d,i),o.push(T+"!"+Qc(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=N[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],x=w?w.Name:"SH33TJSNAME"+String(p);x&&x.slice(0,6)=="_xlfn."&&!i.xlfn&&(x=x.slice(6)),o.push(x);break;case"PtgNameX":var E=N[1][1];p=N[1][2];var R;if(i.biff<=5)E<0&&(E=-E),n[E]&&(R=n[E][p]);else{var P="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][p]&&n[E][p].itab>0&&(P=n.SheetNames[n[E][p].itab-1]+"!"):P=n.SheetNames[p-1]+"!"),n[E]&&n[E][p])P+=n[E][p].Name;else if(n[0]&&n[0][p])P+=n[0][p].Name;else{var D=(xg(n,E,i)||"").split(";;");D[p-1]?P=D[p-1]:P+="SH33TJSERRX"}o.push(P);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var C="(",Se=")";if(_>=0){switch(y="",r[0][_][1][0]){case 2:C=rt(" ",r[0][_][1][1])+C;break;case 3:C=rt("\r",r[0][_][1][1])+C;break;case 4:Se=rt(" ",r[0][_][1][1])+Se;break;case 5:Se=rt("\r",r[0][_][1][1])+Se;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][_][1][0])}_=-1}o.push(C+o.pop()+Se);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:N[1][1],r:N[1][0]};var Ee={c:t.c,r:t.r};if(n.sharedf[je(h)]){var ft=n.sharedf[je(h)];o.push(Xi(ft,a,Ee,n,i))}else{var Ge=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(Xi(u[1],a,Ee,n,i)),Ge=!0;break}Ge||o.push(N[1])}break;case"PtgArray":o.push("{"+$S(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var Tt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&Tt.indexOf(r[0][L][0])==-1){N=r[0][_];var et=!0;switch(N[1][0]){case 4:et=!1;case 0:y=rt(" ",N[1][1]);break;case 5:et=!1;case 1:y=rt("\r",N[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}o.push((et?y:"")+o.pop()+(et?"":y)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function qS(r){if(r==null){var e=Y(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return ni(r);return ni(0)}function KS(r,e,t,n,i){var s=ii(e,t,i),a=qS(r.v),o=Y(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Y(r.bf.length),h=0;h<r.bf.length;++h)u[h]=r.bf[h];var d=Ct([s,a,o,u]);return d}function Ic(r,e,t){var n=r.read_shift(4),i=jS(r,n,t),s=r.read_shift(4),a=s>0?HS(r,s,i,t):null;return[i,a]}var XS=Ic,Sc=Ic,YS=Ic,QS=Ic,JS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Tg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ZS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function eR(r){var e="of:="+r.replace(Gu,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function tR(r){return r.replace(/\./,"!")}var Bs=typeof Map<"u";function Ku(r,e,t){var n=0,i=r.length;if(t){if(Bs?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Bs?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(Bs?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Rc(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(Xr=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=Xo(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=Nl(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function yg(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Ln(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,s=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){_m(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(r[i].numFmtId===n)return i;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function rR(r,e,t){if(r&&r["!ref"]){var n=Qe(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function nR(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+ut(r[t])+'"/>';return e+"</mergeCells>"}function iR(r,e,t,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=ea(We(l))}if(r&&r["!outline"]){var u={summaryBelow:1,summaryRight:1};r["!outline"].above&&(u.summaryBelow=0),r["!outline"].left&&(u.summaryRight=0),o=(o||"")+se("outlinePr",null,u)}!s&&!o||(i[i.length]=se("sheetPr",o,a))}var sR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],aR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function oR(r){var e={sheet:1};return sR.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),aR.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=sg(r.password).toString(16).toUpperCase()),se("sheetProtection",null,e)}function cR(r){return yg(r),se("pageMargins",null,r)}function lR(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=se("col",null,Rc(i,n)));return t[t.length]="</cols>",t.join("")}function uR(r,e,t,n){var i=typeof r.ref=="string"?r.ref:ut(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=lr(i);a.s.r==a.e.r&&(a.e.r=lr(e["!ref"]).e.r,i=ut(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),se("autoFilter",null,{ref:i})}function hR(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,i),{})}function fR(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=Oa[r.v];break;case"d":n&&n.cellDates?i=zt(r.v,-1).toISOString():(r=Zt(r),r.t="n",i=""+(r.v=Jt(zt(r.v)))),typeof r.z>"u"&&(r.z=nt[14]);break;default:i=r.v;break}var o=Pt("v",We(i)),l={r:e},u=Ln(n.cellXfs,r,n);switch(u!==0&&(l.s=u),r.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Pt("v",""+Ku(n.Strings,r.v,n.revStrings)),l.t="s";break}l.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var h=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=se("f",We(r.f),h)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(l.cm=1),se("c",o,l)}function dR(r,e,t,n){var i=[],s=[],a=Qe(r["!ref"]),o="",l,u="",h=[],d=0,p=0,g=r["!rows"],T=Array.isArray(r),_={r:u},y,L=-1;for(p=a.s.c;p<=a.e.c;++p)h[p]=Bt(p);for(d=a.s.r;d<=a.e.r;++d){for(s=[],u=Ot(d),p=a.s.c;p<=a.e.c;++p){l=h[p]+u;var M=T?(r[d]||[])[p]:r[l];M!==void 0&&(o=fR(M,l,r,e))!=null&&s.push(o)}(s.length>0||g&&g[d])&&(_={r:u},g&&g[d]&&(y=g[d],y.hidden&&(_.hidden=1),L=-1,y.hpx?L=Yo(y.hpx):y.hpt&&(L=y.hpt),L>-1&&(_.ht=L,_.customHeight=1),y.level&&(_.outlineLevel=y.level)),i[i.length]=se("row",s.join(""),_))}if(g)for(;d<g.length;++d)g&&g[d]&&(_={r:d+1},y=g[d],y.hidden&&(_.hidden=1),L=-1,y.hpx?L=Yo(y.hpx):y.hpt&&(L=y.hpt),L>-1&&(_.ht=L,_.customHeight=1),y.level&&(_.outlineLevel=y.level),i[i.length]=se("row","",_));return i.join("")}function wg(r,e,t,n){var i=[ht,se("worksheet",null,{xmlns:ns[0],"xmlns:r":vt.r})],s=t.SheetNames[r],a=0,o="",l=t.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",h=Qe(u);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=ut(h)}n||(n={}),l["!comments"]=[];var d=[];iR(l,t,r,e,i),i[i.length]=se("dimension",null,{ref:u}),i[i.length]=hR(l,e,r,t),e.sheetFormat&&(i[i.length]=se("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=lR(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=dR(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=oR(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=uR(l["!autofilter"],l,t,r)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=nR(l["!merges"]));var p=-1,g,T=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(T=Ue(n,-1,We(_[1].Target).replace(/#.*$/,""),be.HLINK),g["r:id"]="rId"+T),(p=_[1].Target.indexOf("#"))>-1&&(g.location=We(_[1].Target.slice(p+1))),_[1].Tooltip&&(g.tooltip=We(_[1].Tooltip)),i[i.length]=se("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=cR(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Pt("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(T=Ue(n,-1,"../drawings/drawing"+(r+1)+".xml",be.DRAW),i[i.length]=se("drawing",null,{"r:id":"rId"+T}),l["!drawing"]=d),l["!comments"].length>0&&(T=Ue(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",be.VML),i[i.length]=se("legacyDrawing",null,{"r:id":"rId"+T}),l["!legacy"]=T),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function pR(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function mR(r,e,t){var n=Y(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;i.hpx?s=Yo(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var d=-1,p=-1,g=h<<10;g<h+1<<10;++g){u.c=g;var T=Array.isArray(t)?(t[u.r]||[])[u.c]:t[je(u)];T&&(d<0&&(d=g),p=g)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,p))}var _=n.l;return n.l=l,n.write_shift(4,o),n.l=_,n.length>n.l?n.slice(0,n.l):n}function gR(r,e,t,n){var i=mR(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&Z(r,0,i)}var _R=pi,vR=ss;function ER(){}function xR(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=k2(r),t}function TR(r,e,t){t==null&&(t=Y(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return zo({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Vm(r,t),t.slice(0,t.l)}function yR(r){var e=mr(r);return[e]}function wR(r,e,t){return t==null&&(t=Y(8)),hi(e,t)}function AR(r){var e=fi(r);return[e]}function IR(r,e,t){return t==null&&(t=Y(4)),di(e,t)}function SR(r){var e=mr(r),t=r.read_shift(1);return[e,t,"b"]}function RR(r,e,t){return t==null&&(t=Y(9)),hi(e,t),t.write_shift(1,r.v?1:0),t}function CR(r){var e=fi(r),t=r.read_shift(1);return[e,t,"b"]}function PR(r,e,t){return t==null&&(t=Y(5)),di(e,t),t.write_shift(1,r.v?1:0),t}function kR(r){var e=mr(r),t=r.read_shift(1);return[e,t,"e"]}function OR(r,e,t){return t==null&&(t=Y(9)),hi(e,t),t.write_shift(1,r.v),t}function FR(r){var e=fi(r),t=r.read_shift(1);return[e,t,"e"]}function DR(r,e,t){return t==null&&(t=Y(8)),di(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function NR(r){var e=mr(r),t=r.read_shift(4);return[e,t,"s"]}function bR(r,e,t){return t==null&&(t=Y(12)),hi(e,t),t.write_shift(4,e.v),t}function LR(r){var e=fi(r),t=r.read_shift(4);return[e,t,"s"]}function MR(r,e,t){return t==null&&(t=Y(8)),di(e,t),t.write_shift(4,e.v),t}function VR(r){var e=mr(r),t=as(r);return[e,t,"n"]}function BR(r,e,t){return t==null&&(t=Y(16)),hi(e,t),ni(r.v,t),t}function UR(r){var e=fi(r),t=as(r);return[e,t,"n"]}function WR(r,e,t){return t==null&&(t=Y(12)),di(e,t),ni(r.v,t),t}function HR(r){var e=mr(r),t=Bm(r);return[e,t,"n"]}function jR(r,e,t){return t==null&&(t=Y(12)),hi(e,t),Um(r.v,t),t}function $R(r){var e=fi(r),t=Bm(r);return[e,t,"n"]}function GR(r,e,t){return t==null&&(t=Y(8)),di(e,t),Um(r.v,t),t}function zR(r){var e=mr(r),t=Uu(r);return[e,t,"is"]}function qR(r){var e=mr(r),t=Ut(r);return[e,t,"str"]}function KR(r,e,t){return t==null&&(t=Y(12+4*r.v.length)),hi(e,t),xt(r.v,t),t.length>t.l?t.slice(0,t.l):t}function XR(r){var e=fi(r),t=Ut(r);return[e,t,"str"]}function YR(r,e,t){return t==null&&(t=Y(8+4*r.v.length)),di(e,t),xt(r.v,t),t.length>t.l?t.slice(0,t.l):t}function QR(r,e,t){var n=r.l+e,i=mr(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"b"];if(t.cellFormula){r.l+=2;var o=Sc(r,n-r.l,t);a[3]=Xi(o,null,i,t.supbooks,t)}else r.l=n;return a}function JR(r,e,t){var n=r.l+e,i=mr(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"e"];if(t.cellFormula){r.l+=2;var o=Sc(r,n-r.l,t);a[3]=Xi(o,null,i,t.supbooks,t)}else r.l=n;return a}function ZR(r,e,t){var n=r.l+e,i=mr(r);i.r=t["!row"];var s=as(r),a=[i,s,"n"];if(t.cellFormula){r.l+=2;var o=Sc(r,n-r.l,t);a[3]=Xi(o,null,i,t.supbooks,t)}else r.l=n;return a}function eC(r,e,t){var n=r.l+e,i=mr(r);i.r=t["!row"];var s=Ut(r),a=[i,s,"str"];if(t.cellFormula){r.l+=2;var o=Sc(r,n-r.l,t);a[3]=Xi(o,null,i,t.supbooks,t)}else r.l=n;return a}var tC=pi,rC=ss;function nC(r,e){return e==null&&(e=Y(4)),e.write_shift(4,r),e}function iC(r,e){var t=r.l+e,n=pi(r),i=Wu(r),s=Ut(r),a=Ut(r),o=Ut(r);r.l=t;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function sC(r,e){var t=Y(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));ss({s:Et(r[0]),e:Et(r[0])},t),Hu("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return xt(i||"",t),xt(r[1].Tooltip||"",t),xt("",t),t.slice(0,t.l)}function aC(){}function oC(r,e,t){var n=r.l+e,i=Wm(r),s=r.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=XS(r,n-r.l,t);a[1]=o}else r.l=n;return a}function cC(r,e,t){var n=r.l+e,i=pi(r),s=[i];if(t.cellFormula){var a=QS(r,n-r.l,t);s[1]=a,r.l=n}else r.l=n;return s}function lC(r,e,t){t==null&&(t=Y(18));var n=Rc(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var Ag=["left","right","top","bottom","header","footer"];function uC(r){var e={};return Ag.forEach(function(t){e[t]=as(r)}),e}function hC(r,e){return e==null&&(e=Y(6*8)),yg(r),Ag.forEach(function(t){ni(r[t],e)}),e}function fC(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function dC(r,e,t){t==null&&(t=Y(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function pC(r){var e=Y(24);return e.write_shift(4,4),e.write_shift(4,1),ss(r,e),e}function mC(r,e){return e==null&&(e=Y(16*4+2)),e.write_shift(2,r.password?sg(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function gC(){}function _C(){}function vC(r,e,t,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Zt(e),e.z=e.z||nt[14],e.v=Jt(zt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:n};switch(l.s=Ln(i.cellXfs,e,i),e.l&&s["!links"].push([je(l),e.l]),e.c&&s["!comments"].push([je(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=Ku(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Z(r,18,MR(e,l)):Z(r,7,bR(e,l))):(l.t="str",a?Z(r,17,YR(e,l)):Z(r,6,KR(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Z(r,13,GR(e,l)):Z(r,2,jR(e,l)):a?Z(r,16,WR(e,l)):Z(r,5,BR(e,l)),!0;case"b":return l.t="b",a?Z(r,15,PR(e,l)):Z(r,4,RR(e,l)),!0;case"e":return l.t="e",a?Z(r,14,DR(e,l)):Z(r,3,OR(e,l)),!0}return a?Z(r,12,IR(e,l)):Z(r,1,wR(e,l)),!0}function EC(r,e,t,n){var i=Qe(e["!ref"]||"A1"),s,a="",o=[];Z(r,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=u;++h){a=Ot(h),gR(r,e,i,h);var d=!1;if(h<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){h===i.s.r&&(o[p]=Bt(p)),s=o[p]+a;var g=l?(e[h]||[])[p]:e[s];if(!g){d=!1;continue}d=vC(r,g,h,p,n,e,d)}}Z(r,146)}function xC(r,e){!e||!e["!merges"]||(Z(r,177,nC(e["!merges"].length)),e["!merges"].forEach(function(t){Z(r,176,rC(t))}),Z(r,178))}function TC(r,e){!e||!e["!cols"]||(Z(r,390),e["!cols"].forEach(function(t,n){t&&Z(r,60,lC(n,t))}),Z(r,391))}function yC(r,e){!e||!e["!ref"]||(Z(r,648),Z(r,649,pC(Qe(e["!ref"]))),Z(r,650))}function wC(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=Ue(t,-1,n[1].Target.replace(/#.*$/,""),be.HLINK);Z(r,494,sC(n,i))}}),delete e["!links"]}function AC(r,e,t,n){if(e["!comments"].length>0){var i=Ue(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",be.VML);Z(r,551,Hu("rId"+i)),e["!legacy"]=i}}function IC(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ut(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=lr(s);o.s.r==o.e.r&&(o.e.r=lr(e["!ref"]).e.r,s=ut(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+t.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Z(r,161,ss(Qe(s))),Z(r,162)}}function SC(r,e,t){Z(r,133),Z(r,137,dC(e,t)),Z(r,138),Z(r,134)}function RC(r,e){e["!protect"]&&Z(r,535,mC(e["!protect"]))}function CC(r,e,t,n){var i=Qt(),s=t.SheetNames[r],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var l=Qe(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Z(i,129),(t.vbaraw||a["!outline"])&&Z(i,147,TR(o,a["!outline"])),Z(i,148,vR(l)),SC(i,a,t.Workbook),TC(i,a),EC(i,a,r,e),RC(i,a),IC(i,a,t,r),xC(i,a),wC(i,a,n),a["!margins"]&&Z(i,476,hC(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&yC(i,a),AC(i,a,r,n),Z(i,130),i.end()}function PC(r,e){r.l+=10;var t=Ut(r);return{name:t}}var kC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function OC(r){return!r.Workbook||!r.Workbook.WBProps?"false":c2(r.Workbook.WBProps.date1904)?"true":"false"}var FC="][*?/\\".split("");function Ig(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return FC.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function DC(r,e,t){r.forEach(function(n,i){Ig(n);for(var s=0;s<i;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function NC(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];DC(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)rR(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}function Sg(r){var e=[ht];e[e.length]=se("workbook",null,{xmlns:ns[0],"xmlns:r":vt.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(kC.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=se("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:We(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=se("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=se("definedName",We(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function bC(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=Dl(r),t.name=Ut(r),t}function LC(r,e){return e||(e=Y(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Hu(r.strRelID,e),xt(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function MC(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?Ut(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function VC(r,e){e||(e=Y(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),Vm(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function BC(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=O2(r),a=YS(r,0,t),o=Wu(r);r.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function UC(r,e){Z(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Z(r,156,LC(i))}Z(r,144)}function WC(r,e){e||(e=Y(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return xt("SheetJS",e),xt(Vo.version,e),xt(Vo.version,e),xt("7262",e),e.length>e.l?e.slice(0,e.l):e}function HC(r,e){e||(e=Y(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function jC(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&s==-1&&(s=n);s>i||(Z(r,135),Z(r,158,HC(i)),Z(r,136))}}function $C(r,e){var t=Qt();return Z(t,131),Z(t,128,WC()),Z(t,153,VC(r.Workbook&&r.Workbook.WBProps||null)),jC(t,r),UC(t,r),Z(t,132),t.end()}function GC(r,e,t){return(e.slice(-4)===".bin"?$C:Sg)(r)}function zC(r,e,t,n,i){return(e.slice(-4)===".bin"?CC:wg)(r,t,n,i)}function qC(r,e,t){return(e.slice(-4)===".bin"?hI:cg)(r,t)}function KC(r,e,t){return(e.slice(-4)===".bin"?VA:ig)(r,t)}function XC(r,e,t){return(e.slice(-4)===".bin"?RI:dg)(r)}function YC(r){return(r.slice(-4)===".bin"?EI:hg)()}function QC(r,e){var t=[];return r.Props&&t.push(q2(r.Props,e)),r.Custprops&&t.push(K2(r.Props,r.Custprops)),t.join("")}function JC(){return""}function ZC(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(se("NumberFormat",null,{"ss:Format":We(nt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(se("Style",s.join(""),a))}),se("Styles",t.join(""))}function Rg(r){return se("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+zu(r.Ref,{r:0,c:0})})}function e4(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(Rg(i)))}return se("Names",t.join(""))}function t4(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(Rg(o)))}return s.join("")}function r4(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(se("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(se("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(se("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(se("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(Pt("ProtectContents","True")),r["!protect"].objects&&i.push(Pt("ProtectObjects","True")),r["!protect"].scenarios&&i.push(Pt("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(Pt("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(Pt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":se("WorksheetOptions",i.join(""),{xmlns:sr.x})}function n4(r){return r.map(function(e){var t=o2(e.t||""),n=se("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return se("Comment",n,{"ss:Author":e.a})}).join("")}function i4(r,e,t,n,i,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+We(zu(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var l=Et(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=We(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=We(r.l.Tooltip))),t["!merges"])for(var u=t["!merges"],h=0;h!=u.length;++h)u[h].s.c!=a.c||u[h].s.r!=a.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var d="",p="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(r.v);break;case"b":d="Boolean",p=r.v?"1":"0";break;case"e":d="Error",p=Oa[r.v];break;case"d":d="DateTime",p=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||nt[14]);break;case"s":d="String",p=a2(r.v||"");break}var g=Ln(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var T=r.v!=null?p:"",_=r.t=="z"?"":'<Data ss:Type="'+d+'">'+T+"</Data>";return(r.c||[]).length>0&&(_+=n4(r.c)),se("Cell",_,o)}function s4(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=og(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function a4(r,e,t,n){if(!r["!ref"])return"";var i=Qe(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(y,L){$u(y);var M=!!y.width,N=Rc(L,y),G={"ss:Index":L+1};M&&(G["ss:Width"]=Ko(N.width)),y.hidden&&(G["ss:Hidden"]="1"),o.push(se("Column",null,G))});for(var l=Array.isArray(r),u=i.s.r;u<=i.e.r;++u){for(var h=[s4(u,(r["!rows"]||[])[u])],d=i.s.c;d<=i.e.c;++d){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>d)&&!(s[a].s.r>u)&&!(s[a].e.c<d)&&!(s[a].e.r<u)){(s[a].s.c!=d||s[a].s.r!=u)&&(p=!0);break}if(!p){var g={r:u,c:d},T=je(g),_=l?(r[u]||[])[d]:r[T];h.push(i4(_,T,r,e,t,n,g))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function o4(r,e,t){var n=[],i=t.SheetNames[r],s=t.Sheets[i],a=s?t4(s,e,r,t):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?a4(s,e,r,t):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(r4(s,e,r,t)),n.join("")}function c4(r,e){e||(e={}),r.SSF||(r.SSF=Zt(nt)),r.SSF&&(yc(),Tc(r.SSF),e.revssf=wc(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Ln(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(QC(r,e)),t.push(JC()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(se("Worksheet",o4(n,e,r),{"ss:Name":We(r.SheetNames[n])}));return t[2]=ZC(r,e),t[3]=e4(r),ht+se("Workbook",t.join(""),{xmlns:sr.ss,"xmlns:o":sr.o,"xmlns:x":sr.x,"xmlns:ss":sr.ss,"xmlns:dt":sr.dt,"xmlns:html":sr.html})}var el={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function l4(r,e){var t=[],n=[],i=[],s=0,a,o=e0(d0,"n"),l=e0(p0,"n");if(r.Props)for(a=Dt(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Dt(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],r.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)Qm.indexOf(i[s][0])>-1||Km.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&$e.utils.cfb_add(e,"/SummaryInformation",E0(n,el.SI,l,p0)),(t.length||u.length)&&$e.utils.cfb_add(e,"/DocumentSummaryInformation",E0(t,el.DSI,o,d0,u.length?u:null,el.UDI))}function u4(r,e){var t=e||{},n=$e.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return $e.utils.cfb_add(n,i,Cg(r,t)),t.biff==8&&(r.Props||r.Custprops)&&l4(r,n),t.biff==8&&r.vbaraw&&CI(n,$e.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var h4={0:{f:pR},1:{f:yR},2:{f:HR},3:{f:kR},4:{f:SR},5:{f:VR},6:{f:qR},7:{f:NR},8:{f:eC},9:{f:ZR},10:{f:QR},11:{f:JR},12:{f:AR},13:{f:$R},14:{f:FR},15:{f:CR},16:{f:UR},17:{f:XR},18:{f:LR},19:{f:Uu},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:BC},40:{},42:{},43:{f:qA},44:{f:GA},45:{f:YA},46:{f:JA},47:{f:QA},48:{},49:{f:A2},50:{},51:{f:pI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:IA},62:{f:zR},63:{f:xI},64:{f:gC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:fC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xR},148:{f:_R,p:16},151:{f:aC},152:{},153:{f:MC},154:{},155:{},156:{f:bC},157:{},158:{},159:{T:1,f:bA},160:{T:-1},161:{T:1,f:pi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fI},336:{T:-1},337:{f:_I,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:EA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:oC},427:{f:cC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:uC},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ER},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:iC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:II},633:{T:1},634:{T:-1},635:{T:1,f:wI},636:{T:-1},637:{f:C2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:PC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_C},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ae(r,e,t,n){var i=e;if(!isNaN(i)){var s=n||(t||[]).length||0,a=r.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Mu(t)&&r.push(t)}}function f4(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return ae(r,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var h=r.next(4);for(h.write_shift(2,s),h.write_shift(2,u),r.push(t.slice(l,l+u)),l+=u;l<i;){for(h=r.next(4),h.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;h.write_shift(2,u),r.push(t.slice(l,l+u)),l+=u}}}function Da(r,e,t){return r||(r=Y(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function d4(r,e,t,n){var i=Y(9);return Da(i,r,e),Zm(t,n||"b",i),i}function p4(r,e,t){var n=Y(8+2*t.length);return Da(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function m4(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Jt(zt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ae(r,2,PA(t,n,i)):ae(r,3,CA(t,n,i));return;case"b":case"e":ae(r,5,d4(t,n,e.v,e.t));return;case"s":case"str":ae(r,4,p4(t,n,(e.v||"").slice(0,255)));return}ae(r,1,Da(null,t,n))}function g4(r,e,t,n){var i=Array.isArray(e),s=Qe(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ut(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Ot(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=Bt(h)),a=l[h]+o;var d=i?(e[u]||[])[h]:e[a];d&&m4(r,d,u,h)}}}function _4(r,e){for(var t=e||{},n=Qt(),i=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ae(n,t.biff==4?1033:t.biff==3?521:9,ju(r,16,t)),g4(n,r.Sheets[r.SheetNames[i]],i,t),ae(n,10),n.end()}function v4(r,e,t){ae(r,49,hA({sz:12,name:"Arial"},t))}function E4(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ae(r,1054,pA(i,e[i],t))})}function x4(r,e){var t=Y(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ae(r,2151,t),t=Y(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),rg(Qe(e["!ref"]||"A1"),t),t.write_shift(4,4),ae(r,2152,t)}function T4(r,e){for(var t=0;t<16;++t)ae(r,224,T0({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ae(r,224,T0(n,0,e))})}function y4(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];ae(r,440,yA(n)),n[1].Tooltip&&ae(r,2048,wA(n))}delete e["!links"]}function w4(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&ae(r,125,SA(Rc(i,n),i))})}}function A4(r,e,t,n,i){var s=16+Ln(i.cellXfs,e,i);if(e.v==null&&!e.bf){ae(r,513,ii(t,n,s));return}if(e.bf)ae(r,6,KS(e,t,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Jt(zt(e.v)):e.v;ae(r,515,vA(t,n,a,s));break;case"b":case"e":ae(r,517,_A(t,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=Ku(i.Strings,e.v,i.revStrings);ae(r,253,fA(t,n,o,s))}else ae(r,516,dA(t,n,(e.v||"").slice(0,255),s,i));break;default:ae(r,513,ii(t,n,s))}}function I4(r,e,t){var n=Qt(),i=t.SheetNames[r],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},l=Array.isArray(s),u=e.biff==8,h,d="",p=[],g=Qe(s["!ref"]||"A1"),T=u?65536:16384;if(g.e.c>255||g.e.r>=T){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,T-1)}ae(n,2057,ju(t,16,e)),ae(n,13,dr(1)),ae(n,12,dr(100)),ae(n,15,Gt(!0)),ae(n,17,Gt(!1)),ae(n,16,ni(.001)),ae(n,95,Gt(!0)),ae(n,42,Gt(!1)),ae(n,43,Gt(!1)),ae(n,130,dr(1)),ae(n,128,gA()),ae(n,131,Gt(!1)),ae(n,132,Gt(!1)),u&&w4(n,s["!cols"]),ae(n,512,mA(g,e)),u&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){d=Ot(_);for(var y=g.s.c;y<=g.e.c;++y){_===g.s.r&&(p[y]=Bt(y)),h=p[y]+d;var L=l?(s[_]||[])[y]:s[h];L&&(A4(n,L,_,y,e),u&&L.l&&s["!links"].push([h,L.l]))}}var M=o.CodeName||o.name||i;return u&&ae(n,574,uA((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&ae(n,229,TA(s["!merges"])),u&&y4(n,s),ae(n,442,tg(M)),u&&x4(n,s),ae(n,10),n.end()}function S4(r,e,t){var n=Qt(),i=(r||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(ae(n,2057,ju(r,5,t)),t.bookType=="xla"&&ae(n,135),ae(n,225,o?dr(1200):null),ae(n,193,Q2(2)),l&&ae(n,191),l&&ae(n,192),ae(n,226),ae(n,92,aA("SheetJS",t)),ae(n,66,dr(o?1200:1252)),o&&ae(n,353,dr(0)),o&&ae(n,448),ae(n,317,RA(r.SheetNames.length)),o&&r.vbaraw&&ae(n,211),o&&r.vbaraw){var u=a.CodeName||"ThisWorkbook";ae(n,442,tg(u))}ae(n,156,dr(17)),ae(n,25,Gt(!1)),ae(n,18,Gt(!1)),ae(n,19,dr(0)),o&&ae(n,431,Gt(!1)),o&&ae(n,444,dr(0)),ae(n,61,lA()),ae(n,64,Gt(!1)),ae(n,141,dr(0)),ae(n,34,Gt(OC(r)=="true")),ae(n,14,Gt(!0)),o&&ae(n,439,Gt(!1)),ae(n,218,dr(0)),v4(n,r,t),E4(n,r.SSF,t),T4(n,t),o&&ae(n,352,Gt(!1));var h=n.end(),d=Qt();o&&ae(d,140,AA()),o&&t.Strings&&f4(d,252,cA(t.Strings)),ae(d,10);var p=d.end(),g=Qt(),T=0,_=0;for(_=0;_<r.SheetNames.length;++_)T+=(o?12:11)+(o?2:1)*r.SheetNames[_].length;var y=h.length+T+p.length;for(_=0;_<r.SheetNames.length;++_){var L=s[_]||{};ae(g,133,oA({pos:y,hs:L.Hidden||0,dt:0,name:r.SheetNames[_]},t)),y+=e[_].length}var M=g.end();if(T!=M.length)throw new Error("BS8 "+T+" != "+M.length);var N=[];return h.length&&N.push(h),M.length&&N.push(M),p.length&&N.push(p),Ct(N)}function R4(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=Zt(nt)),r&&r.SSF&&(yc(),Tc(r.SSF),t.revssf=wc(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xu(t),t.cellXfs=[],Ln(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=I4(i,t,r);return n.unshift(S4(r,n,t)),Ct(n)}function Cg(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=lr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return R4(r,e);case 4:case 3:case 2:return _4(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function C4(r,e,t,n){for(var i=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>t||i[u].s.c>a)&&!(i[u].e.r<t||i[u].e.c<a)){if(i[u].s.r<t||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var h=je({r:t,c:a}),d=n.dense?(r[t]||[])[a]:r[h],p=d&&d.v!=null&&(d.h||s2(d.w||(rn(d),d.w)||""))||"",g={};o>1&&(g.rowspan=o),l>1&&(g.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(g["data-t"]=d&&d.t||"z",d.v!=null&&(g["data-v"]=d.v),d.z!=null&&(g["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),g.id=(n.id||"sjs")+"-"+h,s.push(se("td",p,g))}}var T="<tr>";return T+s.join("")+"</tr>"}var P4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',k4="</body></html>";function O4(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Pg(r,e){var t=e||{},n=t.header!=null?t.header:P4,i=t.footer!=null?t.footer:k4,s=[n],a=lr(r["!ref"]);t.dense=Array.isArray(r),s.push(O4(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(C4(r,a,o,t));return s.push("</table>"+i),s.join("")}function kg(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Et(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var h=lr(r["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var d=[],p=0,g=r["!rows"]||(r["!rows"]=[]),T=0,_=0,y=0,L=0,M=0,N=0;for(r["!cols"]||(r["!cols"]=[]);T<o.length&&_<l;++T){var G=o[T];if(C0(G)){if(n.display)continue;g[_]={hidden:!0}}var J=G.children;for(y=L=0;y<J.length;++y){var ne=J[y];if(!(n.display&&C0(ne))){var w=ne.hasAttribute("data-v")?ne.getAttribute("data-v"):ne.hasAttribute("v")?ne.getAttribute("v"):l2(ne.innerHTML),x=ne.getAttribute("data-z")||ne.getAttribute("z");for(p=0;p<d.length;++p){var E=d[p];E.s.c==L+s&&E.s.r<_+i&&_+i<=E.e.r&&(L=E.e.c+1-s,p=-1)}N=+ne.getAttribute("colspan")||1,((M=+ne.getAttribute("rowspan")||1)>1||N>1)&&d.push({s:{r:_+i,c:L+s},e:{r:_+i+(M||1)-1,c:L+s+(N||1)-1}});var R={t:"s",v:w},P=ne.getAttribute("data-t")||ne.getAttribute("t")||"";w!=null&&(w.length==0?R.t=P||"z":n.raw||w.trim().length==0||P=="s"||(w==="TRUE"?R={t:"b",v:!0}:w==="FALSE"?R={t:"b",v:!1}:isNaN(Kr(w))?isNaN(Zs(w).getDate())||(R={t:"d",v:zt(w)},n.cellDates||(R={t:"n",v:Jt(R.v)}),R.z=n.dateNF||nt[14]):R={t:"n",v:Kr(w)})),R.z===void 0&&x!=null&&(R.z=x);var D="",C=ne.getElementsByTagName("A");if(C&&C.length)for(var Se=0;Se<C.length&&!(C[Se].hasAttribute("href")&&(D=C[Se].getAttribute("href"),D.charAt(0)!="#"));++Se);D&&D.charAt(0)!="#"&&(R.l={Target:D}),n.dense?(r[_+i]||(r[_+i]=[]),r[_+i][L+s]=R):r[je({c:L+s,r:_+i})]=R,u.e.c<L+s&&(u.e.c=L+s),L+=N}}++_}return d.length&&(r["!merges"]=(r["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,_-1+i),r["!ref"]=ut(u),_>=l&&(r["!fullref"]=ut((u.e.r=o.length-T+_-1+i,u))),r}function Og(r,e){var t=e||{},n=t.dense?[]:{};return kg(n,r,e)}function F4(r,e){return ui(Og(r,e),e)}function C0(r){var e="",t=D4(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function D4(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var N4=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ta({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return ht+e}}(),P0=function(){var r=function(s){return We(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+We(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,d=lr(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,T=Array.isArray(s);if(s["!cols"])for(h=0;h<=d.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var _="",y=s["!rows"]||[];for(u=0;u<d.s.r;++u)_=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+_+`></table:table-row>
`);for(;u<=d.e.r;++u){for(_=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+_+`>
`),h=0;h<d.s.c;++h)l.push(e);for(;h<=d.e.c;++h){var L=!1,M={},N="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>h)&&!(p[g].s.r>u)&&!(p[g].e.c<h)&&!(p[g].e.r<u)){(p[g].s.c!=h||p[g].s.r!=u)&&(L=!0),M["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,M["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(L){l.push(t);continue}var G=je({r:u,c:h}),J=T?(s[u]||[])[h]:s[G];if(J&&J.f&&(M["table:formula"]=We(eR(J.f)),J.F&&J.F.slice(0,G.length)==G)){var ne=lr(J.F);M["table:number-matrix-columns-spanned"]=ne.e.c-ne.s.c+1,M["table:number-matrix-rows-spanned"]=ne.e.r-ne.s.r+1}if(!J){l.push(e);continue}switch(J.t){case"b":N=J.v?"TRUE":"FALSE",M["office:value-type"]="boolean",M["office:boolean-value"]=J.v?"true":"false";break;case"n":N=J.w||String(J.v||0),M["office:value-type"]="float",M["office:value"]=J.v||0;break;case"s":case"str":N=J.v==null?"":J.v,M["office:value-type"]="string";break;case"d":N=J.w||zt(J.v).toISOString(),M["office:value-type"]="date",M["office:date-value"]=zt(J.v).toISOString(),M["table:style-name"]="ce1";break;default:l.push(e);continue}var w=r(N);if(J.l&&J.l.Target){var x=J.l.Target;x=x.charAt(0)=="#"?"#"+tR(x.slice(1)):x,x.charAt(0)!="#"&&!x.match(/^\w+:/)&&(x="../"+x),w=se("text:a",w,{"xlink:href":x.replace(/&/g,"&amp;")})}l.push("          "+se("table:table-cell",se("text:p",w,{}),M)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var d=u["!cols"][h];if(d.width==null&&d.wpx==null&&d.wch==null)continue;$u(d),d.ods=o;var p=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=l;var d=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[ht],u=ta({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=ta({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+h+`>
`),l.push(zm().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)l.push(n(a.Sheets[a.SheetNames[d]],a,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Fg(r,e){if(e.bookType=="fods")return P0(r,e);var t=Du(),n="",i=[],s=[];return n="mimetype",Ie(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ie(t,n,P0(r,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ie(t,n,N4(r,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ie(t,n,ht+zm()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ie(t,n,z2(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ie(t,n,$2(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Qo(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function b4(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):xr(ea(r))}function L4(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function On(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function M4(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)r[e+s]=i&255;r[e+15]|=t>=0?0:128}function ra(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function Be(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Vi(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function mt(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=ra(r,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];r[t[0]++]>=128;);o=r.slice(l,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=ra(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function At(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(Be(n*8+i.type)),i.type==2&&e.push(Be(i.data.length)),e.push(i.data))})}),On(e)}function vr(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=ra(r,n),s=mt(r.slice(n[0],n[0]+i));n[0]+=i;var a={id:Vi(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=mt(o.data),u=Vi(l[3][0].data);a.messages.push({meta:l,data:r.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Vi(s[3][0].data)>>>0>0),t.push(a)}return t}function wi(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:Be(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Be(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Be(a.data.length)}],n[2].push({data:At(a.meta),type:2})});var s=At(n);e.push(Be(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),On(e)}function V4(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=ra(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[On(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var h=On(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Er(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(V4(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return On(e)}function Ai(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Be(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=n}return On(e)}function tl(r,e){var t=new Uint8Array(32),n=Qo(t),i=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,M4(t,i,r.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,i)}function rl(r,e){var t=new Uint8Array(32),n=Qo(t),i=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),s|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,i)}function fn(r){var e=mt(r);return ra(e[1][0].data)}function B4(r,e,t){var n,i,s,a;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&Vi(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Qo(r[7][0].data),h=0,d=[],p=Qo(r[4][0].data),g=0,T=[],_=0;_<e.length;++_){if(e[_]==null){u.setUint16(_*2,65535,!0),p.setUint16(_*2,65535);continue}u.setUint16(_*2,h,!0),p.setUint16(_*2,g,!0);var y,L;switch(typeof e[_]){case"string":y=tl({t:"s",v:e[_]},t),L=rl({t:"s",v:e[_]},t);break;case"number":y=tl({t:"n",v:e[_]},t),L=rl({t:"n",v:e[_]},t);break;case"boolean":y=tl({t:"b",v:e[_]},t),L=rl({t:"b",v:e[_]},t);break;default:throw new Error("Unsupported value "+e[_])}d.push(y),h+=y.length,T.push(L),g+=L.length,++l}for(r[2][0].data=Be(l);_<r[7][0].data.length/2;++_)u.setUint16(_*2,65535,!0),p.setUint16(_*2,65535,!0);return r[6][0].data=On(d),r[3][0].data=On(T),l}function U4(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=lr(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ut(n)));var s=Jo(t,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(W){return W.forEach(function(B){typeof B=="string"&&a.push(B)})});var o={},l=[],u=$e.read(e.numbers,{type:"base64"});u.FileIndex.map(function(W,B){return[W,u.FullPaths[B]]}).forEach(function(W){var B=W[0],V=W[1];if(B.type==2&&B.name.match(/\.iwa/)){var ee=B.content,pe=Er(ee),_e=vr(pe);_e.forEach(function(me){l.push(me.id),o[me.id]={deps:[],location:V,type:Vi(me.messages[0].meta[1][0].data)}})}}),l.sort(function(W,B){return W-B});var h=l.filter(function(W){return W>1}).map(function(W){return[W,Be(W)]});u.FileIndex.map(function(W,B){return[W,u.FullPaths[B]]}).forEach(function(W){var B=W[0];if(W[1],!!B.name.match(/\.iwa/)){var V=vr(Er(B.content));V.forEach(function(ee){ee.messages.forEach(function(pe){h.forEach(function(_e){ee.messages.some(function(me){return Vi(me.meta[1][0].data)!=11006&&L4(me.data,_e[1])})&&o[_e[0]].deps.push(ee.id)})})})}});for(var d=$e.find(u,o[1].location),p=vr(Er(d.content)),g,T=0;T<p.length;++T){var _=p[T];_.id==1&&(g=_)}var y=fn(mt(g.messages[0].data)[1][0].data);for(d=$e.find(u,o[y].location),p=vr(Er(d.content)),T=0;T<p.length;++T)_=p[T],_.id==y&&(g=_);for(y=fn(mt(g.messages[0].data)[2][0].data),d=$e.find(u,o[y].location),p=vr(Er(d.content)),T=0;T<p.length;++T)_=p[T],_.id==y&&(g=_);for(y=fn(mt(g.messages[0].data)[2][0].data),d=$e.find(u,o[y].location),p=vr(Er(d.content)),T=0;T<p.length;++T)_=p[T],_.id==y&&(g=_);var L=mt(g.messages[0].data);{L[6][0].data=Be(n.e.r+1),L[7][0].data=Be(n.e.c+1);var M=fn(L[46][0].data),N=$e.find(u,o[M].location),G=vr(Er(N.content));{for(var J=0;J<G.length&&G[J].id!=M;++J);if(G[J].id!=M)throw"Bad ColumnRowUIDMapArchive";var ne=mt(G[J].messages[0].data);ne[1]=[],ne[2]=[],ne[3]=[];for(var w=0;w<=n.e.c;++w){var x=[];x[1]=x[2]=[{type:0,data:Be(w+420690)}],ne[1].push({type:2,data:At(x)}),ne[2].push({type:0,data:Be(w)}),ne[3].push({type:0,data:Be(w)})}ne[4]=[],ne[5]=[],ne[6]=[];for(var E=0;E<=n.e.r;++E)x=[],x[1]=x[2]=[{type:0,data:Be(E+726270)}],ne[4].push({type:2,data:At(x)}),ne[5].push({type:0,data:Be(E)}),ne[6].push({type:0,data:Be(E)});G[J].messages[0].data=At(ne)}N.content=Ai(wi(G)),N.size=N.content.length,delete L[46];var R=mt(L[4][0].data);{R[7][0].data=Be(n.e.r+1);var P=mt(R[1][0].data),D=fn(P[2][0].data);N=$e.find(u,o[D].location),G=vr(Er(N.content));{if(G[0].id!=D)throw"Bad HeaderStorageBucket";var C=mt(G[0].messages[0].data);for(E=0;E<s.length;++E){var Se=mt(C[2][0].data);Se[1][0].data=Be(E),Se[4][0].data=Be(s[E].length),C[2][E]={type:C[2][0].type,data:At(Se)}}G[0].messages[0].data=At(C)}N.content=Ai(wi(G)),N.size=N.content.length;var Ee=fn(R[2][0].data);N=$e.find(u,o[Ee].location),G=vr(Er(N.content));{if(G[0].id!=Ee)throw"Bad HeaderStorageBucket";for(C=mt(G[0].messages[0].data),w=0;w<=n.e.c;++w)Se=mt(C[2][0].data),Se[1][0].data=Be(w),Se[4][0].data=Be(n.e.r+1),C[2][w]={type:C[2][0].type,data:At(Se)};G[0].messages[0].data=At(C)}N.content=Ai(wi(G)),N.size=N.content.length;var ft=fn(R[4][0].data);(function(){for(var W=$e.find(u,o[ft].location),B=vr(Er(W.content)),V,ee=0;ee<B.length;++ee){var pe=B[ee];pe.id==ft&&(V=pe)}var _e=mt(V.messages[0].data);{_e[3]=[];var me=[];a.forEach(function(Re,dt){me[1]=[{type:0,data:Be(dt)}],me[2]=[{type:0,data:Be(1)}],me[3]=[{type:2,data:b4(Re)}],_e[3].push({type:2,data:At(me)})})}V.messages[0].data=At(_e);var le=wi(B),De=Ai(le);W.content=De,W.size=W.content.length})();var Ge=mt(R[3][0].data);{var Tt=Ge[1][0];delete Ge[2];var et=mt(Tt.data);{var Ht=fn(et[2][0].data);(function(){for(var W=$e.find(u,o[Ht].location),B=vr(Er(W.content)),V,ee=0;ee<B.length;++ee){var pe=B[ee];pe.id==Ht&&(V=pe)}var _e=mt(V.messages[0].data);{delete _e[6],delete Ge[7];var me=new Uint8Array(_e[5][0].data);_e[5]=[];for(var le=0,De=0;De<=n.e.r;++De){var Re=mt(me);le+=B4(Re,s[De],a),Re[1][0].data=Be(De),_e[5].push({data:At(Re),type:2})}_e[1]=[{type:0,data:Be(n.e.c+1)}],_e[2]=[{type:0,data:Be(n.e.r+1)}],_e[3]=[{type:0,data:Be(le)}],_e[4]=[{type:0,data:Be(n.e.r+1)}]}V.messages[0].data=At(_e);var dt=wi(B),ke=Ai(dt);W.content=ke,W.size=W.content.length})()}Tt.data=At(et)}R[3][0].data=At(Ge)}L[4][0].data=At(R)}g.messages[0].data=At(L);var jt=wi(p),b=Ai(jt);return d.content=b,d.size=d.content.length,u}function W4(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Xu(r){W4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function H4(r,e){return e.bookType=="ods"?Fg(r,e):e.bookType=="numbers"?U4(r,e):e.bookType=="xlsb"?j4(r,e):$4(r,e)}function j4(r,e){ki=1024,r&&!r.SSF&&(r.SSF=Zt(nt)),r&&r.SSF&&(yc(),Tc(r.SSF),e.revssf=wc(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Bs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=pg.indexOf(e.bookType)>-1,i=jm();Xu(e=e||{});var s=Du(),a="",o=0;if(e.cellXfs=[],Ln(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Ie(s,a,qm(r.Props,e)),i.coreprops.push(a),Ue(e.rels,2,a,be.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],u=0;u<r.SheetNames.length;++u)(r.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(r.SheetNames[u]);r.Props.SheetNames=l}for(r.Props.Worksheets=r.Props.SheetNames.length,Ie(s,a,Xm(r.Props)),i.extprops.push(a),Ue(e.rels,3,a,be.EXT_PROPS),r.Custprops!==r.Props&&Dt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Ie(s,a,Ym(r.Custprops)),i.custprops.push(a),Ue(e.rels,4,a,be.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},d=r.Sheets[r.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Ie(s,a,zC(o-1,a,e,r,h)),i.sheets.push(a),Ue(e.wbrels,-1,"worksheets/sheet"+o+"."+t,be.WS[0])}if(d){var g=d["!comments"],T=!1,_="";g&&g.length>0&&(_="xl/comments"+o+"."+t,Ie(s,_,XC(g,_)),i.comments.push(_),Ue(h,-1,"../comments"+o+"."+t,be.CMNT),T=!0),d["!legacy"]&&T&&Ie(s,"xl/drawings/vmlDrawing"+o+".vml",fg(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Ie(s,Gm(a),Li(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Ie(s,a,KC(e.Strings,a,e)),i.strs.push(a),Ue(e.wbrels,-1,"sharedStrings."+t,be.SST)),a="xl/workbook."+t,Ie(s,a,GC(r,a)),i.workbooks.push(a),Ue(e.rels,1,a,be.WB),a="xl/theme/theme1.xml",Ie(s,a,ug(r.Themes,e)),i.themes.push(a),Ue(e.wbrels,-1,"theme/theme1.xml",be.THEME),a="xl/styles."+t,Ie(s,a,qC(r,a,e)),i.styles.push(a),Ue(e.wbrels,-1,"styles."+t,be.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",Ie(s,a,r.vbaraw),i.vba.push(a),Ue(e.wbrels,-1,"vbaProject.bin",be.VBA)),a="xl/metadata."+t,Ie(s,a,YC(a)),i.metadata.push(a),Ue(e.wbrels,-1,"metadata."+t,be.XLMETA),Ie(s,"[Content_Types].xml",$m(i,e)),Ie(s,"_rels/.rels",Li(e.rels)),Ie(s,"xl/_rels/workbook."+t+".rels",Li(e.wbrels)),delete e.revssf,delete e.ssf,s}function $4(r,e){ki=1024,r&&!r.SSF&&(r.SSF=Zt(nt)),r&&r.SSF&&(yc(),Tc(r.SSF),e.revssf=wc(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Bs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=pg.indexOf(e.bookType)>-1,i=jm();Xu(e=e||{});var s=Du(),a="",o=0;if(e.cellXfs=[],Ln(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Ie(s,a,qm(r.Props,e)),i.coreprops.push(a),Ue(e.rels,2,a,be.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],u=0;u<r.SheetNames.length;++u)(r.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(r.SheetNames[u]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,Ie(s,a,Xm(r.Props)),i.extprops.push(a),Ue(e.rels,3,a,be.EXT_PROPS),r.Custprops!==r.Props&&Dt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Ie(s,a,Ym(r.Custprops)),i.custprops.push(a),Ue(e.rels,4,a,be.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var d={"!id":{}},p=r.Sheets[r.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Ie(s,a,wg(o-1,e,r,d)),i.sheets.push(a),Ue(e.wbrels,-1,"worksheets/sheet"+o+"."+t,be.WS[0])}if(p){var T=p["!comments"],_=!1,y="";if(T&&T.length>0){var L=!1;T.forEach(function(M){M[1].forEach(function(N){N.T==!0&&(L=!0)})}),L&&(y="xl/threadedComments/threadedComment"+o+"."+t,Ie(s,y,TI(T,h,e)),i.threadedcomments.push(y),Ue(d,-1,"../threadedComments/threadedComment"+o+"."+t,be.TCMNT)),y="xl/comments"+o+"."+t,Ie(s,y,dg(T)),i.comments.push(y),Ue(d,-1,"../comments"+o+"."+t,be.CMNT),_=!0}p["!legacy"]&&_&&Ie(s,"xl/drawings/vmlDrawing"+o+".vml",fg(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&Ie(s,Gm(a),Li(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Ie(s,a,ig(e.Strings,e)),i.strs.push(a),Ue(e.wbrels,-1,"sharedStrings."+t,be.SST)),a="xl/workbook."+t,Ie(s,a,Sg(r)),i.workbooks.push(a),Ue(e.rels,1,a,be.WB),a="xl/theme/theme1.xml",Ie(s,a,ug(r.Themes,e)),i.themes.push(a),Ue(e.wbrels,-1,"theme/theme1.xml",be.THEME),a="xl/styles."+t,Ie(s,a,cg(r,e)),i.styles.push(a),Ue(e.wbrels,-1,"styles."+t,be.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",Ie(s,a,r.vbaraw),i.vba.push(a),Ue(e.wbrels,-1,"vbaProject.bin",be.VBA)),a="xl/metadata."+t,Ie(s,a,hg()),i.metadata.push(a),Ue(e.wbrels,-1,"metadata."+t,be.XLMETA),h.length>1&&(a="xl/persons/person.xml",Ie(s,a,yI(h)),i.people.push(a),Ue(e.wbrels,-1,"persons/person.xml",be.PEOPLE)),Ie(s,"[Content_Types].xml",$m(i,e)),Ie(s,"_rels/.rels",Li(e.rels)),Ie(s,"xl/_rels/workbook."+t+".rels",Li(e.wbrels)),delete e.revssf,delete e.ssf,s}function G4(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=tn(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Dg(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Pa(e.file,$e.write(r,{type:Me?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return $e.write(r,e)}function z4(r,e){var t=Zt(e||{}),n=H4(r,t);return q4(n,t)}function q4(r,e){var t={},n=Me?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?$e.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(xc(i))}return e.password&&typeof encrypt_agile<"u"?Dg(encrypt_agile(i,e.password),e):e.type==="file"?Pa(e.file,i):e.type=="string"?bs(i):i}function K4(r,e){var t=e||{},n=u4(r,t);return Dg(n,t)}function Rr(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Js(ea(n));case"binary":return ea(n);case"string":return r;case"file":return Pa(e.file,n,"utf8");case"buffer":return Me?sn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Rr(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function X4(r,e){switch(e.type){case"base64":return Js(r);case"binary":return r;case"string":return r;case"file":return Pa(e.file,r,"binary");case"buffer":return Me?sn(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function uo(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Js(t):e.type=="string"?bs(t):t;case"file":return Pa(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function Ng(r,e){ww(),NC(r);var t=Zt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Ng(r,t);return t.type="array",xc(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Rr(c4(r,t),t);case"slk":case"sylk":return Rr(OA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return Rr(Pg(r.Sheets[r.SheetNames[i]],t),t);case"txt":return X4(bg(r.Sheets[r.SheetNames[i]],t),t);case"csv":return Rr(Yu(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return Rr(FA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return uo(kA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return Rr(DA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return Rr(UA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return Rr(ng.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return Rr(Fg(r,t),t);case"wk1":return uo(y0.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return uo(y0.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),uo(Cg(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),K4(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return z4(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Y4(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Q4(r,e,t){var n={};return n.type="file",n.file=e,Y4(n),Ng(r,n)}function J4(r,e,t,n,i,s,a,o){var l=Ot(t),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:t,enumerable:!1})}catch{p.__rowNum__=t}else p.__rowNum__=t;if(!a||r[t])for(var g=e.s.c;g<=e.e.c;++g){var T=a?r[t][g]:r[n[g]+l];if(T===void 0||T.t===void 0){if(u===void 0)continue;s[g]!=null&&(p[s[g]]=u);continue}var _=T.v;switch(T.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+T.t)}if(s[g]!=null){if(_==null)if(T.t=="e"&&_===null)p[s[g]]=null;else if(u!==void 0)p[s[g]]=u;else if(h&&_===null)p[s[g]]=null;else continue;else p[s[g]]=h&&(T.t!=="n"||T.t==="n"&&o.rawNumbers!==!1)?_:rn(T,_,o);_!=null&&(d=!1)}}return{row:p,isempty:d}}function Jo(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:r["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":l=Qe(h);break;case"number":l=Qe(r["!ref"]),l.s.r=h;break;default:l=h}n>0&&(i=0);var d=Ot(l.s.r),p=[],g=[],T=0,_=0,y=Array.isArray(r),L=l.s.r,M=0,N={};y&&!r[L]&&(r[L]=[]);var G=u.skipHidden&&r["!cols"]||[],J=u.skipHidden&&r["!rows"]||[];for(M=l.s.c;M<=l.e.c;++M)if(!(G[M]||{}).hidden)switch(p[M]=Bt(M),t=y?r[L][M]:r[p[M]+d],n){case 1:s[M]=M-l.s.c;break;case 2:s[M]=p[M];break;case 3:s[M]=u.header[M-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=rn(t,null,u),_=N[a]||0,!_)N[a]=1;else{do o=a+"_"+_++;while(N[o]);N[a]=_,N[o]=1}s[M]=o}for(L=l.s.r+i;L<=l.e.r;++L)if(!(J[L]||{}).hidden){var ne=J4(r,l,L,p,n,s,y,u);(ne.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[T++]=ne.row)}return g.length=T,g}var k0=/"/g;function Z4(r,e,t,n,i,s,a,o){for(var l=!0,u=[],h="",d=Ot(t),p=e.s.c;p<=e.e.c;++p)if(n[p]){var g=o.dense?(r[t]||[])[p]:r[n[p]+d];if(g==null)h="";else if(g.v!=null){l=!1,h=""+(o.rawNumbers&&g.t=="n"?g.v:rn(g,null,o));for(var T=0,_=0;T!==h.length;++T)if((_=h.charCodeAt(T))===i||_===s||_===34||o.forceQuotes){h='"'+h.replace(k0,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(l=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(k0,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&l?null:u.join(a)}function Yu(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=Qe(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",d=[];n.dense=Array.isArray(r);for(var p=n.skipHidden&&r["!cols"]||[],g=n.skipHidden&&r["!rows"]||[],T=i.s.c;T<=i.e.c;++T)(p[T]||{}).hidden||(d[T]=Bt(T));for(var _=0,y=i.s.r;y<=i.e.r;++y)(g[y]||{}).hidden||(h=Z4(r,i,y,d,a,l,s,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&t.push((_++?o:"")+h)));return delete n.dense,t.join("")}function bg(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Yu(r,e);return t}function eP(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=Qe(r["!ref"]),s="",a=[],o,l=[],u=Array.isArray(r);for(o=i.s.c;o<=i.e.c;++o)a[o]=Bt(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Ot(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=u?(r[h]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=e+"="+n}return l}function Lg(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Et(n.origin):n.origin;a=l.r,o=l.c}var u,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var d=Qe(s["!ref"]);h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),a==-1&&(a=d.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var p=n.header||[],g=0;e.forEach(function(_,y){Dt(_).forEach(function(L){(g=p.indexOf(L))==-1&&(p[g=p.length]=L);var M=_[L],N="z",G="",J=je({c:o+g,r:a+y+i});u=na(s,J),M&&typeof M=="object"&&!(M instanceof Date)?s[J]=M:(typeof M=="number"?N="n":typeof M=="boolean"?N="b":typeof M=="string"?N="s":M instanceof Date?(N="d",n.cellDates||(N="n",M=Jt(M)),G=n.dateNF||nt[14]):M===null&&n.nullError&&(N="e",M=0),u?(u.t=N,u.v=M,delete u.w,delete u.R,G&&(u.z=G)):s[J]=u={t:N,v:M},G&&(u.z=G))})}),h.e.c=Math.max(h.e.c,o+p.length-1);var T=Ot(a);if(i)for(g=0;g<p.length;++g)s[Bt(g+o)+T]={t:"s",v:p[g]};return s["!ref"]=ut(h),s}function tP(r,e){return Lg(null,r,e)}function na(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=Et(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?na(r,je(e)):na(r,je({r:e,c:t||0}))}function rP(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function nP(){return{SheetNames:[],Sheets:{}}}function iP(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=a+i)!=-1;++i);}if(Ig(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function sP(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=rP(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function aP(r,e){return r.z=e,r}function Mg(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function oP(r,e,t){return Mg(r,"#"+e,t)}function cP(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function lP(r,e,t,n){for(var i=typeof e!="string"?e:Qe(e),s=typeof e=="string"?e:ut(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=na(r,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,n&&(l.D=!0))}return r}var nl={encode_col:Bt,encode_row:Ot,encode_cell:je,encode_range:ut,decode_col:Bu,decode_row:Vu,split_cell:w2,decode_cell:Et,decode_range:lr,format_cell:rn,sheet_add_aoa:Mm,sheet_add_json:Lg,sheet_add_dom:kg,aoa_to_sheet:is,json_to_sheet:tP,table_to_sheet:Og,table_to_book:F4,sheet_to_csv:Yu,sheet_to_txt:bg,sheet_to_json:Jo,sheet_to_html:Pg,sheet_to_formulae:eP,sheet_to_row_object_array:Jo,sheet_get_cell:na,book_new:nP,book_append_sheet:iP,book_set_sheet_visibility:sP,cell_set_number_format:aP,cell_set_hyperlink:Mg,cell_set_internal_link:oP,cell_add_comment:cP,sheet_set_array_formula:lP,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function uP(r,e){const t=r.getContext("2d"),{options:n,opin:i}=e,s=window.devicePixelRatio||1,a=600,o=350;r.width=a*s,r.height=o*s,r.style.width=a+"px",r.style.height=o+"px",t.scale(s,s),t.fillStyle="#222222",t.fillRect(0,0,a,o);const l={top:40,right:30,bottom:60,left:50},u=a-l.left-l.right,h=o-l.top-l.bottom,d=Math.max(...n.map(L=>L.count),1),p=n.length,g=20,T=(u-(p-1)*g)/p,_=["#1DCD9F","#169976","#14866a","#0f735b","#1ab98f","#17a77f","#149570","#118360","#25d9aa","#30e5b5","#3cf1c0","#48fdcb"];t.fillStyle="#ffffff",t.font="bold 16px Inter, sans-serif",t.textAlign="center",t.fillText(i.question,a/2,25),t.strokeStyle="rgba(255, 255, 255, 0.2)",t.lineWidth=1,t.beginPath(),t.moveTo(l.left,l.top),t.lineTo(l.left,o-l.bottom),t.stroke(),t.fillStyle="#a0a0b0",t.font="12px Inter, sans-serif",t.textAlign="right";const y=5;for(let L=0;L<=y;L++){const M=Math.round(d/y*L),N=o-l.bottom-h/y*L;t.fillText(M.toString(),l.left-10,N+4),t.strokeStyle="rgba(255, 255, 255, 0.05)",t.beginPath(),t.moveTo(l.left,N),t.lineTo(a-l.right,N),t.stroke()}n.forEach((L,M)=>{const N=l.left+M*(T+g),G=L.count/d*h,J=o-l.bottom-G,ne=t.createLinearGradient(N,J,N,o-l.bottom),w=_[M%_.length];ne.addColorStop(0,w),ne.addColorStop(1,w+"80"),t.fillStyle=ne;const x=4;t.beginPath(),t.moveTo(N+x,J),t.lineTo(N+T-x,J),t.quadraticCurveTo(N+T,J,N+T,J+x),t.lineTo(N+T,o-l.bottom),t.lineTo(N,o-l.bottom),t.lineTo(N,J+x),t.quadraticCurveTo(N,J,N+x,J),t.fill(),t.fillStyle="#ffffff",t.font="bold 14px Inter, sans-serif",t.textAlign="center",t.fillText(L.count.toString(),N+T/2,J-8),t.fillStyle="#a0a0b0",t.font="11px Inter, sans-serif",t.textAlign="center";let E=L.text;E.length>12&&(E=E.substring(0,10)+"..."),t.fillText(E,N+T/2,o-l.bottom+20)})}function hP(r,e){if(r.innerHTML="",e.opin.anonymous){r.innerHTML='<p style="color: var(--text-muted); text-align: center; width: 100%;">This Opin has anonymous voting enabled</p>';return}e.options.forEach((t,n)=>{const i=document.createElement("details");i.className="voter-dropdown";const s=document.createElement("summary");s.textContent=`${t.text} (${t.voters.length})`,i.appendChild(s);const a=document.createElement("div");a.className="voter-list",t.voters.length===0?a.innerHTML="<p>No votes yet</p>":t.voters.forEach(o=>{const l=document.createElement("p");l.textContent=o,a.appendChild(l)}),i.appendChild(a),r.appendChild(i)})}function fP(r,e="opin-results"){const t=document.createElement("a");t.download=`${e}.png`,t.href=r.toDataURL("image/png"),t.click()}function dP(r,e="opin-results"){const t=document.createElement("canvas");t.width=r.width,t.height=r.height;const n=t.getContext("2d");n.fillStyle="#222222",n.fillRect(0,0,t.width,t.height),n.drawImage(r,0,0);const i=document.createElement("a");i.download=`${e}.jpg`,i.href=t.toDataURL("image/jpeg",.9),i.click()}function pP(r,e="opin-results"){const{opin:t,options:n,totalVotes:i}=r,s=[["Opin Results"],[""],["Question:",t.question],["Total Votes:",i],["Status:",t.status],[""],["Option","Votes","Percentage","Voters"]];n.forEach(l=>{const u=i>0?(l.count/i*100).toFixed(1)+"%":"0%",h=t.anonymous?"Anonymous":l.voters.join(", ");s.push([l.text,l.count,u,h])});const a=nl.aoa_to_sheet(s),o=nl.book_new();nl.book_append_sheet(o,a,"Results"),Q4(o,`${e}.xlsx`)}function mP(r){const{opin:e,options:t,totalVotes:n}=r;let i=`Option,Votes,Percentage
`;t.forEach(l=>{const u=n>0?(l.count/n*100).toFixed(1):0;i+=`"${l.text}",${l.count},${u}%
`}),`${encodeURIComponent(e.name+" Results")}`;const s=new Blob([i],{type:"text/csv"}),a=URL.createObjectURL(s),o=document.createElement("a");o.download=`${e.name}-results.csv`,o.href=a,o.click(),setTimeout(()=>{window.open("https://sheets.google.com","_blank")},500)}const gP=document.getElementById("notification-container"),O0={success:`<svg aria-hidden="true" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.5 11.5 11 14l4-4m6 2a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path>
  </svg>`,info:`<svg aria-hidden="true" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11h2v5m-2 0h4m-2.592-8.5h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path>
  </svg>`,warning:`<svg aria-hidden="true" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V8m0 8h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path>
  </svg>`,error:`<svg aria-hidden="true" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 9-6 6m0-6 6 6m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path>
  </svg>`},_P=`<svg aria-hidden="true" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 17.94 6M18 18 6.06 6"></path>
</svg>`;function ho(r,e,t=5e3){const n=document.createElement("li");n.className=`notification-item ${r}`,n.innerHTML=`
    <div class="notification-content">
      <div class="notification-icon">${O0[r]||O0.info}</div>
      <div class="notification-text">${e}</div>
    </div>
    <div class="notification-icon notification-close">${_P}</div>
    <div class="notification-progress-bar" style="animation-duration: ${t}ms"></div>
  `,gP.appendChild(n),n.querySelector(".notification-close").addEventListener("click",()=>F0(n));const s=setTimeout(()=>F0(n),t);n.dataset.timeout=s}function F0(r){r.dataset.timeout&&clearTimeout(parseInt(r.dataset.timeout)),r.classList.add("removing"),setTimeout(()=>r.remove(),300)}const Fe={success:(r,e)=>ho("success",r,e),info:(r,e)=>ho("info",r,e),warning:(r,e)=>ho("warning",r,e),error:(r,e)=>ho("error",r,e)},Vg=document.getElementById("loader-overlay");function Bg(){Vg.classList.remove("hidden")}function yo(){Vg.classList.add("hidden")}async function An(r){Bg();try{return await r()}finally{yo()}}const ia=document.getElementById("auth-section"),sa=document.getElementById("main-section"),aa=document.getElementById("vote-section"),Qu=document.getElementById("login-form"),Ju=document.getElementById("register-form"),vP=document.getElementById("show-register"),EP=document.getElementById("show-login"),xP=document.getElementById("user-email"),TP=document.getElementById("logout-btn"),yP=document.getElementById("create-opin-btn"),il=document.getElementById("active-opins-list"),sl=document.getElementById("ended-opins-list"),oa=document.getElementById("create-modal"),Zo=document.getElementById("share-modal"),ec=document.getElementById("graph-modal");let tc=[],pr=null;function Ug(){const r=window.location.pathname,e=r.match(/^\/vote\/([a-zA-Z0-9]+)$/);if(e)return{type:"vote",linkId:e[1]};const t=r.match(/^\/graph\/([a-zA-Z0-9]+)$/);return t?{type:"graph",linkId:t[1]}:{type:"main"}}async function wP(){const r=Ug();r.type==="vote"?await AP(r.linkId):r.type==="graph"&&await IP(r.linkId)}async function AP(r){Bg();try{const e=await hw(r);if(!e){yo(),ia.classList.add("hidden"),sa.classList.add("hidden"),aa.classList.remove("hidden"),document.getElementById("vote-title").textContent="Opin Not Found",document.getElementById("vote-question").textContent="This voting link is invalid or has been removed.",document.getElementById("vote-form").classList.add("hidden");return}tm(async t=>{if(yo(),!t){sessionStorage.setItem("redirectAfterLogin",window.location.pathname),ia.classList.remove("hidden"),sa.classList.add("hidden"),aa.classList.add("hidden"),Fe.info("Please log in to vote");return}await SP(e)})}catch(e){yo(),Fe.error("Failed to load voting page"),console.error(e)}}async function IP(r){window.location.href="/"}async function SP(r){ia.classList.add("hidden"),sa.classList.add("hidden"),aa.classList.remove("hidden"),document.getElementById("vote-title").textContent=r.name,document.getElementById("vote-question").textContent=r.question;const e=document.getElementById("vote-status-message"),t=document.getElementById("vote-form"),n=document.getElementById("already-voted-message");if(r.status==="paused"){e.textContent="This Opin is currently paused. Please check back later.",e.className="vote-status-message paused",e.classList.remove("hidden"),t.classList.add("hidden"),n.classList.add("hidden");return}if(r.status==="ended"){e.textContent="This Opin has ended and is no longer accepting votes.",e.className="vote-status-message ended",e.classList.remove("hidden"),t.classList.add("hidden"),n.classList.add("hidden");return}if(await nm(r.id)){e.classList.add("hidden"),t.classList.add("hidden"),n.classList.remove("hidden");return}e.classList.add("hidden"),t.classList.remove("hidden"),n.classList.add("hidden");const s=document.getElementById("vote-options");s.innerHTML="";const a=r.multiSelect?"checkbox":"radio";r.options.forEach((o,l)=>{const u=document.createElement("label");u.className="vote-option",u.innerHTML=`
      <input type="${a}" name="vote-option" value="${l}">
      <span>${o}</span>
    `,u.addEventListener("click",()=>{r.multiSelect||document.querySelectorAll(".vote-option").forEach(h=>h.classList.remove("selected")),u.classList.toggle("selected"),r.multiSelect&&document.querySelectorAll(".vote-option.selected").length>r.maxSelections&&(u.classList.remove("selected"),u.querySelector("input").checked=!1,Fe.warning(`You can only select up to ${r.maxSelections} options`))}),s.appendChild(u)}),t.onsubmit=async o=>{o.preventDefault();const l=Array.from(document.querySelectorAll(".vote-option.selected input")).map(u=>parseInt(u.value));if(l.length===0){Fe.warning("Please select at least one option");return}try{await An(async()=>{await vw(r.id,l)}),Fe.success("Your vote has been submitted!"),t.classList.add("hidden"),n.classList.remove("hidden")}catch(u){Fe.error(u.message)}}}vP.addEventListener("click",r=>{r.preventDefault(),Qu.classList.add("hidden"),Ju.classList.remove("hidden")});EP.addEventListener("click",r=>{r.preventDefault(),Ju.classList.add("hidden"),Qu.classList.remove("hidden")});Qu.addEventListener("submit",async r=>{r.preventDefault();const e=document.getElementById("login-email").value,t=document.getElementById("login-password").value,n=document.getElementById("keep-logged-in").checked;try{await An(async()=>{await aw(e,t,n)}),Fe.success("Welcome back!")}catch(i){Fe.error(Wg(i.code))}});Ju.addEventListener("submit",async r=>{r.preventDefault();const e=document.getElementById("register-email").value,t=document.getElementById("register-password").value,n=document.getElementById("register-confirm").value;if(t!==n){Fe.error("Passwords do not match");return}try{await An(async()=>{await sw(e,t,!0)}),Fe.success("Account created successfully!")}catch(i){Fe.error(Wg(i.code))}});TP.addEventListener("click",async()=>{try{await ow(),Fe.info("You have been logged out")}catch{Fe.error("Failed to log out")}});function Wg(r){return{"auth/email-already-in-use":"This email is already registered","auth/invalid-email":"Please enter a valid email address","auth/weak-password":"Password should be at least 6 characters","auth/user-not-found":"No account found with this email","auth/wrong-password":"Incorrect password","auth/invalid-credential":"Invalid email or password"}[r]||"An error occurred. Please try again."}tm(async r=>{if(Ug().type!=="vote")if(r){const t=sessionStorage.getItem("redirectAfterLogin");if(t){sessionStorage.removeItem("redirectAfterLogin"),window.location.href=t;return}ia.classList.add("hidden"),sa.classList.remove("hidden"),aa.classList.add("hidden"),xP.textContent=r.email,await Bi(),setInterval(async()=>{await rm(),await Bi()},6e4)}else ia.classList.remove("hidden"),sa.classList.add("hidden"),aa.classList.add("hidden")});async function Bi(){try{await rm(),tc=await uw(),RP()}catch(r){Fe.error("Failed to load your Opins"),console.error(r)}}function RP(){const r=tc.filter(t=>t.status==="active"||t.status==="paused"),e=tc.filter(t=>t.status==="ended");r.length===0?il.innerHTML='<p class="empty-message">No active Opins yet. Create one to get started!</p>':(il.innerHTML=r.map(t=>D0(t,!1)).join(""),N0(il)),e.length===0?sl.innerHTML='<p class="empty-message">No ended Opins yet.</p>':(sl.innerHTML=e.map(t=>D0(t,!0)).join(""),N0(sl))}function D0(r,e){var o,l;const n=(((l=(o=r.expiresAt)==null?void 0:o.toDate)==null?void 0:l.call(o))||new Date(r.expiresAt)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),i=r.status,s=r.status.charAt(0).toUpperCase()+r.status.slice(1);let a="";if(e)a=`
      <button class="btn btn-secondary btn-small btn-graph" data-id="${r.id}"> Graph</button>
    `;else{const u=r.status==="paused"?`<button class="btn btn-success btn-small btn-reactivate" data-id="${r.id}"> Reactivate</button>`:`<button class="btn btn-warning btn-small btn-pause" data-id="${r.id}"> Pause</button>`;a=`
      <span class="opin-status ${i}">${s}</span>
      ${u}
      <button class="btn btn-danger btn-small btn-end" data-id="${r.id}"> End</button>
      <button class="btn btn-secondary btn-small btn-graph" data-id="${r.id}"> Graph</button>
      <button class="btn btn-secondary btn-small btn-share" data-id="${r.id}" data-link="${r.linkId}"> Share</button>
    `}return`
    <div class="opin-card" data-id="${r.id}">
      <div class="opin-info">
        <div class="opin-name">${kP(r.name)}</div>
        <div class="opin-meta">Expires: ${n}  ${Object.values(r.votes).reduce((u,h)=>u+h,0)} votes</div>
      </div>
      <div class="opin-actions">
        ${a}
      </div>
    </div>
  `}function N0(r){r.querySelectorAll(".btn-pause").forEach(e=>{e.addEventListener("click",async t=>{t.stopPropagation();const n=e.dataset.id;try{await An(async()=>{await fw(n),await Bi()}),Fe.success("Opin paused")}catch(i){Fe.error(i.message)}})}),r.querySelectorAll(".btn-reactivate").forEach(e=>{e.addEventListener("click",async t=>{t.stopPropagation();const n=e.dataset.id;try{await An(async()=>{await dw(n),await Bi()}),Fe.success("Opin reactivated")}catch(i){Fe.error(i.message)}})}),r.querySelectorAll(".btn-end").forEach(e=>{e.addEventListener("click",async t=>{t.stopPropagation();const n=e.dataset.id;if(confirm("Are you sure you want to end this Opin? This cannot be undone."))try{await An(async()=>{await pw(n),await Bi()}),Fe.success("Opin ended")}catch(i){Fe.error(i.message)}})}),r.querySelectorAll(".btn-share").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const n=e.dataset.link;Hg(n)})}),r.querySelectorAll(".btn-graph").forEach(e=>{e.addEventListener("click",async t=>{t.stopPropagation();const n=e.dataset.id;await PP(n)})})}yP.addEventListener("click",()=>{oa.classList.remove("hidden"),CP()});document.getElementById("close-create-modal").addEventListener("click",()=>{oa.classList.add("hidden")});oa.querySelector(".modal-backdrop").addEventListener("click",()=>{oa.classList.add("hidden")});document.getElementById("add-option-btn").addEventListener("click",()=>{const r=document.getElementById("options-container"),e=r.children.length+1,t=document.createElement("div");t.className="option-row",t.innerHTML=`
    <input type="text" class="option-input" required placeholder="Option ${e}">
    <button type="button" class="btn-remove"></button>
  `,t.querySelector(".btn-remove").addEventListener("click",()=>{r.children.length>2?t.remove():Fe.warning("You need at least 2 options")}),r.appendChild(t)});document.getElementById("multi-select-toggle").addEventListener("change",r=>{const e=document.getElementById("max-selections-container");r.target.checked?e.classList.remove("hidden"):e.classList.add("hidden")});document.getElementById("create-opin-form").addEventListener("submit",async r=>{r.preventDefault();const e=document.getElementById("opin-name").value.trim(),t=document.getElementById("opin-expiration").value,n=document.getElementById("opin-question").value.trim(),i=document.getElementById("multi-select-toggle").checked,s=parseInt(document.getElementById("max-selections").value)||1,a=document.getElementById("anonymous-toggle").checked,o=document.querySelectorAll(".option-input"),l=Array.from(o).map(u=>u.value.trim()).filter(u=>u);if(l.length<2){Fe.warning("Please add at least 2 options");return}if(new Date(t)<=new Date){Fe.warning("Expiration date must be in the future");return}try{const u=await An(async()=>await lw({name:e,question:n,options:l,expiresAt:t,multiSelect:i,maxSelections:s,anonymous:a}));Fe.success("Opin created successfully!"),oa.classList.add("hidden"),Hg(u.linkId),await Bi()}catch(u){Fe.error(u.message)}});function CP(){document.getElementById("create-opin-form").reset(),document.getElementById("max-selections-container").classList.add("hidden");const r=document.getElementById("options-container");r.innerHTML=`
    <div class="option-row">
      <input type="text" class="option-input" required placeholder="Option 1">
    </div>
    <div class="option-row">
      <input type="text" class="option-input" required placeholder="Option 2">
    </div>
  `;const e=new Date;e.setDate(e.getDate()+1),document.getElementById("opin-expiration").value=e.toISOString().slice(0,16)}function Hg(r){Zo.classList.remove("hidden");const e=mw(r);document.getElementById("share-link-input").value=e}document.getElementById("close-share-modal").addEventListener("click",()=>{Zo.classList.add("hidden")});Zo.querySelector(".modal-backdrop").addEventListener("click",()=>{Zo.classList.add("hidden")});document.getElementById("copy-link-btn").addEventListener("click",async()=>{const r=document.getElementById("share-link-input");try{await navigator.clipboard.writeText(r.value),Fe.success("Link copied to clipboard!")}catch{r.select(),document.execCommand("copy"),Fe.success("Link copied to clipboard!")}});async function PP(r){ec.classList.remove("hidden");const e=tc.find(n=>n.id===r);pr=e,document.getElementById("graph-title").textContent=e.name+" - Results";const t=document.getElementById("graph-actions");e.status==="ended"?t.classList.remove("hidden"):t.classList.add("hidden");try{const n=await An(async()=>await xw(r)),i=document.getElementById("graph-canvas");uP(i,n);const s=document.getElementById("voter-dropdowns");hP(s,n),i.graphData=n}catch(n){Fe.error("Failed to load graph data"),console.error(n)}}document.getElementById("close-graph-modal").addEventListener("click",()=>{ec.classList.add("hidden")});ec.querySelector(".modal-backdrop").addEventListener("click",()=>{ec.classList.add("hidden")});document.getElementById("export-png").addEventListener("click",()=>{const r=document.getElementById("graph-canvas");fP(r,(pr==null?void 0:pr.name)||"opin-results"),Fe.success("PNG downloaded!")});document.getElementById("export-jpg").addEventListener("click",()=>{const r=document.getElementById("graph-canvas");dP(r,(pr==null?void 0:pr.name)||"opin-results"),Fe.success("JPG downloaded!")});document.getElementById("export-excel").addEventListener("click",()=>{const r=document.getElementById("graph-canvas");r.graphData&&(pP(r.graphData,(pr==null?void 0:pr.name)||"opin-results"),Fe.success("Excel file downloaded!"))});document.getElementById("export-sheets").addEventListener("click",()=>{const r=document.getElementById("graph-canvas");r.graphData&&(mP(r.graphData),Fe.info("CSV downloaded. Import it into Google Sheets."))});document.getElementById("share-graph-btn").addEventListener("click",async()=>{if(pr){const r=gw(pr.linkId);try{await navigator.clipboard.writeText(r),Fe.success("Graph link copied to clipboard!")}catch{Fe.info("Graph URL: "+r)}}});function kP(r){const e=document.createElement("div");return e.textContent=r,e.innerHTML}wP();
